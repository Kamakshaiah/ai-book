<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>Artificial Intelligence &#x0026; Machine Learning</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (https://tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="ai.css" /> 
<meta name="src" content="ai.tex" /> 
</head><body 
>
<div class="maketitle">
                                                    
                                                    
                                                    
                                                    
                                                    
                                                    

<h2 class="titleHead">Artificial Intelligence &#x0026; Machine
Learning</h2>
<div class="author" ><span 
class="cmr-12">Dr. M. Kamakshaiah</span>
<br /><span 
class="cmr-9">kamakshaiah.m@gmail.com</span></div>
<br />
<div class="date" ></div>
                                                    
                                                    
</div>
                                                    
                                                    
<h2 class="likechapterHead"><a 
 id="x1-1000"></a>About the author</h2>
<figure class="figure"> 

                                                    
                                                    
                                                    
                                                    
<!--l. 66--><p class="noindent" ><img 
src="self.png" alt="PIC"  
width="85" height="99"  />
                                                    
                                                    
</p>
</figure>
<!--l. 69--><p class="noindent" >Kamakshaiah Musunuru is a open source software evangelist and
full stack developer. He is academic at GITAM (Deemed to be)
University, Visakhapatnam, India, and also a freelance trainer of
data science and analytics. His teaching interests are MIS, Data
Science, Business Analytics including functional analytics
such as marketing analytics, finance analytics etc. He teaches
subjects like R for business analytics, Python for business
anlaytics, IoT, Big Data analytics using Hadoop, etc. His research
interests are related to health care management, educational
management, food &#x0026; agriculture business, utilization of open source
software for business applications. He is advocate of open source
software. He has conducted few workshops and seminars on
open source software tools and their utility for business. He
lived in Ethiopia, North-East Africa, for two years to teach
business management and visited Bangkok, Thailand, on research
assignments.
                                                    
                                                    
</p>
<h2 class="likechapterHead"><a 
 id="x1-2000"></a>Contents</h2>
<div class="tableofcontents">
<span class="chapterToc" >1 <a 
href="#x1-30001" id="QQ2-1-3">Introduction</a></span>
<br /> <span class="sectionToc" >1.1 <a 
href="#x1-40001.1" id="QQ2-1-4">About AI</a></span>
<br /> <span class="sectionToc" >1.2 <a 
href="#x1-50001.2" id="QQ2-1-5">Graph Theory</a></span>
<br />  <span class="subsectionToc" >1.2.1 <a 
href="#x1-60001.2.1" id="QQ2-1-6">Definition</a></span>
<br />  <span class="subsectionToc" >1.2.2 <a 
href="#x1-70001.2.2" id="QQ2-1-7">Directed graph</a></span>
<br />  <span class="subsectionToc" >1.2.3 <a 
href="#x1-80001.2.3" id="QQ2-1-9">History</a></span>
<br />  <span class="subsectionToc" >1.2.4 <a 
href="#x1-90001.2.4" id="QQ2-1-11">Applications</a></span>
<br /> <span class="sectionToc" >1.3 <a 
href="#x1-160001.3" id="QQ2-1-18">State space search</a></span>
<br />  <span class="subsectionToc" >1.3.1 <a 
href="#x1-170001.3.1" id="QQ2-1-19">Representation</a></span>
<br />  <span class="subsectionToc" >1.3.2 <a 
href="#x1-180001.3.2" id="QQ2-1-20">Examples of state-space search algorithms</a></span>
<br /> <span class="sectionToc" >1.4 <a 
href="#x1-210001.4" id="QQ2-1-23">Depth-first search</a></span>
<br />  <span class="subsectionToc" >1.4.1 <a 
href="#x1-220001.4.1" id="QQ2-1-25">Properties</a></span>
<br />  <span class="subsectionToc" >1.4.2 <a 
href="#x1-230001.4.2" id="QQ2-1-26">Example</a></span>
<br />  <span class="subsectionToc" >1.4.3 <a 
href="#x1-240001.4.3" id="QQ2-1-28">Output of a depth-first search</a></span>
<br />  <span class="subsectionToc" >1.4.4 <a 
href="#x1-250001.4.4" id="QQ2-1-30">Vertex orderings</a></span>
<br />  <span class="subsectionToc" >1.4.5 <a 
href="#x1-260001.4.5" id="QQ2-1-32">Complexity</a></span>
<br />  <span class="subsectionToc" >1.4.6 <a 
href="#x1-270001.4.6" id="QQ2-1-33">Applications</a></span>
<br />  <span class="subsectionToc" >1.4.7 <a 
href="#x1-280001.4.7" id="QQ2-1-34">Python practice</a></span>
<br />  <span class="subsectionToc" >1.4.8 <a 
href="#x1-310001.4.8" id="QQ2-1-39"> Handling A Disconnected Graph</a></span>
                                                    
                                                    
<br />  <span class="subsectionToc" >1.4.9 <a 
href="#x1-340001.4.9" id="QQ2-1-42">Python implementation</a></span>
<br /> <span class="sectionToc" >1.5 <a 
href="#x1-360001.5" id="QQ2-1-44">Breadth-first search</a></span>
<br />  <span class="subsectionToc" >1.5.1 <a 
href="#x1-370001.5.1" id="QQ2-1-47">More details</a></span>
<br />  <span class="subsectionToc" >1.5.2 <a 
href="#x1-400001.5.2" id="QQ2-1-58">Analysis</a></span>
<br />  <span class="subsectionToc" >1.5.3 <a 
href="#x1-430001.5.3" id="QQ2-1-61">BFS ordering</a></span>
<br />  <span class="subsectionToc" >1.5.4 <a 
href="#x1-440001.5.4" id="QQ2-1-62">Applications</a></span>
<br />  <span class="subsectionToc" >1.5.5 <a 
href="#x1-450001.5.5" id="QQ2-1-63">Breadth First Search using Python</a></span>
<br /> <span class="sectionToc" >1.6 <a 
href="#x1-460001.6" id="QQ2-1-64">Iterative deepening (Depth-first search)</a></span>
<br />  <span class="subsectionToc" >1.6.1 <a 
href="#x1-470001.6.1" id="QQ2-1-65">Properties</a></span>
<br />  <span class="subsectionToc" >1.6.2 <a 
href="#x1-480001.6.2" id="QQ2-1-66">Analysis</a></span>
<br />  <span class="subsectionToc" >1.6.3 <a 
href="#x1-510001.6.3" id="QQ2-1-69">Example</a></span>
<br />  <span class="subsectionToc" >1.6.4 <a 
href="#x1-540001.6.4" id="QQ2-1-72">Python practice for Iterative Deepening</a></span>
<br /> <span class="sectionToc" >1.7 <a 
href="#x1-590001.7" id="QQ2-1-78">Informed/Heuristic breadth-first search</a></span>
<br />  <span class="subsectionToc" >1.7.1 <a 
href="#x1-600001.7.1" id="QQ2-1-80">Procedure</a></span>
<br /> <span class="sectionToc" >1.8 <a 
href="#x1-610001.8" id="QQ2-1-81">A* Search</a></span>
<br />  <span class="subsectionToc" >1.8.1 <a 
href="#x1-620001.8.1" id="QQ2-1-82">Description</a></span>
<br />  <span class="subsectionToc" >1.8.2 <a 
href="#x1-630001.8.2" id="QQ2-1-84">Complexity</a></span>
<br />  <span class="subsectionToc" >1.8.3 <a 
href="#x1-640001.8.3" id="QQ2-1-85">Python practice</a></span>
<br /> <span class="sectionToc" >1.9 <a 
href="#x1-650001.9" id="QQ2-1-87">Branch and bound</a></span>
<br />  <span class="subsectionToc" >1.9.1 <a 
href="#x1-660001.9.1" id="QQ2-1-88">Overview</a></span>
<br />  <span class="subsectionToc" >1.9.2 <a 
href="#x1-670001.9.2" id="QQ2-1-89">Generic version</a></span>
<br />  <span class="subsectionToc" >1.9.3 <a 
href="#x1-680001.9.3" id="QQ2-1-90">Knapsack problem</a></span>
<br />  <span class="subsectionToc" >1.9.4 <a 
href="#x1-720001.9.4" id="QQ2-1-98">8 puzzle problem</a></span>
<br />  <span class="subsectionToc" >1.9.5 <a 
href="#x1-740001.9.5" id="QQ2-1-103">Job Assignment Problem</a></span>
<br />  <span class="subsectionToc" >1.9.6 <a 
href="#x1-750001.9.6" id="QQ2-1-110">Traveling Salesman Problem</a></span>
<br /><span class="chapterToc" >2 <a 
href="#x1-770002" id="QQ2-1-113">Learning systems</a></span>
<br /> <span class="sectionToc" >2.1 <a 
href="#x1-780002.1" id="QQ2-1-114">Definitions</a></span>
<br />  <span class="subsectionToc" >2.1.1 <a 
href="#x1-790002.1.1" id="QQ2-1-115">What is the learning?</a></span>
                                                    
                                                    
<br />  <span class="subsectionToc" >2.1.2 <a 
href="#x1-810002.1.2" id="QQ2-1-117">What is a system?</a></span>
<br /> <span class="sectionToc" >2.2 <a 
href="#x1-830002.2" id="QQ2-1-119">Goals &#x0026; Applications</a></span>
<br />  <span class="subsectionToc" >2.2.1 <a 
href="#x1-840002.2.1" id="QQ2-1-120">Image Recognition</a></span>
<br />  <span class="subsectionToc" >2.2.2 <a 
href="#x1-850002.2.2" id="QQ2-1-121">Speech Recognition</a></span>
<br />  <span class="subsectionToc" >2.2.3 <a 
href="#x1-860002.2.3" id="QQ2-1-122">Traffic prediction</a></span>
<br />  <span class="subsectionToc" >2.2.4 <a 
href="#x1-870002.2.4" id="QQ2-1-123">Product recommendations</a></span>
<br />  <span class="subsectionToc" >2.2.5 <a 
href="#x1-880002.2.5" id="QQ2-1-124">Self-driving cars</a></span>
<br />  <span class="subsectionToc" >2.2.6 <a 
href="#x1-890002.2.6" id="QQ2-1-125">Email Spam and Malware Filtering</a></span>
<br />  <span class="subsectionToc" >2.2.7 <a 
href="#x1-900002.2.7" id="QQ2-1-126">Virtual Personal Assistant</a></span>
<br />  <span class="subsectionToc" >2.2.8 <a 
href="#x1-910002.2.8" id="QQ2-1-127">Online Fraud Detection</a></span>
<br />  <span class="subsectionToc" >2.2.9 <a 
href="#x1-920002.2.9" id="QQ2-1-128">Stock Market trading</a></span>
<br />  <span class="subsectionToc" >2.2.10 <a 
href="#x1-930002.2.10" id="QQ2-1-129">Medical Diagnosis</a></span>
<br />  <span class="subsectionToc" >2.2.11 <a 
href="#x1-940002.2.11" id="QQ2-1-130">Automatic Language Translation</a></span>
<br /> <span class="sectionToc" >2.3 <a 
href="#x1-950002.3" id="QQ2-1-131">Characteristics</a></span>
<br />  <span class="subsectionToc" >2.3.1 <a 
href="#x1-960002.3.1" id="QQ2-1-132">Problem Definition</a></span>
<br />  <span class="subsectionToc" >2.3.2 <a 
href="#x1-970002.3.2" id="QQ2-1-133">Data</a></span>
<br />  <span class="subsectionToc" >2.3.3 <a 
href="#x1-980002.3.3" id="QQ2-1-134">Evaluation</a></span>
<br />  <span class="subsectionToc" >2.3.4 <a 
href="#x1-990002.3.4" id="QQ2-1-135">Features</a></span>
<br />  <span class="subsectionToc" >2.3.5 <a 
href="#x1-1000002.3.5" id="QQ2-1-136">Modeling</a></span>
<br />  <span class="subsectionToc" >2.3.6 <a 
href="#x1-1010002.3.6" id="QQ2-1-137">Experimentation</a></span>
<br /> <span class="sectionToc" >2.4 <a 
href="#x1-1020002.4" id="QQ2-1-138">Design</a></span>
<br />  <span class="subsectionToc" >2.4.1 <a 
href="#x1-1030002.4.1" id="QQ2-1-139">Handwriting recognition learning problem</a></span>
<br />  <span class="subsectionToc" >2.4.2 <a 
href="#x1-1040002.4.2" id="QQ2-1-140">Spam Mail detection learning problem</a></span>
<br />  <span class="subsectionToc" >2.4.3 <a 
href="#x1-1050002.4.3" id="QQ2-1-141">Checkers learning problem</a></span>
<br />  <span class="subsectionToc" >2.4.4 <a 
href="#x1-1060002.4.4" id="QQ2-1-142">Choosing and representing Target Function</a></span>
<br /> <span class="sectionToc" >2.5 <a 
href="#x1-1100002.5" id="QQ2-1-146">Develop</a></span>
<br />  <span class="subsectionToc" >2.5.1 <a 
href="#x1-1110002.5.1" id="QQ2-1-147">Training data</a></span>
<br />  <span class="subsectionToc" >2.5.2 <a 
href="#x1-1130002.5.2" id="QQ2-1-149">Validation dataset</a></span>
                                                    
                                                    
<br />  <span class="subsectionToc" >2.5.3 <a 
href="#x1-1150002.5.3" id="QQ2-1-152">Cross-validation</a></span>
<br />  <span class="subsectionToc" >2.5.4 <a 
href="#x1-1190002.5.4" id="QQ2-1-158">Concept representation</a></span>
<br />  <span class="subsectionToc" >2.5.5 <a 
href="#x1-1220002.5.5" id="QQ2-1-162">Function approximation</a></span>
<br /><span class="chapterToc" >3 <a 
href="#x1-1250003" id="QQ2-1-168">Artificial Neural Networks</a></span>
<br /> <span class="sectionToc" >3.1 <a 
href="#x1-1260003.1" id="QQ2-1-169">Neural Networks</a></span>
<br /> <span class="sectionToc" >3.2 <a 
href="#x1-1270003.2" id="QQ2-1-171">Overview</a></span>
<br /> <span class="sectionToc" >3.3 <a 
href="#x1-1280003.3" id="QQ2-1-173">History</a></span>
<br /> <span class="sectionToc" >3.4 <a 
href="#x1-1290003.4" id="QQ2-1-174">Artificial intelligence</a></span>
<br /> <span class="sectionToc" >3.5 <a 
href="#x1-1300003.5" id="QQ2-1-175">Applications</a></span>
<br /> <span class="sectionToc" >3.6 <a 
href="#x1-1310003.6" id="QQ2-1-176">von Neumann architecture</a></span>
<br /> <span class="sectionToc" >3.7 <a 
href="#x1-1320003.7" id="QQ2-1-177">Turing’s B-type machines</a></span>
<br /> <span class="sectionToc" >3.8 <a 
href="#x1-1330003.8" id="QQ2-1-178">Hebbian Learning</a></span>
<br /> <span class="sectionToc" >3.9 <a 
href="#x1-1340003.9" id="QQ2-1-179">Python Practice</a></span>
<br />  <span class="subsectionToc" >3.9.1 <a 
href="#x1-1350003.9.1" id="QQ2-1-180">Neural Networks</a></span>
<br /> <span class="sectionToc" >3.10 <a 
href="#x1-1360003.10" id="QQ2-1-182">Feedforward networks</a></span>
<br />  <span class="subsectionToc" >3.10.1 <a 
href="#x1-1370003.10.1" id="QQ2-1-183">Single-layer perceptron</a></span>
<br />  <span class="subsectionToc" >3.10.2 <a 
href="#x1-1380003.10.2" id="QQ2-1-184">Multi-layer perceptron</a></span>
<br />  <span class="subsectionToc" >3.10.3 <a 
href="#x1-1390003.10.3" id="QQ2-1-185">Other feedforward networks</a></span>
<br />  <span class="subsectionToc" >3.10.4 <a 
href="#x1-1400003.10.4" id="QQ2-1-186">Python practice</a></span>
<br /> <span class="sectionToc" >3.11 <a 
href="#x1-1410003.11" id="QQ2-1-188">Backpropagation network</a></span>
<br />  <span class="subsectionToc" >3.11.1 <a 
href="#x1-1420003.11.1" id="QQ2-1-189">Overview</a></span>
<br />  <span class="subsectionToc" >3.11.2 <a 
href="#x1-1430003.11.2" id="QQ2-1-190">Learning as an optimization problem</a></span>
<br />  <span class="subsectionToc" >3.11.3 <a 
href="#x1-1440003.11.3" id="QQ2-1-191">Loss function</a></span>
<br />  <span class="subsectionToc" >3.11.4 <a 
href="#x1-1470003.11.4" id="QQ2-1-194">Python practice</a></span>
<br /> <span class="sectionToc" >3.12 <a 
href="#x1-1570003.12" id="QQ2-1-207">Agents in Artificial Intelligence</a></span>
<br />  <span class="subsectionToc" >3.12.1 <a 
href="#x1-1580003.12.1" id="QQ2-1-208">What is an Agent?</a></span>
<br />  <span class="subsectionToc" >3.12.2 <a 
href="#x1-1590003.12.2" id="QQ2-1-211">Intelligent Agents</a></span>
<br />  <span class="subsectionToc" >3.12.3 <a 
href="#x1-1600003.12.3" id="QQ2-1-212">Rational Agent</a></span>
                                                    
                                                    
<br />  <span class="subsectionToc" >3.12.4 <a 
href="#x1-1620003.12.4" id="QQ2-1-214">Structure of an AI Agent</a></span>
<br />  <span class="subsectionToc" >3.12.5 <a 
href="#x1-1630003.12.5" id="QQ2-1-215">PEAS Representation</a></span>
<br />  <span class="subsectionToc" >3.12.6 <a 
href="#x1-1650003.12.6" id="QQ2-1-217">Types of agents</a></span>
<br /> <span class="sectionToc" >3.13 <a 
href="#x1-1710003.13" id="QQ2-1-228">Agent Environment in AI</a></span>
<br />  <span class="subsectionToc" >3.13.1 <a 
href="#x1-1720003.13.1" id="QQ2-1-229">Features of Environment</a></span>
<br /> <span class="sectionToc" >3.14 <a 
href="#x1-1810003.14" id="QQ2-1-238">Turing Test in AI</a></span>
<br />  <span class="subsectionToc" >3.14.1 <a 
href="#x1-1820003.14.1" id="QQ2-1-240">Chatbots to attempt the Turing test</a></span>
<br /> <span class="sectionToc" >3.15 <a 
href="#x1-1830003.15" id="QQ2-1-241">The Chinese Room Argument</a></span>
<br /><span class="chapterToc" >4 <a 
href="#x1-1850004" id="QQ2-1-243">Natural language processing</a></span>
<br /> <span class="sectionToc" >4.1 <a 
href="#x1-1860004.1" id="QQ2-1-244">History</a></span>
<br />  <span class="subsectionToc" >4.1.1 <a 
href="#x1-1870004.1.1" id="QQ2-1-245">Symbolic NLP (1950s  early 1990s)</a></span>
<br />  <span class="subsectionToc" >4.1.2 <a 
href="#x1-1880004.1.2" id="QQ2-1-246">Statistical NLP (1990s2010s)</a></span>
<br />  <span class="subsectionToc" >4.1.3 <a 
href="#x1-1890004.1.3" id="QQ2-1-247">Neural NLP (present)</a></span>
<br />  <span class="subsectionToc" >4.1.4 <a 
href="#x1-1900004.1.4" id="QQ2-1-248">Components of NLP</a></span>
<br />  <span class="subsectionToc" >4.1.5 <a 
href="#x1-1910004.1.5" id="QQ2-1-249">Natural Language Understanding (NLU)</a></span>
<br />  <span class="subsectionToc" >4.1.6 <a 
href="#x1-1920004.1.6" id="QQ2-1-250">Natural Language Generation (NLG)</a></span>
<br />  <span class="subsectionToc" >4.1.7 <a 
href="#x1-1930004.1.7" id="QQ2-1-251">Difference between NLU and NLG</a></span>
<br /> <span class="sectionToc" >4.2 <a 
href="#x1-1940004.2" id="QQ2-1-253">Applications of NLP</a></span>
<br /> <span class="sectionToc" >4.3 <a 
href="#x1-1950004.3" id="QQ2-1-254">Speech recognition using Python</a></span>
<br /> <span class="sectionToc" >4.4 <a 
href="#x1-1980004.4" id="QQ2-1-257">How to build an NLP pipeline</a></span>
<br /> <span class="sectionToc" >4.5 <a 
href="#x1-1990004.5" id="QQ2-1-258">Python practice for NLP pipelines</a></span>
<br />  <span class="subsectionToc" >4.5.1 <a 
href="#x1-2000004.5.1" id="QQ2-1-259">spaCy for NLP</a></span>
<br />  <span class="subsectionToc" >4.5.2 <a 
href="#x1-2050004.5.2" id="QQ2-1-264">Phases of NLP</a></span>
<br /><span class="chapterToc" >5 <a 
href="#x1-2080005" id="QQ2-1-267">Machine Learning</a></span>
<br /> <span class="sectionToc" >5.1 <a 
href="#x1-2090005.1" id="QQ2-1-268">Supervised learning</a></span>
<br />  <span class="subsectionToc" >5.1.1 <a 
href="#x1-2120005.1.1" id="QQ2-1-271">Logistic regression</a></span>
<br />  <span class="subsectionToc" >5.1.2 <a 
href="#x1-2170005.1.2" id="QQ2-1-276">K-Nearest Neighbors Algorithm (k-NN)</a></span>
<br />  <span class="subsectionToc" >5.1.3 <a 
href="#x1-2200005.1.3" id="QQ2-1-281">Decision Trees</a></span>
                                                    
                                                    
<br />  <span class="subsectionToc" >5.1.4 <a 
href="#x1-2230005.1.4" id="QQ2-1-286">Support Vector Machines</a></span>
<br /> <span class="sectionToc" >5.2 <a 
href="#x1-2260005.2" id="QQ2-1-289">Unsupervised learning</a></span>
<br />  <span class="subsectionToc" >5.2.1 <a 
href="#x1-2270005.2.1" id="QQ2-1-290">Approaches</a></span>
<br />  <span class="subsectionToc" >5.2.2 <a 
href="#x1-2280005.2.2" id="QQ2-1-291">Clustering</a></span>
<br />  <span class="subsectionToc" >5.2.3 <a 
href="#x1-2290005.2.3" id="QQ2-1-292">Algorithms for clustering</a></span>
<br />  <span class="subsectionToc" >5.2.4 <a 
href="#x1-2300005.2.4" id="QQ2-1-293">K-Means clustering</a></span>
<br />  <span class="subsectionToc" >5.2.5 <a 
href="#x1-2310005.2.5" id="QQ2-1-294">K-Means clustering using Python</a></span>
<br />  <span class="subsectionToc" >5.2.6 <a 
href="#x1-2330005.2.6" id="QQ2-1-296">Hierarchical clustering</a></span>
</div>
                                                    
                                                    
<h2 class="chapterHead"><span class="titlemark">Chapter 1</span><br /><a 
 id="x1-30001"></a>Introduction</h2>
<h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-40001.1"></a>About AI</h3>
<!--l. 78--><p class="noindent" >Artificial intelligence (AI) is intelligence demonstrated by machines,
unlike the natural intelligence displayed by humans and animals,
which involves consciousness and emotionality. The distinction
between the former and the latter categories is often revealed by the
acronym chosen. ’Strong’ AI is usually labelled as AGI (Artificial
General Intelligence) while attempts to emulate ’natural’
intelligence have been called ABI (Artificial Biological Intelligence).
Leading AI textbooks define the field as the study of “intelligent
agents”: any device that perceives its environment and takes actions
that maximize its chance of successfully achieving its goals.
Colloquially, the term “artificial intelligence” is often used to
describe machines (or computers) that mimic ”cognitive” functions
that humans associate with the human mind, such as “learning”
and “problem solving”.
</p><!--l. 80--><p class="noindent" >As machines become increasingly capable, tasks considered to
require “intelligence” are often removed from the definition of AI, a
phenomenon known as the AI effect. A quip in Tesler’s Theorem
says ”AI is whatever hasn’t been done yet.” <sup class="textsuperscript"><a 
href="#ennote-1" id="enmark-1"><span 
class="cmr-9">1</span></a></sup> For instance,
optical character recognition is frequently excluded from things
considered to be AI, having become a routine technology.
Modern machine capabilities generally classified as AI include
successfully understanding human speech, competing at the highest
level in strategic game systems (such as chess and Go), and
also imperfect-information games like poker, self-driving cars,
intelligent routing in content delivery networks, and military
simulations.
</p><!--l. 82--><p class="noindent" >Artificial intelligence was founded as an academic discipline in 1955,
and in the years since has experienced several waves of optimism,
followed by disappointment and the loss of funding (known as an
“AI winter”), followed by new approaches, success and renewed
funding. <sup class="textsuperscript"><a 
href="#ennote-2" id="enmark-2"><span 
class="cmr-9">2</span></a></sup> After AlphaGo successfully defeated a professional
Go player in 2015, artificial intelligence once again attracted
widespread global attention.<sup class="textsuperscript"><a 
href="#ennote-3" id="enmark-3"><span 
class="cmr-9">3</span></a></sup> For most of its history, AI research
has been divided into sub-fields that often fail to communicate with
each other. These sub-fields are based on technical considerations,
such as particular goals (e.g. “robotics” or “machine learning”), the
                                                    
                                                    
use of particular tools (“logic” or artificial neural networks), or deep
philosophical differences. Sub-fields have also been based on
social factors (particular institutions or the work of particular
researchers).
</p><!--l. 84--><p class="noindent" >The traditional problems (or goals) of AI research include
reasoning, knowledge representation, planning, learning,
natural language processing, perception and the ability to
move and manipulate objects. General intelligence is among
the field’s long-term goals. Approaches include statistical
methods, computational intelligence, and traditional symbolic AI.
Many tools are used in AI, including versions of search and
mathematical optimization, artificial neural networks, and
methods based on statistics, probability and economics. The AI
field draws upon computer science, information engineering,
mathematics, psychology, linguistics, philosophy, and many other
fields.
</p><!--l. 86--><p class="noindent" >The field was founded on the assumption that human intelligence
“can be so precisely described that a machine can be made to
simulate it”. This raises philosophical arguments about the mind
and the ethics of creating artificial beings endowed with human-like
intelligence. These issues have been explored by myth, fiction and
philosophy since antiquity. Some people also consider AI to be a
danger to humanity if it progresses unabated. Others believe that
AI, unlike previous technological revolutions, will create a risk of
mass unemployment.
</p><!--l. 88--><p class="noindent" >In the twenty-first century, AI techniques have experienced a
resurgence following concurrent advances in computer power, large
amounts of data, and theoretical understanding; and AI techniques
have become an essential part of the technology industry, helping to
solve many challenging problems in computer science, software
engineering and operations research.
</p><!--l. 90--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-50001.2"></a>Graph Theory</h3>
<!--l. 92--><p class="noindent" >Graph theory is the study of graphs, which are mathematical
structures used to model pairwise relations between objects. A
                                                    
                                                    
graph in this context is made up of vertices (also called nodes
or points) which are connected by edges (also called links
or lines). A distinction is made between undirected graphs,
where edges link two vertices symmetrically, and directed
graphs, where edges link two vertices asymmetrically; see Graph
(discrete mathematics) for more detailed definitions and for
other variations in the types of graph that are commonly
considered. Graphs are one of the prime objects of study in discrete
mathematics.
</p><!--l. 94--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.2.1   </span> <a 
 id="x1-60001.2.1"></a>Definition</h4>
<!--l. 96--><p class="noindent" >Definitions in graph theory vary. The following are some of the more
basic ways of defining graphs and related mathematical structures. In
one restricted but very common sense of the term, a graph is an ordered
pair <!--l. 96--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>V</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-close">)</mo></math>
comprising:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 99--><p class="noindent" ><!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>,
     a set of vertices (also called nodes or points);
     </p></li>
     <li class="itemize">
     <!--l. 100--><p class="noindent" ><!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">⊆</mo><mo 
class="MathClass-open">{</mo><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo><mo 
class="MathClass-rel">∣</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo></math>,
     a set of edges (also called links or lines), which are unordered
     pairs of vertices (that is, an edge is associated with two
     distinct vertices).</p></li></ul>
<!--l. 103--><p class="noindent" >To avoid ambiguity, this type of object may be called precisely an
undirected simple graph.
</p><!--l. 105--><p class="noindent" >In the edge <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo></math>,
the vertices <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
are called the endpoints of the edge. The edge is said to join
                                                    
                                                    
<!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> and
<!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math> and to be
incident on <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and on <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>.
A vertex may exist in a graph and not belong to an edge. Multiple
edges, not allowed under the definition above, are two or more edges
that join the same two vertices.
</p><!--l. 107--><p class="noindent" >In one more general sense of the term allowing multiple edges, a graph is an
ordered triple <!--l. 107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>V</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi><mo 
class="MathClass-close">)</mo></math>
comprising:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 110--><p class="noindent" ><!--l. 110--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>,
     a set of vertices (also called nodes or points);
     </p></li>
     <li class="itemize">
     <!--l. 111--><p class="noindent" ><!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>,
     a set of edges (also called links or lines);
     </p></li>
     <li class="itemize">
     <!--l. 112--><p class="noindent" ><!--l. 112--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>E</mi> <mo 
class="MathClass-rel">→</mo><mo 
class="MathClass-open">{</mo><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo><mo 
class="MathClass-rel">∣</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo></math>,
     an incidence function mapping every edge to an unordered
     pair of vertices (that is, an edge is associated with two
     distinct vertices).</p></li></ul>
<!--l. 115--><p class="noindent" >To avoid ambiguity, this type of object may be called precisely
an undirected multigraph. A loop is an edge that joins
a vertex to itself. Graphs as defined in the two definitions
above cannot have loops, because a loop joining a vertex
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
to itself is the edge (for an undirected simple graph)
or is incident on (for an undirected multigraph)
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-close">}</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-close">}</mo></math>which is
not in <!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">{</mo><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo><mo 
class="MathClass-rel">∣</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo></math>.
So to allow loops the definitions must be expanded.
For undirected simple graphs, the definition of
                                                    
                                                    
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math> should be
modified to <!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">⊆</mo><mo 
class="MathClass-open">{</mo><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo><mo 
class="MathClass-rel">∣</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mo 
class="MathClass-close">}</mo></math>.
For undirected multigraphs, the definition of
<!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi></math> should be
modified to <!--l. 115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>E</mi> <mo 
class="MathClass-rel">→</mo><mo 
class="MathClass-open">{</mo><mo 
class="MathClass-open">{</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">}</mo><mo 
class="MathClass-rel">∣</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mo 
class="MathClass-close">}</mo></math>.
To avoid ambiguity, these types of objects may be called undirected
simple graph permitting loops and undirected multigraph
permitting loops, respectively.
</p><!--l. 117--><p class="noindent" ><!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math> and
<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math> are
usually taken to be finite, and many of the well-known results are
not true (or are rather different) for infinite graphs because
many of the arguments fail in the infinite case. Moreover,
<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math> is often assumed to
be non-empty, but <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>
is allowed to be the empty set. The order of a graph is
<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo></math>,
its number of vertices. The size of a graph is
<!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo></math>, its
number of edges. The degree or valency of a vertex is the number of
edges that are incident to it, where a loop is counted twice. The
degree of a graph is the maximum of the degrees of its vertices. In
an undirected simple graph of order n, the maximum degree of each
vertex is n ? 1 and the maximum size of the graph is n(n -
1)/2.
</p><!--l. 119--><p class="noindent" >The edges of an undirected simple graph permitting loops
<!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>
induce a symmetric homogeneous relation
<!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>˜</mi></math> on the
vertices of <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>
that is called the adjacency relation of
<!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>. Specifically,
for each edge <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>,
its endpoints <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
are said to be adjacent to one another, which is denoted
<!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi><mi 
>˜</mi><mi 
>y</mi></math>.
</p><!--l. 121--><p class="noindent" >
                                                    
                                                    
</p>
<h4 class="subsectionHead"><span class="titlemark">1.2.2   </span> <a 
 id="x1-70001.2.2"></a>Directed graph</h4>
<!--l. 123--><p class="noindent" >A directed graph or digraph is a graph in which edges
have orientations. In one restricted but very common
sense of the term, a directed graph is an ordered pair
<!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>V</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-close">)</mo></math>
comprising:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 126--><p class="noindent" ><!--l. 126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>,
     a set of vertices (also called nodes or points);
     </p></li>
     <li class="itemize">
     <!--l. 127--><p class="noindent" ><!--l. 127--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">⊆</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi></mrow><mo fence="true" form="postfix">}</mo></mrow></math>,
     a set of edges (also called directed edges, directed links,
     directed lines, arrows or arcs) which are ordered pairs of
     vertices (that is, an edge is associated with two distinct
     vertices).</p></li></ul>
<!--l. 130--><p class="noindent" >To avoid ambiguity, this type of object may be
called precisely a directed simple graph. In the edge
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math> directed
from <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
to <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>, the
vertices <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
are called the endpoints of the edge,
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> the tail of
the edge and <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
the head of the edge. The edge is said to join
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> and
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math> and to be
incident on <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and on <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>.
A vertex may exist in a graph and not belong to an edge. The edge
<!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> is called the
inverted edge of <!--l. 130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>.
                                                    
                                                    
Multiple edges, not allowed under the definition above, are two or
more edges with both the same tail and the same head.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-70011"></a>
                                                    
                                                    
<!--l. 134--><p class="noindent" ><img 
src="directed-graph.png" alt="PIC"  
width="71" height="71"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.1:</span><span  
class="content">A  directed  graph  with  three  vertices  and  four
directed edges (the double arrow represents an edge in each
direction).</span></figcaption><!--tex4ht:label?: x1-70011 -->
                                                    
                                                    
</figure>
<!--l. 139--><p class="noindent" >In one more general sense of the term allowing
multiple edges, a directed graph is an ordered triple
<!--l. 139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>V</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>ϕ</mi><mo 
class="MathClass-close">)</mo></math>
comprising:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 142--><p class="noindent" ><!--l. 142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>,
     a set of vertices (also called nodes or points);
     </p></li>
     <li class="itemize">
     <!--l. 143--><p class="noindent" ><!--l. 143--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>,
     a set of edges (also called directed edges, directed links,
     directed lines, arrows or arcs); <!--l. 144--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>E</mi> <mo 
class="MathClass-rel">→</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi></mrow><mo fence="true" form="postfix">}</mo></mrow></math>,
     an incidence function mapping every edge to an ordered
     pair of vertices (that is, an edge is associated with two
     distinct vertices).</p></li></ul>
<!--l. 147--><p class="noindent" >To avoid ambiguity, this type of object may be called precisely a
directed multigraph. A loop is an edge that joins a vertex
to itself. Directed graphs as defined in the two definitions
above cannot have loops, because a loop joining a vertex
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> to itself is the
edge (for a directed simple graph) or is incident on (for a directed multigraph)
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> which is
not in <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>x</mi><mo 
class="MathClass-rel">≠</mo><mi 
>y</mi></mrow><mo fence="true" form="postfix">}</mo></mrow></math>.
So to allow loops the definitions must be expanded.
For directed simple graphs, the definition of
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math> should be
modified to <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">⊆</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo fence="true" form="postfix">}</mo></mrow></math>.
For directed multigraphs, the definition of
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi></math> should be
modified to <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>E</mi> <mo 
class="MathClass-rel">→</mo> <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>V</mi> </mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo fence="true" form="postfix">}</mo></mrow></math>.
To avoid ambiguity, these types of objects may be called precisely
a directed simple graph permitting loops and a directed
multigraph permitting loops (or a quiver) respectively.
The edges of a directed simple graph permitting loops
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math> is a homogeneous
relation <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>˜</mi></math> on
                                                    
                                                    
the vertices of <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>
that is called the adjacency relation of
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>. Specifically,
for each edge <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>,
its endpoints <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
and <!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
are said to be adjacent to one another, which is denoted
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi><mi 
>˜</mi><mi 
>y</mi></math>.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.2.3   </span> <a 
 id="x1-80001.2.3"></a>History</h4>
<!--l. 151--><p class="noindent" >The paper written by Leonhard Euler on the Seven Bridges of
<!--l. 151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi><mi 
>ö</mi><mi 
>n</mi><mi 
>i</mi><mi 
>g</mi><mi 
>s</mi><mi 
>b</mi><mi 
>e</mi><mi 
>r</mi><mi 
>g</mi></math> and
published in 1736 is regarded as the first paper in the history of
graph theory. <sup class="textsuperscript"><a 
href="#ennote-4" id="enmark-4"><span 
class="cmr-9">4</span></a></sup> This paper, as well as the one written by
Vandermonde on the knight problem, carried on with the
analysis situs initiated by Leibniz. Euler’s formula relating the
number of edges, vertices, and faces of a convex polyhedron
was studied and generalized by Cauchy and L’Huilier, and
represents the beginning of the branch of mathematics known as
topology.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-80012"></a>
                                                    
                                                    
<!--l. 155--><p class="noindent" ><img 
src="konigsberg_bridges.png" alt="PIC"  
width="170" height="170"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.2:</span><span  
class="content">Seven                        Bridges                        of
<!--l. 156--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi><mi 
>ö</mi><mi 
>n</mi><mi 
>i</mi><mi 
>g</mi><mi 
>s</mi><mi 
>b</mi><mi 
>e</mi><mi 
>r</mi><mi 
>g</mi></math>
</span></figcaption><!--tex4ht:label?: x1-80012 -->
                                                    
                                                    
</figure>
<!--l. 160--><p class="noindent" >More than one century after Euler’s paper on the bridges of
<!--l. 160--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi><mi 
>ö</mi><mi 
>n</mi><mi 
>i</mi><mi 
>g</mi><mi 
>s</mi><mi 
>b</mi><mi 
>e</mi><mi 
>r</mi><mi 
>g</mi></math> and
while Listing was introducing the concept of topology, Cayley was
led by an interest in particular analytical forms arising from
differential calculus to study a particular class of graphs, the trees.
This study had many implications for theoretical chemistry. The
techniques he used mainly concern the enumeration of graphs
with particular properties. Enumerative graph theory then
arose from the results of Cayley and the fundamental results
published by P between 1935 and 1937. These were generalized by
De Bruijn in 1959. Cayley linked his results on trees with
contemporary studies of chemical composition. The fusion of
ideas from mathematics with those from chemistry began
what has become part of the standard terminology of graph
theory.
</p><!--l. 162--><p class="noindent" >In particular, the term “graph” was introduced by Sylvester in a
paper published in 1878 in Nature, where he draws an analogy
between “quantic invariants” and “co-variants” of algebra and
molecular diagrams:
     </p><blockquote class="quote">
     <!--l. 165--><p class="noindent" >“[...] Every invariant and co-variant thus becomes
     expressible  by  a  graph  precisely  identical  with  a
     Kekul diagram or chemicograph. [...] I give a rule
     for  the  geometrical  multiplication  of  graphs,  i.e.
     for constructing a graph to the product of in- or
     co-variants whose separate graphs are given. [...]”
</p>
     </blockquote>
<!--l. 170--><p class="noindent" >The first textbook on graph theory was written by Ds
<!--l. 170--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi><mi 
>ö</mi><mi 
>n</mi><mi 
>i</mi><mi 
>g</mi></math>,
and published in 1936. <sup class="textsuperscript"><a 
href="#ennote-5" id="enmark-5"><span 
class="cmr-9">5</span></a></sup> Another book by Frank Harary,
published in 1969, was ”considered the world over to be the
definitive textbook on the subject”, and enabled mathematicians,
chemists, electrical engineers and social scientists to talk to
each other. Harary donated all of the royalties to fund the P
Prize.<sup class="textsuperscript"><a 
href="#ennote-6" id="enmark-6"><span 
class="cmr-9">6</span></a></sup>
                                                    
                                                    
</p><!--l. 172--><p class="noindent" >One of the most famous and stimulating problems in graph theory
is the four color problem: “Is it true that any map drawn in the
plane may have its regions colored with four colors, in such a way
that any two regions having a common border have different
colors?” This problem was first posed by Francis Guthrie in 1852
and its first written record is in a letter of De Morgan addressed to
Hamilton the same year. Many incorrect proofs have been
proposed, including those by Cayley, Kempe, and others.
The study and the generalization of this problem by Tait,
Heawood, Ramsey and Hadwiger led to the study of the colorings
of the graphs embedded on surfaces with arbitrary genus.
Tait’s reformulation generated a new class of problems, the
factorization problems, particularly studied by Petersen and
<!--l. 172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi><mi 
>ö</mi><mi 
>n</mi><mi 
>i</mi><mi 
>g</mi></math>. The
works of Ramsey on colorations and more specially the results
obtained by Turn 1941 was at the origin of another branch of graph
theory, extremal graph theory.
</p><!--l. 174--><p class="noindent" >The four color problem remained unsolved for more than a century.
In 1969 Heinrich Heesch published a method for solving the
problem using computers. A computer-aided proof produced in 1976
by Kenneth Appel and Wolfgang Haken makes fundamental use of
the notion of “discharging” developed by Heesch. The proof
involved checking the properties of 1,936 configurations by
computer, and was not fully accepted at the time due to its
complexity. A simpler proof considering only 633 configurations was
given twenty years later by Robertson, Seymour, Sanders and
Thomas.
</p><!--l. 176--><p class="noindent" >The autonomous development of topology from 1860 and 1930
fertilized graph theory back through the works of Jordan,
Kuratowski and Whitney. Another important factor of common
development of graph theory and topology came from the use of the
techniques of modern algebra. The first example of such a use
comes from the work of the physicist Gustav Kirchhoff, who
published in 1845 his Kirchhoff’s circuit laws for calculating the
voltage and current in electric circuits.
</p><!--l. 178--><p class="noindent" >The introduction of probabilistic methods in
graph theory, especially in the study of Erd?s and
<!--l. 178--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi><mi 
>ė</mi><mi 
>n</mi><mi 
>y</mi><mi 
>i</mi></math> of
the asymptotic probability of graph connectivity, gave rise to yet
another branch, known as random graph theory, which has been a
                                                    
                                                    
fruitful source of graph-theoretic results.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.2.4   </span> <a 
 id="x1-90001.2.4"></a>Applications</h4>
<!--l. 184--><p class="noindent" >Graphs can be used to model many types of relations and processes
in physical, biological, social and information systems. Many
practical problems can be represented by graphs. Emphasizing their
application to real-world systems, the term network is sometimes
defined to mean a graph in which attributes (e.g. names) are
associated with the vertices and edges, and the subject that
expresses and understands the real-world systems as a network is
called network science.
</p><!--l. 186--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-100001.2.4"></a>Computer science</h5>
<!--l. 188--><p class="noindent" >In computer science, graphs are used to represent networks of
communication, data organization, computational devices, the flow
of computation, etc. For instance, the link structure of a website
can be represented by a directed graph, in which the vertices
represent web pages and directed edges represent links from one
page to another. A similar approach can be taken to problems in
social media, travel, biology, computer chip design, mapping the
progression of neuro-degenerative diseases, and many other fields.
The development of algorithms to handle graphs is therefore of
major interest in computer science. The transformation of graphs is
often formalized and represented by graph rewrite systems.
Complementary to graph transformation systems focusing on
rule-based in-memory manipulation of graphs are graph databases
geared towards transaction-safe, persistent storing and querying of
graph-structured data.
</p><!--l. 190--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-110001.2.4"></a>Linguistics</h5>
                                                    
                                                    
<!--l. 192--><p class="noindent" >Graph-theoretic methods, in various forms, have proven particularly
useful in linguistics, since natural language often lends itself well to
discrete structure. Traditionally, syntax and compositional
semantics follow tree-based structures, whose expressive power lies
in the principle of compositionality, modeled in a hierarchical graph.
More contemporary approaches such as head-driven phrase
structure grammar model the syntax of natural language using
typed feature structures, which are directed acyclic graphs.
Within lexical semantics, especially as applied to computers,
modeling word meaning is easier when a given word is understood
in terms of related words; semantic networks are therefore
important in computational linguistics. Still, other methods in
phonology (e.g. optimality theory, which uses lattice graphs) and
morphology (e.g. finite-state morphology, using finite-state
transducers) are common in the analysis of language as a
graph. Indeed, the usefulness of this area of mathematics to
linguistics has borne organizations such as TextGraphs, as well
as various ’Net’ projects, such as WordNet, VerbNet, and
others.
</p><!--l. 194--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-120001.2.4"></a>Physics and chemistry</h5>
<!--l. 196--><p class="noindent" >Graph theory is also used to study molecules in chemistry and
physics. In condensed matter physics, the three-dimensional
structure of complicated simulated atomic structures can be studied
quantitatively by gathering statistics on graph-theoretic properties
related to the topology of the atoms. Also, ”the Feynman graphs
and rules of calculation summarize quantum field theory in a form
in close contact with the experimental numbers one wants to
understand.” In chemistry a graph makes a natural model for a
molecule, where vertices represent atoms and edges bonds.
This approach is especially used in computer processing of
molecular structures, ranging from chemical editors to database
searching. In statistical physics, graphs can represent local
connections between interacting parts of a system, as well as the
dynamics of a physical process on such systems. Similarly, in
computational neuroscience graphs can be used to represent
functional connections between brain areas that interact to
                                                    
                                                    
give rise to various cognitive processes, where the vertices
represent different areas of the brain and the edges represent
the connections between those areas. Graph theory plays an
important role in electrical modeling of electrical networks, here,
weights are associated with resistance of the wire segments to
obtain electrical properties of network structures. Graphs
are also used to represent the micro-scale channels of porous
media, in which the vertices represent the pores and the edges
represent the smaller channels connecting the pores. Chemical
graph theory uses the molecular graph as a means to model
molecules. Graphs and networks are excellent models to study
and understand phase transitions and critical phenomena.
Removal of nodes or edges lead to a critical transition where
the network breaks into small clusters which is studied as a
phase transition. This breakdown is studied via percolation
theory.
</p><!--l. 198--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-130001.2.4"></a>Social sciences</h5>
<!--l. 200--><p class="noindent" >Graph theory is also widely used in sociology as a way, for example,
to measure actors’ prestige or to explore rumor spreading, notably
through the use of social network analysis software. Under the
umbrella of social networks are many different types of graphs.
Acquaintanceship and friendship graphs describe whether people
know each other. Influence graphs model whether certain people
can influence the behavior of others. Finally, collaboration graphs
model whether two people work together in a particular way, such
as acting in a movie together.
</p><!--l. 202--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-140001.2.4"></a>Biology</h5>
<!--l. 204--><p class="noindent" >Likewise, graph theory is useful in biology and conservation efforts
where a vertex can represent regions where certain species
exist (or inhabit) and the edges represent migration paths or
movement between the regions. This information is important
                                                    
                                                    
when looking at breeding patterns or tracking the spread of
disease, parasites or how changes to the movement can affect
other species. Graphs are also commonly used in molecular
biology and genomics to model and analyse datasets with
complex relationships. For example, graph-based methods
are often used to ’cluster’ cells together into cell-types in
single-cell transcriptome analysis. Another use is to model genes or
proteins in a pathway and study the relationships between them,
such as metabolic pathways and gene regulatory networks.
Evolutionary trees, ecological networks, and hierarchical clustering
of gene expression patterns are also represented as graph
structures. Graph-based methods are pervasive that researchers in
some fields of biology and these will only become far more
widespread as technology develops to leverage this kind of
high-throughout multidimensional data. Graph theory is also used
in connectomics; nervous systems can be seen as a graph, where the
nodes are neurons and the edges are the connections between
them.
</p><!--l. 206--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-150001.2.4"></a>Mathematics</h5>
<!--l. 208--><p class="noindent" >In mathematics, graphs are useful in geometry and certain parts of
topology such as knot theory. Algebraic graph theory has
close links with group theory. Algebraic graph theory has
been applied to many areas including dynamic systems and
complexity.
</p><!--l. 210--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-160001.3"></a>State space search</h3>
<!--l. 212--><p class="noindent" >State space search is a process used in the field of computer
science, including artificial intelligence (AI), in which successive
configurations or states of an instance are considered, with the
intention of finding a goal state with the desired property.
                                                    
                                                    
</p><!--l. 214--><p class="noindent" >Problems are often modelled as a state space, a set of states that a
problem can be in. The set of states forms a graph where two states
are connected if there is an operation that can be performed to
transform the first state into the second.
</p><!--l. 216--><p class="noindent" >State space search often differs from traditional computer
science search methods because the state space is implicit:
the typical state space graph is much too large to generate
and store in memory. Instead, nodes are generated as they
are explored, and typically discarded thereafter. A solution
to a combinatorial search instance may consist of the goal
state itself, or of a path from some initial state to the goal
state.
</p><!--l. 218--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.3.1   </span> <a 
 id="x1-170001.3.1"></a>Representation</h4>
<!--l. 220--><p class="noindent" >In state space search, a state space is formally represented as a <span 
class="cmti-10">tuple</span>
<!--l. 220--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">⟨</mo><mi 
>S</mi><mo 
class="MathClass-punc">,</mo><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>A</mi><mi 
>c</mi><mi 
>t</mi><mi 
>i</mi><mi 
>o</mi><mi 
>n</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>u</mi><mi 
>l</mi><mi 
>t</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
>C</mi><mi 
>o</mi><mi 
>s</mi><mi 
>t</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">⟩</mo></math>, in
which:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 223--><p class="noindent" ><!--l. 223--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
     is the set of all possible states;
     </p></li>
     <li class="itemize">
     <!--l. 224--><p class="noindent" ><!--l. 224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math>
     is the set of possible actions, not related to a particular
     state but regarding all the state space;
     </p></li>
     <li class="itemize">
     <!--l. 225--><p class="noindent" ><!--l. 225--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>c</mi><mi 
>t</mi><mi 
>i</mi><mi 
>o</mi><mi 
>n</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-close">)</mo></math>
     is the function that establish which action is possible to
     perform in a certain state;
                                                    
                                                    
     </p></li>
     <li class="itemize">
     <!--l. 226--><p class="noindent" ><!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi><mi 
>e</mi><mi 
>s</mi><mi 
>u</mi><mi 
>l</mi><mi 
>t</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-close">)</mo></math>
     is the function that returns the state reached performing
     action <!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
     in state <!--l. 226--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>
     </p></li>
     <li class="itemize">
     <!--l. 227--><p class="noindent" ><!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mi 
>o</mi><mi 
>s</mi><mi 
>t</mi><mo 
class="MathClass-open">(</mo><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-close">)</mo></math>
     is the cost of performing an action <!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
     in state <!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi></math>.
     In many state spaces is a constant, but this is not true in
     general.</p></li></ul>
<!--l. 230--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.3.2   </span> <a 
 id="x1-180001.3.2"></a>Examples of state-space search algorithms</h4>
<!--l. 232--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-190001.3.2"></a>Uninformed search</h5>
<!--l. 233--><p class="noindent" >According to Poole and Mack worth, the following are uninformed
state-space search methods, meaning that they do not have any
prior information about the goal’s location.
</p><!--l. 235--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-19002x1">
     <!--l. 236--><p class="noindent" >Traditional depth-first search
     </p></li>
<li 
  class="enumerate" id="x1-19004x2">
     <!--l. 237--><p class="noindent" >Breadth-first search
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-19006x3">
     <!--l. 238--><p class="noindent" >Iterative deepening
     </p></li>
<li 
  class="enumerate" id="x1-19008x4">
     <!--l. 239--><p class="noindent" >Lowest-cost-first search</p></li></ol>
<!--l. 242--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-200001.3.2"></a>Heuristic search</h5>
<!--l. 244--><p class="noindent" >Some algorithms take into account information about the goal
node’s location in the form of a heuristic function. Poole and
Mackworth cite the following examples as informed search
algorithms:
</p><!--l. 246--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-20002x1">
     <!--l. 247--><p class="noindent" >Informed/Heuristic breadth-first search
     </p></li>
<li 
  class="enumerate" id="x1-20004x2">
     <!--l. 248--><p class="noindent" >Greedy best-first search
     </p></li>
<li 
  class="enumerate" id="x1-20006x3">
     <!--l. 249--><p class="noindent" >A* search
</p>
     </li></ol>
                                                    
                                                    
<!--l. 253--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.4   </span> <a 
 id="x1-210001.4"></a>Depth-first search</h3>
<!--l. 255--><p class="noindent" >Depth-first search (DFS) is an algorithm for traversing or searching
tree or graph data structures. The algorithm starts at the root node
(selecting some arbitrary node as the root node in the case of a
graph) and explores as far as possible along each branch before
backtracking. A version of depth-first search was investigated in the
<!--l. 255--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>9</mn></mrow><mrow 
><mi 
>t</mi><mi 
>h</mi></mrow></msup 
></math>
century by French mathematician Charles Pierre Trux as a strategy
for solving mazes. <sup class="textsuperscript"><a 
href="#ennote-7" id="enmark-7"><span 
class="cmr-9">7</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-8" id="enmark-8"><span 
class="cmr-9">8</span></a></sup>
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-210013"></a>
                                                    
                                                    
<!--l. 259--><p class="noindent" ><img 
src="depth-first-tree.png" alt="PIC"  
width="170" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.3:</span><span  
class="content">Depth first tree</span></figcaption><!--tex4ht:label?: x1-210013 -->
                                                    
                                                    
</figure>
<div class="table">
                                                    
                                                    
<!--l. 264--><p class="noindent" ></p><figure class="float" 
>
                                                    
                                                    
<div class="tabular"> <table id="TBL-2" class="tabular" 
 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /><col 
id="TBL-2-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-1"  
class="td11">Class Search                    </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-1-2"  
class="td11">algorithm                                                                                                                                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-1"  
class="td11">Data structure                  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-2-2"  
class="td11">Graph                                                                                                                                                                                              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-1"  
class="td11">Worst-case performance      </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-3-2"  
class="td11"><!--l. 269--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math> for explicit                                                                                                     </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-4-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-4-2"  
class="td11">graphs traversed without                                                                                                                                                                      </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-5-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-5-2"  
class="td11">repetition, <!--l. 271--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math> for                                                                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-6-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-6-2"  
class="td11">implicit graphs with branching                                                                                                                                                              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-7-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-7-2"  
class="td11">factor <!--l. 273--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> searched to depth <!--l. 273--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-8-1"  
class="td11">Worst-case space complexity</td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-8-2"  
class="td11"><!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math> if entire graph is                                                                                              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-9-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-9-2"  
class="td11">traversed without repetition,                                                                                                                                                                 </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-10-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-10-2"  
class="td11"><!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi></math>(longest path length                                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-11-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-11-2"  
class="td11">searched) = <!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>b</mi><mi 
>d</mi><mo 
class="MathClass-close">)</mo></math> for implicit                                                                                    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-12-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-12-2"  
class="td11">graphs without elimination                                                                                                                                                                   </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-13-1"  
class="td11">                        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-2-13-2"  
class="td11">of duplicate nodes                                                                                                                                                                               </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="text-align:left; white-space:nowrap;" id="TBL-2-14-1"  
class="td11">                        </td></tr></table>
</div>
                                                    
                                                    
</figure>
</div>
<h4 class="subsectionHead"><span class="titlemark">1.4.1   </span> <a 
 id="x1-220001.4.1"></a>Properties</h4>
<!--l. 286--><p class="noindent" >The time and space analysis of DFS differs according to its
application area. In theoretical computer science, DFS is
typically used to traverse an entire graph, and takes time
<!--l. 286--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math>, <sup class="textsuperscript"><a 
href="#ennote-9" id="enmark-9"><span 
class="cmr-9">9</span></a></sup> where
<!--l. 286--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo></math> is the number
of vertices and <!--l. 286--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo></math>
the number of edges. This is linear in the size of
the graph. In these applications it also uses space
<!--l. 286--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math> in
the worst case to store the stack of vertices on the current
search path as well as the set of already-visited vertices. Thus,
in this setting, the time and space bounds are the same as
for breadth-first search and the choice of which of these two
algorithms to use depends less on their complexity and more on the
different properties of the vertex orderings the two algorithms
produce.
</p><!--l. 288--><p class="noindent" >For applications of DFS in relation to specific domains, such as
searching for solutions in artificial intelligence or web-crawling, the
graph to be traversed is often either too large to visit in its entirety
or infinite (DFS may suffer from non-termination). In such cases,
search is only performed to a limited depth; due to limited
resources, such as memory or disk space, one typically does not use
data structures to keep track of the set of all previously visited
vertices. When search is performed to a limited depth, the time is
still linear in terms of the number of expanded vertices and edges
(although this number is not the same as the size of the entire
graph because some vertices may be searched more than once and
others not at all) but the space complexity of this variant of DFS is
only proportional to the depth limit, and as a result, is much
smaller than the space needed for searching to the same depth
using breadth-first search. For such applications, DFS also
lends itself much better to heuristic methods for choosing a
likely-looking branch. When an appropriate depth limit is not
known a priori, iterative deepening depth-first search applies
DFS repeatedly with a sequence of increasing limits. In the
                                                    
                                                    
artificial intelligence mode of analysis, with a branching factor
greater than one, iterative deepening increases the running
time by only a constant factor over the case in which the
correct depth limit is known due to the geometric growth
of the number of nodes per level. DFS may also be used to
collect a sample of graph nodes. However, incomplete DFS,
similarly to incomplete BFS, is biased towards nodes of high
degree.
</p><!--l. 290--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.2   </span> <a 
 id="x1-230001.4.2"></a>Example</h4>
<!--l. 292--><p class="noindent" >For the following graph:
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-230014"></a>
                                                    
                                                    
<!--l. 296--><p class="noindent" ><img 
src="graph-traversal-example.png" alt="PIC"  
width="128" height="105"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.4:</span><span  
class="content">Graph traversal example</span></figcaption><!--tex4ht:label?: x1-230014 -->
                                                    
                                                    
</figure>
<!--l. 301--><p class="noindent" >A depth-first search starting at the node
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math>,
assuming that the left edges in the shown graph are chosen
before right edges, and assuming the search remembers
previously visited nodes and will not repeat them (since this is
a small graph), will visit the nodes in the following order:
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mi 
>F</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>C</mi><mo 
class="MathClass-punc">,</mo><mi 
>G</mi></math>.
The edges traversed in this search form a
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi><mi 
>r</mi><mi 
>ê</mi><mi 
>m</mi><mi 
>a</mi><mi 
>u</mi><mi 
>x</mi></math>
tree, a structure with important applications in graph theory.
Performing the same search without remembering previously
visited nodes results in visiting the nodes in the order
<!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mi 
>F</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mi 
>F</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi></math>, etc. forever, caught
in the <!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mi 
>F</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi></math> cycle and
never reaching <!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi></math>
or <!--l. 301--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>.
Iterative deepening is one technique to avoid this infinite loop and
would reach all nodes.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.3   </span> <a 
 id="x1-240001.4.3"></a>Output of a depth-first search</h4>
<!--l. 305--><p class="noindent" >The result of a depth-first search of a graph can be conveniently
described in terms of a spanning tree of the vertices reached during
the search. Based on this spanning tree, the edges of the original
graph can be divided into three classes: forward edges, which point
from a node of the tree to one of its descendants, back edges, which
point from a node to one of its ancestors, and cross edges, which do
neither. Sometimes tree edges, edges which belong to the spanning
tree itself, are classified separately from forward edges. If the
original graph is undirected then all of its edges are tree edges or
back edges.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-240015"></a>
                                                    
                                                    
<!--l. 309--><p class="noindent" ><img 
src="tree-edges.png" alt="PIC"  
width="184" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.5:</span><span  
class="content">Tree edges</span></figcaption><!--tex4ht:label?: x1-240015 -->
                                                    
                                                    
</figure>
<h4 class="subsectionHead"><span class="titlemark">1.4.4   </span> <a 
 id="x1-250001.4.4"></a>Vertex orderings</h4>
<!--l. 316--><p class="noindent" >It is also possible to use depth-first search to linearly order the
vertices of a graph or tree. There are four possible ways of doing
this:
</p><!--l. 318--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-25002x1">
     <!--l. 319--><p class="noindent" >A <span 
class="cmbx-10">preordering </span>is a list of the vertices in the order that
     they were first visited by the depth-first search algorithm.
     This  is  a  compact  and  natural  way  of  describing  the
     progress of the search, as was done earlier in this article.
     A preordering of an expression tree is the expression in
     Polish notation.
     </p></li>
<li 
  class="enumerate" id="x1-25004x2">
     <!--l. 320--><p class="noindent" >A <span 
class="cmbx-10">postordering </span>is a list of the vertices in the order that
     they were last visited by the algorithm. A postordering
     of an expression tree is the expression in reverse Polish
     notation.
     </p></li>
<li 
  class="enumerate" id="x1-25006x3">
     <!--l. 321--><p class="noindent" >A <span 
class="cmbx-10">reverse preordering </span>is the reverse of a preordering,
     i.e. a list of the vertices in the opposite order of their first
     visit. Reverse preordering is not the same as postordering.
     </p></li>
<li 
  class="enumerate" id="x1-25008x4">
     <!--l. 322--><p class="noindent" >A <span 
class="cmbx-10">reverse postordering </span>is the reverse of a postordering,
     i.e. a list of the vertices in the opposite order of their last
     visit. Reverse postordering is not the same as preordering.</p></li></ol>
                                                    
                                                    
<!--l. 325--><p class="noindent" >For binary trees there is additionally <span 
class="cmbx-10">in-ordering </span>and <span 
class="cmbx-10">reverse</span>
<span 
class="cmbx-10">in-ordering</span>. For example, when searching the directed graph
below beginning at node A, the sequence of traversals is either
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>B</mi><mi 
>D</mi><mi 
>B</mi><mi 
>A</mi><mi 
>C</mi><mi 
>A</mi></math> or
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>C</mi><mi 
>D</mi><mi 
>C</mi><mi 
>A</mi><mi 
>B</mi><mi 
>A</mi></math>
(choosing to first visit B or C from A is up to the algorithm). Note
that repeat visits in the form of backtracking to a node, to check if
it has still unvisited neighbors, are included here (even if it is
found to have none). Thus the possible preorderings are A
B D C and A C D B, while the possible postorderings are
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>D</mi><mi 
>B</mi><mi 
>C</mi><mi 
>A</mi></math> and
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>D</mi><mi 
>C</mi><mi 
>B</mi><mi 
>A</mi></math>,
and the possible reverse postorderings are
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>C</mi><mi 
>B</mi><mi 
>D</mi></math> and
<!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>B</mi><mi 
>C</mi><mi 
>D</mi></math>.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-250096"></a>
                                                    
                                                    
<!--l. 329--><p class="noindent" ><img 
src="If-then-else-control-flow-graph.png" alt="PIC"  
width="62" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.6:</span><span  
class="content">If-then-else control flow graph.</span></figcaption><!--tex4ht:label?: x1-250096 -->
                                                    
                                                    
</figure>
<!--l. 334--><p class="noindent" >Reverse postordering produces a topological sorting of any directed
acyclic graph. This ordering is also useful in control-flow analysis as
it often represents a natural linearization of the control flows. The
graph above might represent the flow of control in the code
fragment below, and it is natural to consider this code in the order
<!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>B</mi><mi 
>C</mi><mi 
>D</mi></math> or
<!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>C</mi><mi 
>B</mi><mi 
>D</mi></math> but not natural
to use the order <!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>B</mi><mi 
>D</mi><mi 
>C</mi></math>
or <!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mi 
>C</mi><mi 
>D</mi><mi 
>B</mi></math>.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.5   </span> <a 
 id="x1-260001.4.5"></a>Complexity</h4>
<!--l. 338--><p class="noindent" >The computational complexity of DFS was investigated
by John Reif. More precisely, given a graph
<!--l. 338--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math>, let
<!--l. 338--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> be
the ordering computed by the standard recursive DFS algorithm.
This ordering is called the lexicographic depth-first search ordering.
John Reif considered the complexity of computing the lexicographic
depth-first search ordering, given a graph and a source. A decision
version of the problem (testing whether some vertex u occurs before
some vertex v in this order) is P-complete, meaning that it is “a
nightmare for parallel processing”. <sup class="textsuperscript"><a 
href="#ennote-10" id="enmark-10"><span 
class="cmr-9">10</span></a></sup>
</p><!--l. 340--><p class="noindent" >A depth-first search ordering (not necessarily the lexicographic
one), can be computed by a randomized parallel algorithm in the
complexity class RNC. As of 1997, it remained unknown whether a
depth-first traversal could be constructed by a deterministic parallel
algorithm, in the complexity class NC.
</p><!--l. 342--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.6   </span> <a 
 id="x1-270001.4.6"></a>Applications</h4>
<!--l. 344--><p class="noindent" >Algorithms that use depth-first search as a building block
include:
                                                    
                                                    
</p><!--l. 346--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-27002x1">
     <!--l. 347--><p class="noindent" >Finding connected components.
     </p></li>
<li 
  class="enumerate" id="x1-27004x2">
     <!--l. 348--><p class="noindent" >Topological sorting.
     </p></li>
<li 
  class="enumerate" id="x1-27006x3">
     <!--l. 349--><p class="noindent" >Finding 2-(edge or vertex)-connected components.
     </p></li>
<li 
  class="enumerate" id="x1-27008x4">
     <!--l. 350--><p class="noindent" >Finding 3-(edge or vertex)-connected components.
     </p></li>
<li 
  class="enumerate" id="x1-27010x5">
     <!--l. 351--><p class="noindent" >Finding the bridges of a graph.
     </p></li>
<li 
  class="enumerate" id="x1-27012x6">
     <!--l. 352--><p class="noindent" >Generating words in order to plot the limit set of a group.
     </p></li>
<li 
  class="enumerate" id="x1-27014x7">
     <!--l. 353--><p class="noindent" >Finding strongly connected components.
     </p></li>
<li 
  class="enumerate" id="x1-27016x8">
     <!--l. 354--><p class="noindent" >Determining whether a species is closer to one species or
     another in a phylogenetic tree.
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-27018x9">
     <!--l. 355--><p class="noindent" >Planarity testing.
     </p></li>
<li 
  class="enumerate" id="x1-27020x10">
     <!--l. 356--><p class="noindent" >Solving puzzles with only one solution, such as mazes.
     (DFS can be adapted to find all solutions to a maze by
     only including nodes on the current path in the visited
     set.)
     </p></li>
<li 
  class="enumerate" id="x1-27022x11">
     <!--l. 357--><p class="noindent" >Maze generation may use a randomized depth-first search.
     </p></li>
<li 
  class="enumerate" id="x1-27024x12">
     <!--l. 358--><p class="noindent" >Finding biconnectivity in graphs.</p></li></ol>
<!--l. 362--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.7   </span> <a 
 id="x1-280001.4.7"></a>Python practice</h4>
<!--l. 364--><p class="noindent" >Depth First Traversal (or Search) for a graph is similar to Depth
First Traversal of a tree. The only catch here is, unlike trees,
graphs may contain cycles (a node may be visited twice). To
avoid processing a node more than once, use a boolean visited
array.
</p><!--l. 366--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-290001.4.7"></a>Example </h5>
                                                    
                                                    
<!--l. 368--><p class="noindent" >Input  n = 4, e = 6 <br 
class="newline" /><!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>3</mn><mo 
class="MathClass-punc">,</mo><mn>3</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>3</mn></math>
<br 
class="newline" />Output DFS from vertex <!--l. 370--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-punc">:</mo> <mn>1</mn><mn>2</mn><mn>0</mn><mn>3</mn></math>
<br 
class="newline" />
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-290017"></a>
                                                    
                                                    
<!--l. 375--><p class="noindent" >
</p>
<figcaption class="caption" ><span class="id">Figure 1.7:</span><span  
class="content">DFS algorithm example 1</span></figcaption><!--tex4ht:label?: x1-290017 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-300001.4.7"></a>Example </h5>
<!--l. 382--><p class="noindent" >Input: n = 4, e = 6 <br 
class="newline" /><!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>3</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>3</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>3</mn></math>
<br 
class="newline" />Output: DFS from vertex <!--l. 384--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn> <mo 
class="MathClass-punc">:</mo> <mn>2</mn><mn>0</mn><mn>1</mn><mn>3</mn></math>
<br 
class="newline" />
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-300018"></a>
                                                    
                                                    
<!--l. 389--><p class="noindent" >
</p>
<figcaption class="caption" ><span class="id">Figure 1.8:</span><span  
class="content">DFS algorithm example 2</span></figcaption><!--tex4ht:label?: x1-300018 -->
                                                    
                                                    
</figure>
<!--l. 394--><p class="noindent" >Depth-first search is an algorithm for traversing or searching tree or
graph data structures. The algorithm starts at the root node
(selecting some arbitrary node as the root node in the case of
a graph) and explores as far as possible along each branch
before backtracking. So the basic idea is to start from the root
or any arbitrary node and mark the node and move to the
adjacent unmarked node and continue this loop until there is no
unmarked adjacent node. Then backtrack and check for other
unmarked nodes and traverse them. Finally, print the nodes in the
path.
</p><!--l. 396--><p class="noindent" >Below are implementations of simple Depth First Traversal. The
Python implementation uses an adjacency list representation of
graphs. STLs list container is used to store lists of adjacent
nodes.
</p>
<!--l. 398--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30002r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python3</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30003r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30004r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">collections</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30005r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30006r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">represents</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">directed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30007r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">representation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30008r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30009r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30010r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span id="textcolor57"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30011r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30012r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Constructor</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30013r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor68"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30014r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30015r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">default</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dictionary</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30016r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor85"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30017r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30018r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30019r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">u</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor119"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30020r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor124"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">u</span><span id="textcolor127"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30021r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30022r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">A</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">used</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30023r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span id="textcolor157"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30024r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30025r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Mark</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30026r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30027r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">add</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30028r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span id="textcolor191"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30029r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30030r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Recur</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30031r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">this</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30032r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor226"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor229"><span 
class="cmtt-8">]</span></span><span id="textcolor231"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30033r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor242"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30034r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30035r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30036r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">The</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">do</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">It</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">uses</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30037r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursive</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFSUtil</span><span 
class="cmsltt-10x-x-80">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30038r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor286"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30039r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30040r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">set</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30041r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor305"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">set</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30042r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30043r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Call</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursive</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">helper</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30044r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30045r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30046r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30047r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Driver</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">code</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30048r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30049r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30050r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30051r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">above</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">diagram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30052r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8"> </span><span id="textcolor364"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30053r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30054r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30055r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30056r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30057r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30058r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30059r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30060r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Following</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DFS</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">starting</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">vertex</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30061r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-30062r61"></a><span 
class="cmr-5">61</span></span></pre>
     <ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-30064x1">
     <!--l. 463--><p class="noindent" >Time complexity: <!--l. 463--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>E</mi><mo 
class="MathClass-close">)</mo></math>,
     where <!--l. 463--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>
     is the number of vertices and E is the number of edges in
     the graph.
     </p></li>
<li 
  class="enumerate" id="x1-30066x2">
     <!--l. 464--><p class="noindent" >Space Complexity: <!--l. 464--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-close">)</mo></math>,
     since an extra visited array of size <!--l. 464--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>
     is required.</p></li></ol>
<h4 class="subsectionHead"><span class="titlemark">1.4.8   </span> <a 
 id="x1-310001.4.8"></a> Handling A Disconnected Graph</h4>
                                                    
                                                    
<!--l. 469--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-320001.4.8"></a>Solution</h5>
<!--l. 471--><p class="noindent" >This will happen by handling a corner case. The above code
traverses only the vertices reachable from a given source vertex. All
the vertices may not be reachable from a given vertex, as in a
Disconnected graph. To do a complete DFS traversal of such
graphs, run DFS from all unvisited nodes after a DFS. The
recursive function remains the same.
</p><!--l. 474--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-330001.4.8"></a>Algorithm</h5>
<!--l. 476--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-33002x1">
     <!--l. 477--><p class="noindent" >Create a recursive function that takes the index of the
     node and a visited array.
     </p></li>
<li 
  class="enumerate" id="x1-33004x2">
     <!--l. 478--><p class="noindent" >Mark the current node as visited and print the node.
     </p></li>
<li 
  class="enumerate" id="x1-33006x3">
     <!--l. 479--><p class="noindent" >Traverse all the adjacent and unmarked nodes and call the
     recursive function with the index of the adjacent node.
     </p></li>
<li 
  class="enumerate" id="x1-33008x4">
     <!--l. 480--><p class="noindent" >Run a loop from 0 to the number of vertices and check
     if  the  node  is  unvisited  in  the  previous  DFS,  call  the
     recursive function with the current node.
                                                    
                                                    
</p>
     </li></ol>
<!--l. 484--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.4.9   </span> <a 
 id="x1-340001.4.9"></a>Python implementation</h4>
<!--l. 486--><p class="noindent" >The below code explains procedure to handle a disconnected
graph.
</p>
<!--l. 489--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">complete</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">collections</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">this</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">represents</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">directed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">representation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span id="textcolor501"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Constructor</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor514"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">default</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dictionary</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor535"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">u</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor571"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor578"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">u</span><span id="textcolor581"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">A</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">used</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span id="textcolor613"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Mark</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">add</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">end</span><span id="textcolor651"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recur</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">this</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor689"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor692"><span 
class="cmtt-8">]</span></span><span id="textcolor694"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor708"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">neighbour</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">The</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">do</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">It</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">uses</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursive</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFSUtil</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor754"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">set</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34031r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor779"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">set</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34032r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">call</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursive</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">helper</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">starting</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34033r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">one</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">one</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34034r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">vertex</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor833"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34035r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">vertex</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor847"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34036r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFSUtil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">vertex</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34037r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Driver</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">code</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34038r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">above</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">diagram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34039r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34040r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Following</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Depth</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">First</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Traversal</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">\</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34041r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8"> </span><span id="textcolor903"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34042r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34043r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34044r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34045r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34046r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34047r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34048r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DFS</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-34049r49"></a><span 
class="cmr-5">49</span></span></pre>
<!--l. 541--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-350001.4.9"></a>Complexity Analysis</h5>
<!--l. 543--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-35002x1">
     <!--l. 544--><p class="noindent" >Time complexity: <!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>E</mi><mo 
class="MathClass-close">)</mo></math>,
     where <!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>
     is the number of vertices and <!--l. 544--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>
     is the number of edges in the graph.
     </p></li>
<li 
  class="enumerate" id="x1-35004x2">
     <!--l. 545--><p class="noindent" >Space Complexity: <!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-close">)</mo></math>,
     since an extra visited array of size <!--l. 545--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>
     is required.
</p>
     </li></ol>
                                                    
                                                    
<!--l. 549--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.5   </span> <a 
 id="x1-360001.5"></a>Breadth-first search</h3>
<!--l. 551--><p class="noindent" >Breadth-first search (BFS) is an algorithm for searching a tree data
structure for a node that satisfies a given property. It starts at the
tree root and explores all nodes at the present depth prior to
moving on to the nodes at the next depth level. Extra memory,
usually a queue, is needed to keep track of the child nodes that were
encountered but not yet explored.
</p><!--l. 553--><p class="noindent" >For example, in a chess endgame a chess engine may build the game
tree from the current position by applying all possible moves, and
use breadth-first search to find a win position for white. Implicit
trees (such as game trees or other problem-solving trees) may be of
infinite size; breadth-first search is guaranteed to find a solution
node if one exists.
</p><!--l. 555--><p class="noindent" >In contrast, (plain) depth-first search, which explores the node
branch as far as possible before backtracking and expanding
other nodes, may get lost in an infinite branch and never
make it to the solution node. Iterative deepening depth-first
search avoids the latter drawback at the price of exploring
the tree’s top parts over and over again. On the other hand,
both depth-first algorithms get along without extra memory.
Breadth-first search can be generalized to graphs, when the start
node (sometimes referred to as a ’search key’) is explicitly
given, and precautions are taken against following a vertex
twice.
</p><!--l. 557--><p class="noindent" >BFS and its application in finding connected components of graphs
were invented in 1945 by Konrad Zuse, in his (rejected) Ph.D.
thesis on the Plankalkl programming language, but this was not
published until 1972. It was reinvented in 1959 by Edward F.
Moore, who used it to find the shortest path out of a maze, and
later developed by C. Y. Lee into a wire routing algorithm
(published 1961).
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-360019"></a>
                                                    
                                                    
<!--l. 561--><p class="noindent" ><img 
src="breadth-first-tree.png" alt="PIC"  
width="170" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.9:</span><span  
class="content">Breadth first tree</span></figcaption><!--tex4ht:label?: x1-360019 -->
                                                    
                                                    
</figure>
<div class="table">
                                                    
                                                    
<!--l. 566--><p class="noindent" ><a 
 id="x1-360021"></a></p><figure class="float" 
>
                                                    
                                                    
<div class="tabular"> <table id="TBL-3" class="tabular" 
 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1" /><col 
id="TBL-3-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-1-1"  
class="td11">Class                              </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-1-2"  
class="td11">Search algorithm                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-2-1"  
class="td11">Data structure                  </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-2-2"  
class="td11">Graph                                                                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-3-1"  
class="td11">Worst-case performance      </td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-3-2"  
class="td11"><!--l. 571--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-4-1"  
class="td11">Worst-case space complexity</td><td  style="text-align:left; white-space:nowrap;" id="TBL-3-4-2"  
class="td11"><!--l. 572--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-3-5-1"  
class="td11">                        </td></tr></table>
</div>
<figcaption class="caption" ><span class="id">Table 1.1:</span><span  
class="content">Deatails of BFS</span></figcaption><!--tex4ht:label?: x1-360021 -->
                                                    
                                                    
</figure>
</div>
<h4 class="subsectionHead"><span class="titlemark">1.5.1   </span> <a 
 id="x1-370001.5.1"></a>More details</h4>
<!--l. 581--><p class="noindent" >This non-recursive implementation is similar to the non-recursive
implementation of depth-first search, but differs from it in two
ways:
</p><!--l. 583--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-37002x1">
     <!--l. 584--><p class="noindent" >it uses a queue (First In First Out) instead of a stack and
     </p></li>
<li 
  class="enumerate" id="x1-37004x2">
     <!--l. 585--><p class="noindent" >it  checks  whether  a  vertex  has  been  explored  before
     enqueueing  the  vertex  rather  than  delaying  this  check
     until the vertex is dequeued from the queue.</p></li></ol>
<!--l. 588--><p class="noindent" >If G is a tree, replacing the queue of this breadth-first search
algorithm with a stack will yield a depth-first search algorithm. For
general graphs, replacing the stack of the iterative depth-first
search implementation with a queue would also produce a
breadth-first search algorithm, although a somewhat nonstandard
one.
</p><!--l. 590--><p class="noindent" >The Q queue contains the frontier along which the algorithm is
currently searching. Nodes can be labelled as explored by storing
them in a set, or by an attribute on each node, depending on the
implementation. Note that the word node is usually interchangeable
with the word vertex. The parent attribute of each node is useful
for accessing the nodes in a shortest path, for example by
backtracking from the destination node up to the starting node,
once the BFS has been run, and the predecessors nodes have been
set. Breadth-first search produces a so-called breadth first tree.
You can see how a breadth first tree looks in the following
example.
                                                    
                                                    
</p><!--l. 592--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-380001.5.1"></a>Example</h5>
<!--l. 594--><p class="noindent" >The following is an example of the breadth-first tree obtained by
running a BFS on German cities starting from Frankfurt:
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3800110"></a>
                                                    
                                                    
<!--l. 598--><p class="noindent" ><img 
src="map-germany-graph.png" alt="PIC"  
width="142" height="142"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.10:</span><span  
class="content">An example map of Southern Germany with some
connections between cities</span></figcaption><!--tex4ht:label?: x1-3800110 -->
                                                    
                                                    
</figure>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3800211"></a>
                                                    
                                                    
<!--l. 605--><p class="noindent" ><img 
src="GermanyBFS.png" alt="PIC"  
width="170" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.11:</span><span  
class="content">The breadth-first tree obtained when running BFS
on the given map and starting in Frankfurt</span></figcaption><!--tex4ht:label?: x1-3800211 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-390001.5.1"></a>Practice exercise</h5>
<!--l. 612--><p class="noindent" >Let us see how this algorithm works with an example. Here, we will
use an undirected graph with 5 vertices. Refer to <a 
href="#x1-3900112">1.12<!--tex4ht:ref: iter-1 --></a>.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900112"></a>
                                                    
                                                    
<!--l. 616--><p class="noindent" ><img 
src="bfs-1.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.12:</span><span  
class="content">BFS Iteration -1</span></figcaption><!--tex4ht:label?: x1-3900112 -->
                                                    
                                                    
</figure>
<!--l. 621--><p class="noindent" >We begin from the vertex P, the BFS algorithmic program starts by
putting it within the Visited list and puts all its adjacent vertices
within the stack. Refer to <a 
href="#x1-3900213">1.13<!--tex4ht:ref: iter-2 --></a>
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900213"></a>
                                                    
                                                    
<!--l. 625--><p class="noindent" ><img 
src="bfs-2.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.13:</span><span  
class="content">BFS Iteration -2</span></figcaption><!--tex4ht:label?: x1-3900213 -->
                                                    
                                                    
</figure>
<!--l. 630--><p class="noindent" >Next, we have a tendency to visit the part at the front of the
queue i.e. Q and visit its adjacent nodes. Since P has already
been visited, we have a tendency to visit R instead. Refer to
<span 
class="cmbx-10">??</span>
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900314"></a>
                                                    
                                                    
<!--l. 634--><p class="noindent" ><img 
src="bfs-3.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.14:</span><span  
class="content">BFS Iteration -3</span></figcaption><!--tex4ht:label?: x1-3900314 -->
                                                    
                                                    
</figure>
<!--l. 639--><p class="noindent" >Vertex R has an unvisited adjacent vertex in T, thus we have a
tendency to add that to the rear of the queue and visit S, which is
at the front of the queue. Refer to <a 
href="#x1-3900415">1.15<!--tex4ht:ref: iter-4 --></a> &#x0026; <a 
href="#x1-3900516">1.16<!--tex4ht:ref: iter-5 --></a>.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900415"></a>
                                                    
                                                    
<!--l. 643--><p class="noindent" ><img 
src="bfs-4.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.15:</span><span  
class="content">BFS Iteration -4</span></figcaption><!--tex4ht:label?: x1-3900415 -->
                                                    
                                                    
</figure>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900516"></a>
                                                    
                                                    
<!--l. 650--><p class="noindent" ><img 
src="bfs-5.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.16:</span><span  
class="content">BFS Iteration -5</span></figcaption><!--tex4ht:label?: x1-3900516 -->
                                                    
                                                    
</figure>
<!--l. 656--><p class="noindent" >Now, only T remains within the queue since the only adjacent node
of S i.e. P is already visited. We have a tendency to visit it. Refer to
<a 
href="#x1-3900617">1.17<!--tex4ht:ref: iter-6 --></a>
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-3900617"></a>
                                                    
                                                    
<!--l. 660--><p class="noindent" ><img 
src="bfs-6.jpg" alt="PIC"  
width="99" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.17:</span><span  
class="content">BFS Iteration -6</span></figcaption><!--tex4ht:label?: x1-3900617 -->
                                                    
                                                    
</figure>
<!--l. 665--><p class="noindent" >Since the queue is empty, we’ve completed the Traversal of the graph.
The time complexity of the Breadth first Search algorithm is in the
form of <!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>E</mi><mo 
class="MathClass-close">)</mo></math>,
where <!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>
is the representation of the number of nodes and
<!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math> is the
number of edges. Also, the space complexity of the BFS algorithm
is <!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>V</mi> <mo 
class="MathClass-close">)</mo></math>.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.5.2   </span> <a 
 id="x1-400001.5.2"></a>Analysis</h4>
<!--l. 670--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-410001.5.2"></a>Time and space complexity</h5>
<!--l. 672--><p class="noindent" >The time complexity can be expressed as
<!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math>,
since every vertex and every edge will be explored in the worst case.
<!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo></math> is the number
of vertices and <!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo></math>
is the number of edges in the graph. Note that
<!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>E</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math> may vary
between <!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></math>
and <!--l. 672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>,
depending on how sparse the input graph is.
</p><!--l. 674--><p class="noindent" >When the number of vertices in the graph is known ahead of time, and
additional data structures are used to determine which vertices have
already been added to the queue, the space complexity can be expressed
as <!--l. 674--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo></math>,
where <!--l. 674--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>V</mi> <mo 
class="MathClass-rel">|</mo></math>
is the number of vertices. This is in addition to the space
required for the graph itself, which may vary depending on
the graph representation used by an implementation of the
algorithm.
</p><!--l. 676--><p class="noindent" >When working with graphs that are too large to store explicitly (or
                                                    
                                                    
infinite), it is more practical to describe the complexity of breadth-first
search in different terms: to find the nodes that are at distance d from
the start node (measured in number of edge traversals), BFS takes
<!--l. 676--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>b</mi><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></math> time
and memory, where <span 
class="cmti-10">b </span>is the “branching factor” of the graph (the
average out-degree).
</p><!--l. 678--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-420001.5.2"></a>Completeness</h5>
<!--l. 680--><p class="noindent" >In the analysis of algorithms, the input to breadth-first search is
assumed to be a finite graph, represented as an adjacency list,
adjacency matrix, or similar representation. However, in the
application of graph traversal methods in artificial intelligence the
input may be an implicit representation of an infinite graph. In this
context, a search method is described as being complete if it is
guaranteed to find a goal state if one exists. Breadth-first search
is complete, but depth-first search is not. When applied to
infinite graphs represented implicitly, breadth-first search will
eventually find the goal state, but depth first search may get
lost in parts of the graph that have no goal state and never
return.
</p><!--l. 682--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.5.3   </span> <a 
 id="x1-430001.5.3"></a>BFS ordering</h4>
<!--l. 684--><p class="noindent" >An enumeration of the vertices of a graph is said to be a BFS
ordering if it is the possible output of the application of BFS to this
graph.
</p><!--l. 686--><p class="noindent" >Let <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>V</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-close">)</mo></math> be a graph with
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math> vertices. Recall
that <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi><mo 
class="MathClass-open">(</mo><mi 
>v</mi><mo 
class="MathClass-close">)</mo></math> is the set of
neighbors of <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>. Let
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>m</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> be a list of distinct
elements of <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>,
for <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mo 
class="MathClass-bin">∖</mo><mo 
class="MathClass-open">{</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>m</mi></mrow></msub 
><mo 
class="MathClass-close">}</mo></math>, let
                                                    
                                                    
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>ν</mi></mrow><mrow 
><mi 
>σ</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>v</mi><mo 
class="MathClass-close">)</mo></math> be the least
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math> such that
<!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> is a neighbor
of <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi></math>, if such
a <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math> exists,
and be <!--l. 686--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>∞</mi></math>
otherwise.
</p><!--l. 688--><p class="noindent" >Let <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> be an enumeration
of the vertices of <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math>.
The enumeration <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi></math>
is said to be a BFS ordering (with source
<!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>) if, for
all <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>i</mi> <mo 
class="MathClass-rel">≤</mo> <mi 
>n</mi></math>,
<!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> is the vertex
<!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>w</mi> <mo 
class="MathClass-rel">∈</mo> <mi 
>V</mi> <mo 
class="MathClass-bin">∖</mo><mo 
class="MathClass-open">{</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">}</mo></math> such that
<!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>ν</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>w</mi><mo 
class="MathClass-close">)</mo></math> is minimal.
Equivalently, <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi></math> is a BFS
ordering if, for all <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">≤</mo> <mi 
>i</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>j</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>k</mi> <mo 
class="MathClass-rel">≤</mo> <mi 
>n</mi></math>
with <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">∈</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>k</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">∖</mo> <mi 
>N</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>, there
exists a neighbor <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>m</mi></mrow></msub 
></math>
of <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>v</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
></math> such
that <!--l. 688--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>i</mi></math>.
</p><!--l. 690--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.5.4   </span> <a 
 id="x1-440001.5.4"></a>Applications</h4>
<!--l. 692--><p class="noindent" >Breadth-first search can be used to solve many problems in graph
theory, for example:
</p><!--l. 694--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-44002x1">
     <!--l. 695--><p class="noindent" >Copying garbage collection, Cheney’s algorithm
     </p></li>
<li 
  class="enumerate" id="x1-44004x2">
                                                    
                                                    
     <!--l. 696--><p class="noindent" >Finding the shortest path between two nodes u and v, with
     path length measured by number of edges (an advantage
     over depth-first search)
     </p></li>
<li 
  class="enumerate" id="x1-44006x3">
     <!--l. 697--><p class="noindent" >(Reverse) CuthillMcKee mesh numbering
     </p></li>
<li 
  class="enumerate" id="x1-44008x4">
     <!--l. 698--><p class="noindent" >FordFulkerson method for computing the maximum flow
     in a flow network
     </p></li>
<li 
  class="enumerate" id="x1-44010x5">
     <!--l. 699--><p class="noindent" >Serialization/Deserialization         of         a         binary
     tree vs serialization in sorted order, allows the tree to be
     re-constructed in an efficient manner.
     </p></li>
<li 
  class="enumerate" id="x1-44012x6">
     <!--l. 700--><p class="noindent" >Construction of the failure function of the Aho-Corasick
     pattern matcher.
     </p></li>
<li 
  class="enumerate" id="x1-44014x7">
     <!--l. 701--><p class="noindent" >Testing bipartiteness of a graph.
     </p></li>
<li 
  class="enumerate" id="x1-44016x8">
     <!--l. 702--><p class="noindent" >Implementing parallel algorithms for computing a graph’s
     transitive closure.</p></li></ol>
                                                    
                                                    
<!--l. 705--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.5.5   </span> <a 
 id="x1-450001.5.5"></a>Breadth First Search using Python</h4>
<!--l. 707--><p class="noindent" >Breadth-First Traversal (or Search) for a graph is similar
to Breadth-First Traversal of a tree. The only catch here
is, unlike trees, graphs may contain cycles, so we may come
to the same node again. To avoid processing a node more
than once, we use a boolean visited array. For simplicity, it
is assumed that all vertices are reachable from the starting
vertex.
</p><!--l. 709--><p class="noindent" >For example, in the following graph, we start traversal from vertex
2. When we come to vertex 0, we look for all adjacent vertices of it.
2 is also an adjacent vertex of 0. If we dont mark visited vertices,
then 2 will be processed again and it will become a non-terminating
process. A Breadth-First Traversal of the following graph is 2, 0, 3,
1.
</p>
<!--l. 711--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python3</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">BFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">source</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">BFS</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">int</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traverses</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reachable</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">collections</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">represents</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">directed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">representation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span id="textcolor1042"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Constructor</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor1053"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">default</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dictionary</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor1070"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">u</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor1102"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor1107"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">u</span><span id="textcolor1110"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">BFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">BFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">s</span><span 
class="cmtt-8">)</span><span id="textcolor1141"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Mark</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor1160"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor1163"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">False</span><span id="textcolor1166"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor1169"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">max</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor1180"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">queue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">BFS</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span 
class="cmtt-8"> </span><span id="textcolor1198"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor1201"><span 
class="cmtt-8">[</span></span><span id="textcolor1203"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Mark</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">source</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">enqueue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45031r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">s</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45032r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor1232"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">s</span><span id="textcolor1235"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor1238"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45033r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45034r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">while</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span id="textcolor1245"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45035r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45036r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Dequeue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45037r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">queue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45038r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">s</span><span 
class="cmtt-8"> </span><span id="textcolor1267"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45039r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">s</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span 
class="cmtt-8"> </span><span id="textcolor1284"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45040r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45041r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45042r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dequeued</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">If</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacent</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45043r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">has</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">been</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">then</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">mark</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45044r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">enqueue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45045r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor1352"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">s</span><span id="textcolor1355"><span 
class="cmtt-8">]</span></span><span id="textcolor1357"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45046r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor1362"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor1365"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor1368"><span 
class="cmtt-8">=</span></span><span id="textcolor1370"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span id="textcolor1374"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45047r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45048r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor1383"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor1386"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor1389"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45049r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45050r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Driver</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">code</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45051r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45052r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45053r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">above</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">diagram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45054r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8"> </span><span id="textcolor1418"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45055r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45056r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45057r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45058r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45059r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45060r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45061r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45062r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Following</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Breadth</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">First</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Traversal</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45063r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">starting</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">vertex</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45064r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">BFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-45065r65"></a><span 
class="cmr-5">65</span></span></pre>
<!--l. 778--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.6   </span> <a 
 id="x1-460001.6"></a>Iterative deepening (Depth-first search)</h3>
<!--l. 780--><p class="noindent" >In computer science, iterative deepening search or more specifically
iterative deepening depth-first search (IDS or IDDFS) is a state
space/graph search strategy in which a depth-limited version of
depth-first search is run repeatedly with increasing depth limits
until the goal is found. IDDFS is optimal like breadth-first search,
but uses much less memory; at each iteration, it visits the nodes in
the search tree in the same order as depth-first search, but the
cumulative order in which nodes are first visited is effectively
breadth-first. <sup class="textsuperscript"><a 
href="#ennote-11" id="enmark-11"><span 
class="cmr-9">11</span></a></sup>
</p><!--l. 782--><p class="noindent" >
</p>
                                                    
                                                    
<h4 class="subsectionHead"><span class="titlemark">1.6.1   </span> <a 
 id="x1-470001.6.1"></a>Properties</h4>
<!--l. 784--><p class="noindent" >IDDFS combines depth-first search’s space-efficiency and breadth-first
search’s completeness (when the branching factor is finite). If a
solution exists, it will find a solution path with the fewest
arcs. Since iterative deepening visits states multiple times,
it may seem wasteful, but it turns out to be not so costly,
since in a tree most of the nodes are in the bottom level, so it
does not matter much if the upper levels are visited multiple
times.
</p><!--l. 786--><p class="noindent" >The main advantage of IDDFS in game tree searching is that the
earlier searches tend to improve the commonly used heuristics, such
as the killer heuristic and alphabeta pruning, so that a more
accurate estimate of the score of various nodes at the final
depth search can occur, and the search completes more quickly
since it is done in a better order. For example, alphabeta
pruning is most efficient if it searches the best moves first.
<sup class="textsuperscript"><a 
href="#ennote-12" id="enmark-12"><span 
class="cmr-9">12</span></a></sup>
</p><!--l. 788--><p class="noindent" >A second advantage is the responsiveness of the
algorithm. Because early iterations use small values for
<!--l. 788--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>, they
execute extremely quickly. This allows the algorithm to supply early
indications of the result almost immediately, followed by refinements
as <!--l. 788--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>
increases. When used in an interactive setting, such as in a
chess-playing program, this facility allows the program to play at
any time with the current best move found in the search it has
completed so far. This can be phrased as each depth of the search
corecursively producing a better approximation of the solution,
though the work done at each step is recursive. This is not possible
with a traditional depth-first search, which does not produce
intermediate results.
</p><!--l. 790--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.6.2   </span> <a 
 id="x1-480001.6.2"></a>Analysis</h4>
                                                    
                                                    
<!--l. 792--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-490001.6.2"></a>Time complexity</h5>
<!--l. 794--><p class="noindent" >The time complexity of IDDFS in a (well-balanced) tree
works out to be the same as breadth-first search, i.e.
<!--l. 794--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math> where
<!--l. 794--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> is the branching
factor and <!--l. 794--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>
is the depth of the goal.
</p><!--l. 796--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-500001.6.2"></a>Proof</h5>
<!--l. 798--><p class="noindent" >In an iterative deepening search, the nodes at depth
<!--l. 798--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math> are expanded once,
those at depth <!--l. 798--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>
are expanded twice, and so on up to the root of the search tree, which is
expanded <!--l. 798--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>
times.? So the total number of expansions in an iterative deepening
search is
</p><!--l. 800--><p class="noindent" ><!--l. 800--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">⋯</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi><mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
>d</mi><mi 
>b</mi> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><msubsup><mrow 
><mi 
class="MathClass-op"> ∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>d</mi></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn> <mo 
class="MathClass-bin">−</mo><mi 
>i</mi><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></math>
</p><!--l. 802--><p class="noindent" >where <!--l. 802--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math>
is the number of expansions at depth
<!--l. 802--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>,
<!--l. 802--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></math>
is the number of expansions at depth
<!--l. 802--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>, and so on.
Factoring out <!--l. 802--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math>
gives
</p><!--l. 804--><p class="noindent" ><!--l. 804--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">⋯</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>2</mn><mo 
class="MathClass-bin">−</mo><mi 
>d</mi></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
>d</mi><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-bin">−</mo><mi 
>d</mi></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
</p><!--l. 806--><p class="noindent" >Now let <!--l. 806--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>b</mi></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></math>.
Then we have
</p><!--l. 808--><p class="noindent" ><!--l. 808--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">⋯</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
>d</mi><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
</p><!--l. 810--><p class="noindent" >This is less than the infinite series
</p><!--l. 812--><p class="noindent" ><!--l. 812--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>4</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">⋯</mo><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
> <mrow><mo fence="true" form="prefix"> (</mo><mrow><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>∞</mi></mrow></msubsup 
><mi 
>n</mi><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></mrow><mo fence="true" form="postfix">)</mo></mrow></math>
                                                    
                                                    
</p><!--l. 814--><p class="noindent" >which converges to
</p><!--l. 816--><p class="noindent" ><!--l. 816--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
>    <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></mfrac> </math>
</p><!--l. 818--><p class="noindent" >That is, we have
</p><!--l. 820--><p class="noindent" ><!--l. 820--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mi 
>x</mi> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">⋯</mo> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi><mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
>d</mi><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-open">(</mo><mi 
>d</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo><msup><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≤</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
></math>, for
<!--l. 820--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi><mi 
>b</mi><mi 
>s</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>1</mn></math>
</p><!--l. 822--><p class="noindent" >Since <!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
></math> or
<!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mn>1</mn> <mo 
class="MathClass-bin">−</mo><mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>b</mi></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> </mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>2</mn></mrow></msup 
></math> is a constant
independent of <!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>
(the depth), if <!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>1</mn></math>
(i.e., if the branching factor is greater than 1), the running
time of the depth-first iterative deepening search is
<!--l. 822--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>.
</p><!--l. 824--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.6.3   </span> <a 
 id="x1-510001.6.3"></a>Example</h4>
<!--l. 826--><p class="noindent" >For <!--l. 826--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>0</mn></math>
and <!--l. 826--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></math>
the number is
</p><!--l. 828--><p class="noindent" ><!--l. 828--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mn>5</mn></mrow></msubsup 
><mo 
class="MathClass-open">(</mo><mn>5</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn> <mo 
class="MathClass-bin">−</mo><mi 
>i</mi><mo 
class="MathClass-close">)</mo><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mi 
>i</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mn>6</mn> <mo 
class="MathClass-bin">+</mo> <mn>5</mn><mn>0</mn> <mo 
class="MathClass-bin">+</mo> <mn>4</mn><mn>0</mn><mn>0</mn> <mo 
class="MathClass-bin">+</mo> <mn>3</mn><mn>0</mn><mn>0</mn><mn>0</mn> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn><mn>0</mn> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>2</mn><mn>3</mn><mn>4</mn><mn>5</mn><mn>6</mn></math>
</p><!--l. 830--><p class="noindent" >All together, an iterative deepening search from depth
<!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math> all the way down
to depth <!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math> expands
only about <!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>1</mn><mi 
>%</mi></math>
more nodes than a single breadth-first or depth-limited search to
depth <!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>,
when <!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>0</mn></math>.
The higher the branching factor, the lower the overhead of
repeatedly expanded states, but even when the branching
factor is 2, iterative deepening search only takes about twice
as long as a complete breadth-first search. This means
that the time complexity of iterative deepening is still
<!--l. 830--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>.
                                                    
                                                    
</p><!--l. 832--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-520001.6.3"></a>Space complexity</h5>
<!--l. 833--><p class="noindent" >The space complexity of IDDFS is
<!--l. 833--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>d</mi><mo 
class="MathClass-close">)</mo></math>, where
<!--l. 833--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math> is
the depth of the goal.
</p><!--l. 835--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-530001.6.3"></a>Proof</h5>
<!--l. 836--><p class="noindent" >Since IDDFS, at any point, is engaged in a depth-first search,
it need only store a stack of nodes which represents the
branch of the tree it is expanding. Since it finds a solution
of optimal length, the maximum depth of this stack is
<!--l. 836--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>,
and hence the maximum amount of space is
<!--l. 836--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>d</mi><mo 
class="MathClass-close">)</mo></math>. In
general, iterative deepening is the preferred search method when
there is a large search space and the depth of the solution is not
known.
</p><!--l. 838--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.6.4   </span> <a 
 id="x1-540001.6.4"></a>Python practice for Iterative Deepening</h4>
<!--l. 838--><p class="noindent" ><span class="footnote-mark"><a 
href="ai2.html#fn1x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-54001f1"></a>
</p><!--l. 840--><p class="noindent" >The Iterative Deepening Depth-First Search (also ID-DFS)
algorithm is an algorithm used to find a node in a tree. This
                                                    
                                                    
means that given a tree data structure, the algorithm will
return the first node in this tree that matches the specified
condition. Nodes are sometimes referred to as vertices (plural of
vertex) - here, we’ll call them nodes. The edges have to be
unweighted. This algorithm can also work with unweighted
graphs if mechanism to keep track of already visited nodes is
added.
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-550001.6.4"></a>Description of the Algorithm</h5>
<!--l. 844--><p class="noindent" >The basic principle of the algorithm is to start with a start node,
and then look at the first child of this node. It then looks at the
first child of that node (grandchild of the start node) and so on,
until a node has no more children (weve reached a leaf node). It
then goes up one level, and looks at the next child. If there are no
more children, it goes up one more level, and so on, until it find
more children or reaches the start node. If hasnt found the goal
node after returning from the last child of the start node, the
goal node cannot be found, since by then all nodes have been
traversed.
</p><!--l. 846--><p class="noindent" >So far this has been describing Depth-First Search (DFS). Iterative
deepening adds to this, that the algorithm not only returns one
layer up the tree when the node has no more children to visit, but
also when a previously specified maximum depth has been reached.
Also, if we return to the start node, we increase the maximum
depth and start the search all over, until weve visited all leaf nodes
(bottom nodes) and increasing the maximum depth wont lead to us
visiting more nodes.
</p><!--l. 848--><p class="noindent" >Specifically, these are the steps:
</p><!--l. 850--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-55002x1">
     <!--l. 851--><p class="noindent" >For each child of the current node
     </p></li>
<li 
  class="enumerate" id="x1-55004x2">
                                                    
                                                    
     <!--l. 852--><p class="noindent" >If it is the target node, return
     </p></li>
<li 
  class="enumerate" id="x1-55006x3">
     <!--l. 853--><p class="noindent" >If the current maximum depth is reached, return
     </p></li>
<li 
  class="enumerate" id="x1-55008x4">
     <!--l. 854--><p class="noindent" >Set the current node to this node and go back to 1.
     </p></li>
<li 
  class="enumerate" id="x1-55010x5">
     <!--l. 855--><p class="noindent" >After having gone through all children, go to the next
     child of the parent (the next sibling)
     </p></li>
<li 
  class="enumerate" id="x1-55012x6">
     <!--l. 856--><p class="noindent" >After having gone through all children of the start node,
     increase the maximum depth and go back to 1.
     </p></li>
<li 
  class="enumerate" id="x1-55014x7">
     <!--l. 857--><p class="noindent" >If we have reached all leaf (bottom) nodes, the goal node
     doesnt exist.</p></li></ol>
<!--l. 860--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-560001.6.4"></a>Example of the Algorithm</h5>
<!--l. 862--><p class="noindent" >Consider the following tree (see <a 
href="#x1-5600118">1.18<!--tex4ht:ref: iddfs --></a>):
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-5600118"></a>
                                                    
                                                    
<!--l. 866--><p class="noindent" ><img 
src="IDDFS.png" alt="PIC"  
width="184" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.18:</span><span  
class="content">IDDFS</span></figcaption><!--tex4ht:label?: x1-5600118 -->
                                                    
                                                    
</figure>
<!--l. 871--><p class="noindent" >The steps the algorithm performs on this tree if given node 0 as a
starting point, in order, are:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-56003x1">
     <!--l. 874--><p class="noindent" >Visiting Node 0
     </p></li>
<li 
  class="enumerate" id="x1-56005x2">
     <!--l. 875--><p class="noindent" >Visiting Node 1
     </p></li>
<li 
  class="enumerate" id="x1-56007x3">
     <!--l. 876--><p class="noindent" >Current maximum depth reached, returning
     </p></li>
<li 
  class="enumerate" id="x1-56009x4">
     <!--l. 877--><p class="noindent" >Visiting Node 2
     </p></li>
<li 
  class="enumerate" id="x1-56011x5">
     <!--l. 878--><p class="noindent" >Current maximum depth reached, returning
     </p></li>
<li 
  class="enumerate" id="x1-56013x6">
     <!--l. 879--><p class="noindent" >Increasing depth to 2
     </p></li>
<li 
  class="enumerate" id="x1-56015x7">
     <!--l. 880--><p class="noindent" >Visiting Node 0
     </p></li>
<li 
  class="enumerate" id="x1-56017x8">
                                                    
                                                    
     <!--l. 881--><p class="noindent" >Visiting Node 1
     </p></li>
<li 
  class="enumerate" id="x1-56019x9">
     <!--l. 882--><p class="noindent" >Visiting Node 3
     </p></li>
<li 
  class="enumerate" id="x1-56021x10">
     <!--l. 883--><p class="noindent" >Current maximum depth reached, returning
     </p></li>
<li 
  class="enumerate" id="x1-56023x11">
     <!--l. 884--><p class="noindent" >Visiting Node 4
     </p></li>
<li 
  class="enumerate" id="x1-56025x12">
     <!--l. 885--><p class="noindent" >Current maximum depth reached, returning
     </p></li>
<li 
  class="enumerate" id="x1-56027x13">
     <!--l. 886--><p class="noindent" >Visiting Node 2
     </p></li>
<li 
  class="enumerate" id="x1-56029x14">
     <!--l. 887--><p class="noindent" >Visiting Node 5
     </p></li>
<li 
  class="enumerate" id="x1-56031x15">
     <!--l. 888--><p class="noindent" >Current maximum depth reached, returning
     </p></li>
<li 
  class="enumerate" id="x1-56033x16">
     <!--l. 889--><p class="noindent" >Visiting Node 6
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-56035x17">
     <!--l. 890--><p class="noindent" >Found the node were looking for, returning</p></li></ol>
<h5 class="subsubsectionHead"><a 
 id="x1-570001.6.4"></a>Runtime of the Algorithm</h5>
<!--l. 895--><p class="noindent" >If we double the maximum depth each time we need to go deeper,
the runtime complexity of Iterative Deepening Depth-First Search
(ID-DFS) is the same as regular Depth-First Search (DFS), since all
previous depths added up will have the same runtime as the current
depth <!--l. 895--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">∕</mo><mn>2</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mn>4</mn> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-bin">∕</mo><mn>8</mn><mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo></math>.
The runtime of regular Depth-First Search (DFS) is
<!--l. 895--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>N</mi><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mi 
>N</mi><mo 
class="MathClass-rel">|</mo></math>
= number of Nodes in the tree), since every node is
traversed at most once. The number of nodes is equal to
<!--l. 895--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math>, where b
is the branching factor and d is the depth, so the runtime can be rewritten
as <!--l. 895--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>.
</p><!--l. 897--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-580001.6.4"></a>Space of the Algorithm</h5>
<!--l. 899--><p class="noindent" >The space complexity of Iterative Deepening Depth-First Search
(ID-DFS) is the same as regular Depth-First Search (DFS),
which is, if we exclude the tree itself, O(d), with d being the
depth, which is also the size of the call stack at maximum
depth. If we include the tree, the space complexity is the
same as the runtime complexity, as each node needs to be
saved.
</p>
<!--l. 901--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">traversal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">collections</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">represents</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">directed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">representation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span id="textcolor1566"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">vertices</span><span 
class="cmtt-8">)</span><span id="textcolor1576"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">No</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">V</span><span 
class="cmtt-8"> </span><span id="textcolor1590"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">default</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dictionary</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor1609"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">defaultdict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">u</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor1641"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor1646"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">u</span><span id="textcolor1649"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">A</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">perform</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Depth</span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80">Limited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">source</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">src</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">DLS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">src</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8">)</span><span id="textcolor1696"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">src</span><span 
class="cmtt-8"> </span><span id="textcolor1702"><span 
class="cmtt-8">=</span></span><span id="textcolor1704"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8"> </span><span id="textcolor1709"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">If</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reached</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">maximum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">depth</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">stop</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursing</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8"> </span><span id="textcolor1736"><span 
class="cmtt-8">&#x003C;</span></span><span id="textcolor1738"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span id="textcolor1743"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Recur</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">this</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58031r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">graph</span><span id="textcolor1777"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">src</span><span id="textcolor1780"><span 
class="cmtt-8">]</span></span><span id="textcolor1782"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58032r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DLS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">maxDepth</span><span id="textcolor1795"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span id="textcolor1800"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58033r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58034r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58035r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58036r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">IDDFS</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">target</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reachable</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">v</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58037r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">It</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">uses</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursive</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">DLS</span><span 
class="cmsltt-10x-x-80">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58038r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">IDDFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">src</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8">)</span><span id="textcolor1852"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58039r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58040r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Repeatedly</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">depth</span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80">limit</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">till</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58041r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">maximum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">depth</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58042r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8">)</span><span id="textcolor1882"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58043r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DLS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">src</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span id="textcolor1900"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58044r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58045r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58046r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58047r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">above</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">diagram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58048r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8"> </span><span id="textcolor1927"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">;</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58049r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58050r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58051r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58052r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58053r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58054r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">addEdge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58055r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58056r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8">target</span><span 
class="cmtt-8"> </span><span id="textcolor1992"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8"> </span><span id="textcolor2000"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">src</span><span 
class="cmtt-8"> </span><span id="textcolor2008"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58057r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58058r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">IDDFS</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">src</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxDepth</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor2027"><span 
class="cmtt-8">=</span></span><span id="textcolor2029"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span id="textcolor2033"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58059r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Target</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reachable</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">source</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span id="textcolor2051"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58060r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">within</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">max</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">depth</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58061r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-8">else</span><span 
class="cmtt-8"> </span><span id="textcolor2063"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58062r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Target</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">NOT</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reachable</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">source</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span id="textcolor2083"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58063r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">within</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">max</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">depth</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-58067r67"></a><span 
class="cmr-5">67</span></span></pre>
                                                    
                                                    
<!--l. 969--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.7   </span> <a 
 id="x1-590001.7"></a>Informed/Heuristic breadth-first search</h3>
<!--l. 971--><p class="noindent" >Also known as Best-first search. Best-first search is a class of
search algorithms, which explore a graph by expanding the
most promising node chosen according to a specified rule.
Judea Pearl described the best-first search as estimating
the promise of node n by a “heuristic evaluation function
<!--l. 971--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></math>
which, in general, may depend on the description of n, the
description of the goal, the information gathered by the search up
to that point, and most importantly, on any extra knowledge about
the problem domain.”
</p><!--l. 973--><p class="noindent" >Some authors have used “best-first search” to refer specifically to a
search with a heuristic that attempts to predict how close the end
of a path is to a solution (or, goal), so that paths which are judged
to be closer to a solution (or, goal) are extended first. This
specific type of search is called greedy best-first search or
pure heuristic search. Efficient selection of the current best
candidate for extension is typically implemented using a priority
queue.
</p><!--l. 975--><p class="noindent" >The A* search algorithm is an example of a best-first search
algorithm, as is B*. Best-first algorithms are often used for path
finding in combinatorial search. Neither A* nor B* is a greedy
best-first search, as they incorporate the distance from the start in
addition to estimated distances to the goal. Using a greedy
algorithm, expand the first successor of the parent. After a
successor is generated:
</p><!--l. 977--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-59002x1">
     <!--l. 978--><p class="noindent" >If the successor’s heuristic is better than its parent, the
     successor is set at the front of the queue (with the parent
     reinserted directly behind it), and the loop restarts.
     </p></li>
<li 
  class="enumerate" id="x1-59004x2">
                                                    
                                                    
     <!--l. 979--><p class="noindent" >Else, the successor is inserted into the queue (in a location
     determined  by  its  heuristic  value).  The  procedure  will
     evaluate the remaining successors (if any) of the parent.</p></li></ol>
<!--l. 982--><p class="noindent" >In BFS and DFS, when we are at a node, we can consider any of
the adjacent as next node. So both BFS and DFS blindly
explore paths without considering any cost function. The idea of
Best First Search is to use an evaluation function to decide
which adjacent is most promising and then explore. Best First
Search falls under the category of Heuristic Search or Informed
Search. We use a priority queue to store costs of nodes. So
the implementation is a variation of BFS, we just need to
change Queue to PriorityQueue. Let us consider the below
example.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-5900519"></a>
                                                    
                                                    
<!--l. 986--><p class="noindent" ><img 
src="BFS2.png" alt="PIC"  
width="227" height="142"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.19:</span><span  
class="content">Informed/Heuristic breadth-first search</span></figcaption><!--tex4ht:label?: x1-5900519 -->
                                                    
                                                    
</figure>
<h4 class="subsectionHead"><span class="titlemark">1.7.1   </span> <a 
 id="x1-600001.7.1"></a>Procedure</h4>
     <dl class="description"><dt class="description">
     <!--l. 994--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 994--><p class="noindent" >We start from source “S” and search for goal “I” using
     given costs and Best First search.
     </p></dd><dt class="description">
     <!--l. 995--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 995--><p class="noindent" >“pq” initially contains “S”. We remove “s” from and process
     unvisited neighbors of “S” to “pq”. “pq” now contains
     <!--l. 995--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mo 
class="MathClass-punc">,</mo><mi 
>C</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi></math>
     (C is put before B because C has lesser cost).
     </p></dd><dt class="description">
     <!--l. 997--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 997--><p class="noindent" >We remove “A” from “pq” and process unvisited neighbors
     of “A” to “pq”. “pq” now contains <!--l. 997--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mo 
class="MathClass-punc">,</mo><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi></math>.
     </p></dd><dt class="description">
     <!--l. 999--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 999--><p class="noindent" >We remove “C” from “pq” and process unvisited neighbors
     of “C” to “pq”. “pq” now contains <!--l. 999--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi></math>.
     </p></dd><dt class="description">
     <!--l. 1001--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1001--><p class="noindent" >We remove “B” from “pq” and process unvisited neighbors
     of “B” to “pq”. “pq” now contains <!--l. 1001--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mo 
class="MathClass-punc">,</mo><mi 
>E</mi><mo 
class="MathClass-punc">,</mo><mi 
>D</mi><mo 
class="MathClass-punc">,</mo><mi 
>F</mi><mo 
class="MathClass-punc">,</mo><mi 
>G</mi></math>.
                                                    
                                                    
     </p></dd><dt class="description">
     <!--l. 1003--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1003--><p class="noindent" >We remove “H” from “pq”. Since our goal “I” is a neighbor
     of “H”, we return.</p></dd></dl>
<!--l. 1006--><p class="noindent" >Below is the implementation of the above idea:
</p>
<!--l. 1008--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">queue</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">PriorityQueue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">v</span><span 
class="cmtt-8"> </span><span id="textcolor2102"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">14</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor2108"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor2111"><span 
class="cmtt-8">[</span></span><span id="textcolor2113"><span 
class="cmtt-8">[</span></span><span id="textcolor2115"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor2128"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">For</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Implementing</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Best</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">First</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Search</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Gives</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">output</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">having</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lowest</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">best_first_search</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">source</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor2168"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor2172"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor2175"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">False</span><span id="textcolor2178"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor2181"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor2187"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8"> </span><span id="textcolor2193"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">PriorityQueue</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">put</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">source</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">while</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><span id="textcolor2215"><span 
class="cmtt-8">=</span></span><span id="textcolor2217"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span id="textcolor2221"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">u</span><span 
class="cmtt-8"> </span><span id="textcolor2225"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">get</span><span 
class="cmtt-8">()</span><span id="textcolor2232"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor2235"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Displaying</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">having</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lowest</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">u</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span id="textcolor2256"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">u</span><span 
class="cmtt-8"> </span><span id="textcolor2266"><span 
class="cmtt-8">=</span></span><span id="textcolor2268"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span id="textcolor2272"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">break</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">c</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span id="textcolor2285"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">u</span><span id="textcolor2288"><span 
class="cmtt-8">]</span></span><span id="textcolor2290"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor2295"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor2298"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor2301"><span 
class="cmtt-8">=</span></span><span id="textcolor2303"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span id="textcolor2307"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span id="textcolor2310"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor2313"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor2316"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">put</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">c</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adding</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edges</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">)</span><span id="textcolor2357"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60031r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span id="textcolor2360"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">x</span><span id="textcolor2363"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60032r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span id="textcolor2375"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">y</span><span id="textcolor2378"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60033r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60034r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60035r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">The</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">shown</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">above</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">example</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">alphabets</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">are</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60036r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">implemented</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">integers</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">addedge</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">x</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80">y</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">;</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60037r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60038r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60039r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60040r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60041r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60042r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">12</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60043r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">14</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60044r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60045r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60046r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60047r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">11</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60048r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">12</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60049r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8">addedge</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">13</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60050r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60051r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8">source</span><span 
class="cmtt-8"> </span><span id="textcolor2558"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60052r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8">target</span><span 
class="cmtt-8"> </span><span id="textcolor2564"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">9</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60053r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8">best_first_search</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">source</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">target</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-60054r54"></a><span 
class="cmr-5">54</span></span></pre>
<!--l. 1064--><p class="noindent" >Output
                                                    
                                                    
</p>
<pre class="verbatim" id="verbatim-1">
0 1 3 2 8 9</pre>
<!--l. 1068--><p class="nopar" >
</p><!--l. 1072--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">1.8   </span> <a 
 id="x1-610001.8"></a>A* Search</h3>
<!--l. 1074--><p class="noindent" >A* (“A-star”) is a graph traversal and path search algorithm, which is
often used in many fields of computer science due to its completeness,
optimality, and optimal efficiency. <sup class="textsuperscript"><a 
href="#ennote-13" id="enmark-13"><span 
class="cmr-9">13</span></a></sup> One major practical drawback is
its <!--l. 1074--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
space complexity, as it stores all generated nodes in memory. Thus,
in practical travel-routing systems, it is generally outperformed by
algorithms which can pre-process the graph to attain better
performance, as well as memory-bounded approaches; however, A*
is still the best solution in many cases. Peter Hart, Nils Nilsson
and Bertram Raphael of Stanford Research Institute (now
SRI International) first published the algorithm in 1968. <sup class="textsuperscript"><a 
href="#ennote-14" id="enmark-14"><span 
class="cmr-9">14</span></a></sup>
It can be seen as an extension of Dijkstra’s algorithm. A*
achieves better performance by using heuristics to guide its
search.
</p><!--l. 1076--><p class="noindent" >A* was created as part of the Shakey project, which had the aim of
building a mobile robot that could plan its own actions. Nils
Nilsson originally proposed using the Graph Traverser algorithm for
Shakey’s path planning. Graph Traverser is guided by a heuristic
function h(n), the estimated distance from node n to the goal node:
it entirely ignores g(n), the distance from the start node to n.
Bertram Raphael suggested using the sum, g(n) + h(n). Peter Hart
invented the concepts we now call admissibility and consistency of
heuristic functions. A* was originally designed for finding
least-cost paths when the cost of a path is the sum of its
costs, but it has been shown that A* can be used to find
optimal paths for any problem satisfying the conditions of a cost
                                                    
                                                    
algebra.
</p><!--l. 1078--><p class="noindent" >The original 1968 A* paper contained a theorem stating that no
A*-like algorithm could expand fewer nodes than A* if the heuristic
function is consistent and A*’s tie-breaking rule is suitably chosen.
<sup class="textsuperscript"><a 
href="#ennote-15" id="enmark-15"><span 
class="cmr-9">15</span></a></sup> A “correction” was published a few years later[8] claiming that
consistency was not required, but this was shown to be false
in Dechter and Pearl’s definitive study of A*’s optimality
(now called optimal efficiency), which gave an example of
A* with a heuristic that was admissible but not consistent
expanding arbitrarily more nodes than an alternative A*-like
algorithm.
</p><!--l. 1080--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.8.1   </span> <a 
 id="x1-620001.8.1"></a>Description</h4>
<!--l. 1082--><p class="noindent" >A* is an informed search algorithm, or a best-first search, meaning
that it is formulated in terms of weighted graphs: starting from a
specific starting node of a graph, it aims to find a path to
the given goal node having the smallest cost (least distance
travelled, shortest time, etc.). It does this by maintaining a tree
of paths originating at the start node and extending those
paths one edge at a time until its termination criterion is
satisfied.
</p><!--l. 1084--><p class="noindent" >At each iteration of its main loop, A* needs to determine which of
its paths to extend. It does so based on the cost of the path
and an estimate of the cost required to extend the path all
the way to the goal. Specifically, A* selects the path that
minimizes
</p><!--l. 1086--><p class="noindent" ><!--l. 1086--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>g</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></math>
</p><!--l. 1088--><p class="noindent" >where n is the next node on the path,
<!--l. 1088--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></math>
is the cost of the path from the start node to
<!--l. 1088--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>, and
<!--l. 1088--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></math> is a
heuristic function that estimates the cost of the cheapest path from
n to the goal. A* terminates when the path it chooses to extend is a
path from start to goal or if there are no paths eligible to be
                                                    
                                                    
extended. The heuristic function is problem-specific. If the heuristic
function is admissible, meaning that it never overestimates the
actual cost to get to the goal, A* is guaranteed to return a
least-cost path from start to goal.
</p><!--l. 1090--><p class="noindent" >Typical implementations of A* use a priority queue to perform
the repeated selection of minimum (estimated) cost nodes
to expand. This priority queue is known as the open set or
fringe. At each step of the algorithm, the node with the lowest
<!--l. 1090--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
value is removed from the queue, the f and g values of its neighbors
are updated accordingly, and these neighbors are added to the
queue. The algorithm continues until a removed node (thus the
node with the lowest f value out of all fringe nodes) is a goal
node. The f value of that goal is then also the cost of the
shortest path, since h at the goal is zero in an admissible
heuristic.
</p><!--l. 1092--><p class="noindent" >The algorithm described so far gives us only the length of the
shortest path. To find the actual sequence of steps, the algorithm
can be easily revised so that each node on the path keeps track of
its predecessor. After this algorithm is run, the ending node will
point to its predecessor, and so on, until some node’s predecessor is
the start node.
</p><!--l. 1094--><p class="noindent" >As an example, when searching for the shortest route on a map,
<!--l. 1094--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
might represent the straight-line distance to the goal, since that is
physically the smallest possible distance between any two points.
For a grid map from a video game, using the Manhattan distance or
the octile distance becomes better depending on the set of
movements available (4-way or 8-way).
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-6200120"></a>
                                                    
                                                    
<!--l. 1098--><p class="noindent" ><img 
src="SRI_Shakey_with_callouts.jpg" alt="PIC"  
width="142" height="199"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.20:</span><span  
class="content">SRI’s Shakey Robo</span></figcaption><!--tex4ht:label?: x1-6200120 -->
                                                    
                                                    
</figure>
<!--l. 1103--><p class="noindent" >If the heuristic <!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi></math> satisfies
the additional condition <!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≤</mo> <mi 
>d</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>
for every edge <!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math> of
the graph (where <!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi></math>
denotes the length of that edge), then
<!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi></math> is called
monotone, or consistent. With a consistent heuristic, A* is guaranteed
to find an optimal path without processing any node more than once
and A* is equivalent to running Dijkstra’s algorithm with the reduced
cost <!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>d</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>d</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
</p>
<h4 class="subsectionHead"><span class="titlemark">1.8.2   </span> <a 
 id="x1-630001.8.2"></a>Complexity</h4>
<!--l. 1107--><p class="noindent" >The time complexity of A* depends on the heuristic. In the worst
case of an unbounded search space, the number of nodes expanded
is exponential in the depth of the solution (the shortest path)
<!--l. 1107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>d</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>b</mi><mi 
>d</mi><mo 
class="MathClass-close">)</mo></math>, where
<!--l. 1107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> is
the branching factor (the average number of successors per state).
This assumes that a goal state exists at all, and is reachable from
the start state; if it is not, and the state space is infinite, the
algorithm will not terminate.
</p><!--l. 1109--><p class="noindent" >The heuristic function has a major effect on the practical
performance of A* search, since a good heuristic allows A* to prune
away many of the bd nodes that an uninformed search would
expand. Its quality can be expressed in terms of the effective
branching factor b*, which can be determined empirically
for a problem instance by measuring the number of nodes
generated by expansion, N, and the depth of the solution, then
solving
</p><!--l. 1111--><p class="noindent" ><!--l. 1111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn> <mo 
class="MathClass-rel">=</mo> <mn>1</mn> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math>
</p><!--l. 1113--><p class="noindent" >Good heuristics are those with low effective branching factor (the optimal
being <!--l. 1113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-bin">∗</mo> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>).
The time complexity is polynomial when the search space is a tree,
there is a single goal state, and the heuristic function h meets the
following condition:
                                                    
                                                    
</p><!--l. 1115--><p class="noindent" ><!--l. 1115--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <msup><mrow 
><mi 
>h</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
class="MathClass-op">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><msup><mrow 
><mi 
>h</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>
</p><!--l. 1117--><p class="noindent" >where <!--l. 1117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-bin">∗</mo></math>
is the optimal heuristic, the exact cost to get from
<!--l. 1117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>
to the goal. In other words, the error of
<!--l. 1117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi></math> will
not grow faster than the logarithm of the “perfect heuristic”
<!--l. 1117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-bin">∗</mo></math> that
returns the true distance from x to the goal. The space complexity
of A* is roughly the same as that of all other graph search
algorithms, as it keeps all generated nodes in memory. In practice,
this turns out to be the biggest drawback of A* search, leading
to the development of memory-bounded heuristic searches,
such as Iterative deepening A*, memory bounded A*, and
SMA*.
</p><!--l. 1119--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.8.3   </span> <a 
 id="x1-640001.8.3"></a>Python practice</h4>
<!--l. 1121--><p class="noindent" >This is a direct implementation of A* on a graph structure. The
heuristic function is defined as 1 for all nodes for the sake
of simplicity and brevity. The graph is represented with an
adjacency list, where the keys represent graph nodes, and
the values contain a list of edges with the the corresponding
neighboring nodes. Here you’ll find the A* algorithm implemented
in Python:
</p>
<!--l. 1123--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">collections</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">deque</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span id="textcolor2588"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">example</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">or</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">rather</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">map</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency_list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">=</span><span 
class="cmsltt-10x-x-80"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">A</span><span 
class="cmsltt-10x-x-80">’:</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">[(’</span><span 
class="cmsltt-10x-x-80">B</span><span 
class="cmsltt-10x-x-80">’,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(’</span><span 
class="cmsltt-10x-x-80">C</span><span 
class="cmsltt-10x-x-80">’,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">3</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(’</span><span 
class="cmsltt-10x-x-80">D</span><span 
class="cmsltt-10x-x-80">’,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">7</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">],</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">B</span><span 
class="cmsltt-10x-x-80">’:</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">[(’</span><span 
class="cmsltt-10x-x-80">D</span><span 
class="cmsltt-10x-x-80">’,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">5</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">],</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">C</span><span 
class="cmsltt-10x-x-80">’:</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">[(’</span><span 
class="cmsltt-10x-x-80">D</span><span 
class="cmsltt-10x-x-80">’,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">12</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">]</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adjacency_list</span><span 
class="cmtt-8">)</span><span id="textcolor2681"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">adjacency_list</span><span 
class="cmtt-8"> </span><span id="textcolor2687"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adjacency_list</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">get_neighbors</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span id="textcolor2700"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">adjacency_list</span><span id="textcolor2707"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor2710"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">heuristic</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">equal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">values</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">h</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor2738"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">H</span><span 
class="cmtt-8"> </span><span id="textcolor2742"><span 
class="cmtt-8">=</span></span><span class="lstinline"></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">{</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">A</span><span 
class="cmtt-8">’</span><span id="textcolor2749"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">B</span><span 
class="cmtt-8">’</span><span id="textcolor2757"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">C</span><span 
class="cmtt-8">’</span><span id="textcolor2765"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">D</span><span 
class="cmtt-8">’</span><span id="textcolor2773"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span class="lstinline"></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">H</span><span id="textcolor2781"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor2784"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">a_star_algorithm</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">start_node</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">stop_node</span><span 
class="cmtt-8">)</span><span id="textcolor2798"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">open_list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">which</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">been</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">but</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">who</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neighbors</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">haven</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">t</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">been</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">inspected</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">starts</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">off</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">start</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64031r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">closed_list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">which</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">been</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64032r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">who</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neighbors</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">been</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">inspected</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64033r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8"> </span><span id="textcolor2892"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">set</span><span 
class="cmtt-8">(</span><span id="textcolor2897"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">start_node</span><span id="textcolor2900"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64034r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">closed_list</span><span 
class="cmtt-8"> </span><span id="textcolor2905"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">set</span><span 
class="cmtt-8">(</span><span id="textcolor2910"><span 
class="cmtt-8">[</span></span><span id="textcolor2912"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64035r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64036r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">g</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">contains</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">distances</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">start_node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">other</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64037r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">default</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">value</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">found</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">map</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">+</span><span 
class="cmsltt-10x-x-80">infinity</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64038r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span 
class="cmtt-8"> </span><span id="textcolor2968"><span 
class="cmtt-8">=</span></span><span class="lstinline"></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">{</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64039r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64040r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor2974"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">start_node</span><span id="textcolor2977"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor2980"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64041r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64042r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">parents</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">contains</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">map</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64043r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span 
class="cmtt-8"> </span><span id="textcolor3003"><span 
class="cmtt-8">=</span></span><span class="lstinline"></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">{</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64044r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span id="textcolor3009"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">start_node</span><span id="textcolor3012"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3015"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">start_node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64045r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64046r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">while</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">len</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor3026"><span 
class="cmtt-8">&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor3030"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64047r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3034"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64048r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64049r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">find</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lowest</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">value</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">f</span><span 
class="cmsltt-10x-x-80">()</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">evaluation</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64050r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span id="textcolor3071"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64051r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3077"><span 
class="cmtt-8">=</span></span><span id="textcolor3079"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">or</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3087"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">v</span><span id="textcolor3090"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3093"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">h</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor3103"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3107"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3110"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3113"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">h</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor3122"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64052r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3126"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">v</span><span 
class="cmtt-8">;</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64053r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64054r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3135"><span 
class="cmtt-8">=</span></span><span id="textcolor3137"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span id="textcolor3141"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64055r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">Path</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">does</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">exist</span><span 
class="cmtt-8">!</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64056r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64057r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64058r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">stop_node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64059r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">then</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">begin</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reconstructin</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">start_node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64060r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3201"><span 
class="cmtt-8">=</span></span><span id="textcolor3203"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">stop_node</span><span id="textcolor3207"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64061r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8"> </span><span id="textcolor3211"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor3214"><span 
class="cmtt-8">[</span></span><span id="textcolor3216"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64062r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64063r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">while</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span id="textcolor3221"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3224"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3227"><span 
class="cmtt-8">!</span></span><span id="textcolor3229"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span id="textcolor3233"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64064r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64065r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor3243"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span id="textcolor3247"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3250"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64066r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64067r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">start_node</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64068r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64069r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">reverse</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64070r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64071r71"></a><span 
class="cmr-5">71</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">Path</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">found</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">format</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64072r72"></a><span 
class="cmr-5">72</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reconst_path</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64073r73"></a><span 
class="cmr-5">73</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64074r74"></a><span 
class="cmr-5">74</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neighbors</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">do</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64075r75"></a><span 
class="cmr-5">75</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">m</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weight</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">get_neighbors</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor3316"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64076r76"></a><span 
class="cmr-5">76</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">isn</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">t</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">both</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">open_list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">closed_list</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64077r77"></a><span 
class="cmr-5">77</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">open_list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">note</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">parent</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64078r78"></a><span 
class="cmr-5">78</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">m</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">m</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">closed_list</span><span id="textcolor3383"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64079r79"></a><span 
class="cmr-5">79</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">add</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">m</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64080r80"></a><span 
class="cmr-5">80</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span id="textcolor3392"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">m</span><span id="textcolor3395"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3398"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64081r81"></a><span 
class="cmr-5">81</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3403"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">m</span><span id="textcolor3406"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3409"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3413"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3416"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3419"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weight</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64082r82"></a><span 
class="cmr-5">82</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64083r83"></a><span 
class="cmr-5">83</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">otherwise</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">check</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">s</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">quicker</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">first</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visit</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">then</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">m</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64084r84"></a><span 
class="cmr-5">84</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">update</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">parent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">g</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64085r85"></a><span 
class="cmr-5">85</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">was</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">closed_list</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">move</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">open_list</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64086r86"></a><span 
class="cmr-5">86</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">else</span><span id="textcolor3499"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64087r87"></a><span 
class="cmr-5">87</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3504"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">m</span><span id="textcolor3507"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3510"><span 
class="cmtt-8">&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3514"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3517"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3520"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weight</span><span id="textcolor3524"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64088r88"></a><span 
class="cmr-5">88</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3527"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">m</span><span id="textcolor3530"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3533"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">g</span><span id="textcolor3537"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n</span><span id="textcolor3540"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3543"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weight</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64089r89"></a><span 
class="cmr-5">89</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parents</span><span id="textcolor3548"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">m</span><span id="textcolor3551"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor3554"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64090r90"></a><span 
class="cmr-5">90</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64091r91"></a><span 
class="cmr-5">91</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">m</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">closed_list</span><span id="textcolor3565"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64092r92"></a><span 
class="cmr-5">92</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">closed_list</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">remove</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">m</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64093r93"></a><span 
class="cmr-5">93</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">add</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">m</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64094r94"></a><span 
class="cmr-5">94</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64095r95"></a><span 
class="cmr-5">95</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">remove</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">open_list</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">closed_list</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64096r96"></a><span 
class="cmr-5">96</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">because</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">his</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neighbors</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">were</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">inspected</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64097r97"></a><span 
class="cmr-5">97</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">open_list</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">remove</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64098r98"></a><span 
class="cmr-5">98</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">closed_list</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">add</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64099r99"></a><span 
class="cmr-5">99</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64100r100"></a><span 
class="cmr-5">100</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">Path</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">does</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">exist</span><span 
class="cmtt-8">!</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64101r101"></a><span 
class="cmr-5">101</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64102r102"></a><span 
class="cmr-5">102</span></span></pre>
<!--l. 1227--><p class="noindent" >Let’s look at an example with the following weighted graph:
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-6410321"></a>
                                                    
                                                    
<!--l. 1231--><p class="noindent" ><img 
src="a-star-graph.png" alt="PIC"  
width="199" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.21:</span><span  
class="content">A* graph</span></figcaption><!--tex4ht:label?: x1-6410321 -->
                                                    
                                                    
</figure>
<!--l. 1236--><p class="noindent" >We run the code as so:
</p>
<!--l. 1238--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64104r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">adjacency_list</span><span 
class="cmtt-8"> </span><span id="textcolor3646"><span 
class="cmtt-8">=</span></span><span class="lstinline"></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">{</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64105r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">A</span><span 
class="cmtt-8">’</span><span id="textcolor3653"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span id="textcolor3656"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">B</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">C</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">D</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">)</span><span id="textcolor3686"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64106r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">B</span><span 
class="cmtt-8">’</span><span id="textcolor3692"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span id="textcolor3695"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">D</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span id="textcolor3705"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64107r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">C</span><span 
class="cmtt-8">’</span><span id="textcolor3711"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span id="textcolor3714"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">D</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">12</span><span 
class="cmtt-8">)</span><span id="textcolor3724"><span 
class="cmtt-8">]</span></span><span class="lstinline"></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64108r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64109r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">graph1</span><span 
class="cmtt-8"> </span><span id="textcolor3729"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Graph</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adjacency_list</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64110r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">graph1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">a_star_algorithm</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">A</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">D</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-64111r8"></a><span 
class="cmr-5">8</span></span></pre>
<!--l. 1248--><p class="noindent" >And the output would look like:
                                                    
                                                    
</p>
<pre class="verbatim" id="verbatim-2">
Path found: [’A’, ’B’, ’D’]
[’A’, ’B’, ’D’]
</pre>
<!--l. 1254--><p class="nopar" >
</p><!--l. 1256--><p class="noindent" >Thus, the optimal path from A to D, found using A*, is
<!--l. 1256--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>B</mi><mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>D</mi></math>.
</p>
<h3 class="sectionHead"><span class="titlemark">1.9   </span> <a 
 id="x1-650001.9"></a>Branch and bound</h3>
<!--l. 1260--><p class="noindent" >Branch and bound (BB, B&#x0026;B, or BnB) is an algorithm design
paradigm for discrete and combinatorial optimization problems, as
well as mathematical optimization. A branch-and-bound algorithm
consists of a systematic enumeration of candidate solutions by
means of state space search: the set of candidate solutions is
thought of as forming a rooted tree with the full set at the root.
The algorithm explores branches of this tree, which represent
subsets of the solution set. Before enumerating the candidate
solutions of a branch, the branch is checked against upper and lower
estimated bounds on the optimal solution, and is discarded if it
cannot produce a better solution than the best one found so far by
the algorithm. The algorithm depends on efficient estimation of the
lower and upper bounds of regions/branches of the search space. If
no bounds are available, the algorithm degenerates to an exhaustive
search.
</p><!--l. 1262--><p class="noindent" >The method was first proposed by Ailsa Land and Alison Doig
whilst carrying out research at the London School of Economics
sponsored by British Petroleum in 1960 for discrete programming,
and has become the most commonly used tool for solving NP-hard
optimization problems. The name “branch and bound” first
occurred in the work of Little et al. on the traveling salesman
problem.
                                                    
                                                    
</p><!--l. 1264--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.9.1   </span> <a 
 id="x1-660001.9.1"></a>Overview</h4>
<!--l. 1266--><p class="noindent" >The goal of a branch-and-bound algorithm is to find a value x that
maximizes or minimizes the value of a real-valued function
<!--l. 1266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>, called an
objective function, among some set S of admissible, or candidate solutions.
The set <!--l. 1266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
is called the search space, or feasible region. The
rest of this section assumes that minimization of
<!--l. 1266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
is desired; this assumption comes without loss of
generality, since one can find the maximum value of
<!--l. 1266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math> by finding the
minimum of <!--l. 1266--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-punc">?</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
A B&#x0026;B algorithm operates according to two principles:
</p><!--l. 1268--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-66002x1">
     <!--l. 1269--><p class="noindent" >It recursively splits the search space into smaller spaces,
     then minimizing f(x) on these smaller spaces; the splitting
     is called branching.
     </p></li>
<li 
  class="enumerate" id="x1-66004x2">
     <!--l. 1270--><p class="noindent" >Branching    alone    would    amount    to    brute-force
     enumeration of candidate solutions and testing them all.
     To improve on the performance of brute-force search, a
     B&#x0026;B algorithm keeps track of bounds on the minimum
     that it is trying to find, and uses these bounds to ”prune”
     the search space, eliminating candidate solutions that it
     can prove will not contain an optimal solution.</p></li></ol>
<!--l. 1273--><p class="noindent" >Turning these principles into a concrete algorithm for a specific
optimization problem requires some kind of data structure that
represents sets of candidate solutions. Such a representation is
called an instance of the problem. Denote the set of candidate
solutions of an instance I by SI. The instance representation has to
                                                    
                                                    
come with three operations:
</p><!--l. 1275--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-66006x1">
     <!--l. 1276--><p class="noindent" ><span 
class="cmti-10">branch(I)  </span>produces  two  or  more  instances  that  each
     represent  a  subset  of  SI.  (Typically,  the  subsets  are
     disjoint  to  prevent  the  algorithm  from  visiting  the
     same candidate solution twice, but this is not required.
     However, an optimal solution among SI must be contained
     in at least one of the subsets.)
     </p></li>
<li 
  class="enumerate" id="x1-66008x2">
     <!--l. 1277--><p class="noindent" ><span 
class="cmti-10">bound(I) </span>computes a lower bound on the value of any
     candidate solution in the space represented by I, that is,
     <!--l. 1277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mi 
>o</mi><mi 
>u</mi><mi 
>n</mi><mi 
>d</mi><mo 
class="MathClass-open">(</mo><mi 
>I</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≤</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
     for all x in SI.
     </p></li>
<li 
  class="enumerate" id="x1-66010x3">
     <!--l. 1278--><p class="noindent" ><span 
class="cmti-10">solution(I)  </span>determines  whether  I  represents  a  single
     candidate  solution.  (Optionally,  if  it  does  not,  the
     operation  may  choose  to  return  some  feasible  solution
     from  among  SI.)  If  solution(I)  returns  a  solution  then
     f(solution(I)) provides an upper bound for the optimal
     objective value over the whole space of feasible solutions.
</p>
     </li></ol>
<!--l. 1281--><p class="noindent" >Using these operations, a B&#x0026;B algorithm performs a top-down
recursive search through the tree of instances formed by the branch
operation. Upon visiting an instance I, it checks whether bound(I)
is greater than an upper bound found so far; if so, I may be safely
discarded from the search and the recursion stops. This pruning
step is usually implemented by maintaining a global variable that
records the minimum upper bound seen among all instances
examined so far.
                                                    
                                                    
</p><!--l. 1283--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.9.2   </span> <a 
 id="x1-670001.9.2"></a>Generic version</h4>
<!--l. 1285--><p class="noindent" >The following is the skeleton of a generic branch and bound
algorithm for minimizing an arbitrary objective function <span 
class="cmti-10">f </span>. To
obtain an actual algorithm from this, one requires a bounding
function bound, that computes lower bounds of f on nodes of the
search tree, as well as a problem-specific branching rule. As
such, the generic algorithm presented here is a higher-order
function.
</p><!--l. 1287--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-67002x1">
     <!--l. 1288--><p class="noindent" >Using a heuristic, find a solution xh to the optimization
     problem. Store its value, <!--l. 1288--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mi 
>h</mi><mo 
class="MathClass-close">)</mo></math>.
     (If no heuristic is available, set <span 
class="cmti-10">B </span>to infinity.) <span 
class="cmti-10">B </span>will denote
     the best solution found so far, and will be used as an upper
     bound on candidate solutions.
     </p></li>
<li 
  class="enumerate" id="x1-67004x2">
     <!--l. 1289--><p class="noindent" >Initialize a queue to hold a partial solution with none of
     the variables of the problem assigned.
     </p></li>
<li 
  class="enumerate" id="x1-67006x3">
     <!--l. 1290--><p class="noindent" >Loop until the queue is empty: </p>
         <ul class="itemize1">
         <li class="itemize">
         <!--l. 1292--><p class="noindent" >Take a node <span 
class="cmti-10">N </span>off the queue.
         </p></li>
         <li class="itemize">
                                                    
                                                    
         <!--l. 1293--><p class="noindent" >If <span 
class="cmti-10">N  </span>represents a single candidate solution <span 
class="cmti-10">x  </span>and
         <!--l. 1293--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>B</mi></math>,
         then x is the best solution so far. Record it and set
         <!--l. 1293--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>B</mi> <mo 
class="MathClass-rel">←</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>.
         </p></li>
         <li class="itemize">
         <!--l. 1294--><p class="noindent" >Else, branch on <span 
class="cmti-10">N </span>to produce new nodes <!--l. 1294--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>N</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>.
         For each of these:
         </p></li>
         <li class="itemize">
         <!--l. 1295--><p class="noindent" >If <!--l. 1295--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mi 
>o</mi><mi 
>u</mi><mi 
>n</mi><mi 
>d</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>N</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>B</mi></math>,
         do nothing; since the lower bound on this node is
         greater  than  the  upper  bound  of  the  problem,  it
         will never lead to the optimal solution, and can be
         discarded.
         </p></li>
         <li class="itemize">
         <!--l. 1296--><p class="noindent" >Else, store <!--l. 1296--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>N</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>
         on the queue.
</p>
         </li></ul>
     </li></ol>
<!--l. 1301--><p class="noindent" >Several different queue data structures can be used. This FIFO
queue-based implementation yields a breadth-first search. A stack
(LIFO queue) will yield a depth-first algorithm. A best-first branch
and bound algorithm can be obtained by using a priority queue
that sorts nodes on their lower bound. Examples of best-first search
algorithms with this premise are Dijkstra’s algorithm and its
descendant A* search. The depth-first variant is recommended
when no good heuristic is available for producing an initial solution,
because it quickly produces full solutions, and therefore upper
bounds.
</p><!--l. 1303--><p class="noindent" >
</p>
                                                    
                                                    
<h4 class="subsectionHead"><span class="titlemark">1.9.3   </span> <a 
 id="x1-680001.9.3"></a>Knapsack problem</h4>
<!--l. 1305--><p class="noindent" >Branch and bound is an algorithm design paradigm which is
generally used for solving combinatorial optimization problems.
These problems are typically exponential in terms of time
complexity and may require exploring all possible permutations in
worst case. The Branch and Bound Algorithm technique solves
these problems relatively quickly. Let us consider the 0/1
Knapsack problem to understand Branch and Bound. There
are many algorithms by which the knapsack problem can be
solved:
</p><!--l. 1307--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-68002x1">
     <!--l. 1308--><p class="noindent" >Greedy Algorithm for Fractional Knapsack
     </p></li>
<li 
  class="enumerate" id="x1-68004x2">
     <!--l. 1309--><p class="noindent" >DP solution for 0/1 Knapsack
     </p></li>
<li 
  class="enumerate" id="x1-68006x3">
     <!--l. 1310--><p class="noindent" >Backtracking Solution for 0/1 Knapsack.</p></li></ol>
<!--l. 1316--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-690001.9.3"></a>0/1 Knapsack using Branch and Bound</h5>
<!--l. 1318--><p class="noindent" >Let us consider below 0/1 Knapsack problem to
understand Branch and Bound. Given two integer arrays
<!--l. 1318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi><mi 
>a</mi><mi 
>l</mi><mo 
class="MathClass-open">[</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mi 
>n</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">]</mo></math> and
<!--l. 1318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>w</mi><mi 
>t</mi><mo 
class="MathClass-open">[</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mi 
>n</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-close">]</mo></math>
that represent values and weights associated with n items
respectively. Find out the maximum value subset of
<!--l. 1318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>v</mi><mi 
>a</mi><mi 
>l</mi><mo 
class="MathClass-open">[</mo><mo 
class="MathClass-close">]</mo></math> such that
sum of the weights of this subset is smaller than or equal to Knapsack
                                                    
                                                    
capacity <!--l. 1318--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>W</mi></math>.
</p><!--l. 1320--><p class="noindent" >Let us explore all approaches for this problem.
</p><!--l. 1322--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-69002x1">
     <!--l. 1323--><p class="noindent" >A Greedy approach is to pick the items in decreasing order
     of value per unit weight. The Greedy approach works only
     for  fractional  knapsack  problem  and  may  not  produce
     correct result for <!--l. 1323--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn><mo 
class="MathClass-bin">∕</mo><mn>1</mn></math>
     knapsack.
     </p></li>
<li 
  class="enumerate" id="x1-69004x2">
     <!--l. 1324--><p class="noindent" >We can use Dynamic Programming (DP) for <!--l. 1324--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn><mo 
class="MathClass-bin">∕</mo><mn>1</mn></math>
     Knapsack problem. In DP, we use a 2D table of size <!--l. 1324--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi> <mo 
class="MathClass-bin">×</mo> <mi 
>W</mi></math>.
     The  DP  Solution  doesnt  work  if  item  weights  are  not
     integers.
     </p></li>
<li 
  class="enumerate" id="x1-69006x3">
     <!--l. 1325--><p class="noindent" >Since DP solution does not always work, a solution is to
     use Brute Force. With n items, there are <!--l. 1325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn><mi 
>n</mi></math>
     solutions to be generated, check each to see if they satisfy
     the constraint, save maximum solution that satisfies constraint.
     This solution can be expressed as tree.
</p>
     <figure class="figure"> 
<a 
 id="x1-6900722"></a> <img 
src="knapsack1.jpg" alt="PIC"  
width="274" height="274"  />
<figcaption class="caption" ><span class="id">Figure 1.22:</span><span  
class="content">0/1 Knapsack</span></figcaption><!--tex4ht:label?: x1-6900722 -->
     </figure>
     </li>
<li 
  class="enumerate" id="x1-69009x4">
     <!--l. 1334--><p class="noindent" >We can use Backtracking to optimize the Brute Force
     solution. In the tree representation, we can do DFS of
     tree. If we reach a point where a solution no longer
                                                    
                                                    
     is feasible, there is no need to continue exploring. In
     the given example, backtracking would be much more
     effective if we had even more items or a smaller knapsack
     capacity.
</p>
     <figure class="figure"> 
<a 
 id="x1-6901023"></a> <img 
src="knapsack2.jpg" alt="PIC"  
width="274" height="274"  />
<figcaption class="caption" ><span class="id">Figure 1.23:</span><span  
class="content">0/1 Knapsack</span></figcaption><!--tex4ht:label?: x1-6901023 -->
     </figure>
     </li></ol>
<!--l. 1345--><p class="noindent" >The backtracking based solution works better than brute
force by ignoring infeasible solutions. We can do better (than
backtracking) if we know a bound on best possible solution
subtree rooted with every node. If the best in subtree is worse
than current best, we can simply ignore this node and its
subtrees. So we compute bound (best solution) for every node
and compare the bound with current best solution before
exploring the node. Example bounds used in below diagram are,
<!--l. 1345--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>A</mi></math> down
can give <span 
class="tcrm-1000">$</span>315, B down can <span 
class="tcrm-1000">$</span>275, C down can <span 
class="tcrm-1000">$</span>225, D down can <span 
class="tcrm-1000">$</span>125
and <!--l. 1345--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>
down can <span 
class="tcrm-1000">$</span>30. In the next article, we have discussed the process to
get these bounds.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-6901124"></a>
                                                    
                                                    
<!--l. 1348--><p class="noindent" ><img 
src="knapsack3.jpg" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.24:</span><span  
class="content">0/1 Knapsack</span></figcaption><!--tex4ht:label?: x1-6901124 -->
                                                    
                                                    
</figure>
<!--l. 1353--><p class="noindent" >Branch and bound is very useful technique for searching a solution
but in worst case, we need to fully calculate the entire tree. At best,
we only need to fully calculate one path through the tree and prune
the rest of it.
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-700001.9.3"></a>Implementation</h5>
<!--l. 1357--><p class="noindent" >How to find bound for every node for 0/1 Knapsack? The idea is to
use the fact that the Greedy approach provides the best solution for
Fractional Knapsack problem. To check if a particular node
can give us a better solution or not, we compute the optimal
solution (through the node) using Greedy approach. If the
solution computed by Greedy approach itself is more than the
best so far, then we cant get a better solution through the
node.
</p><!--l. 1359--><p class="noindent" >Complete Algorithm:
</p><!--l. 1361--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-70002x1">
     <!--l. 1362--><p class="noindent" >Sort all items in decreasing order of ratio of value per unit
     weight so that an upper bound can be computed using
     Greedy Approach.
     </p></li>
<li 
  class="enumerate" id="x1-70004x2">
     <!--l. 1363--><p class="noindent" >Initialize maximum profit, maxProfit = 0
     </p></li>
<li 
  class="enumerate" id="x1-70006x3">
     <!--l. 1364--><p class="noindent" >Create an empty queue, Q.
     </p></li>
<li 
  class="enumerate" id="x1-70008x4">
                                                    
                                                    
     <!--l. 1365--><p class="noindent" >Create a dummy node of decision tree and enqueue it to
     Q. Profit and weight of dummy node are 0.
     </p></li>
<li 
  class="enumerate" id="x1-70010x5">
     <!--l. 1366--><p class="noindent" >Do following while Q is not empty.
     </p></li>
<li 
  class="enumerate" id="x1-70012x6">
     <!--l. 1367--><p class="noindent" >Extract an item from Q. Let the extracted item be u.
     </p></li>
<li 
  class="enumerate" id="x1-70014x7">
     <!--l. 1368--><p class="noindent" >Compute profit of next level node. If the profit is more
     than maxProfit, then update maxProfit.
     </p></li>
<li 
  class="enumerate" id="x1-70016x8">
     <!--l. 1369--><p class="noindent" >Compute bound of next level node. If bound is more than
     maxProfit, then add next level node to Q.
     </p></li>
<li 
  class="enumerate" id="x1-70018x9">
     <!--l. 1370--><p class="noindent" >Consider the case when next level node is not considered
     as part of solution and add a node to queue with level as
     next, but weight and profit without considering next level
     nodes.
</p>
     </li></ol>
<!--l. 1374--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-710001.9.3"></a>Illustration</h5>
<!--l. 1376-->
                                                    
                                                    
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-71001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Input</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">First</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">thing</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">every</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pair</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">second</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">thing</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{{2,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">40},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{3.14,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">50},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{1.98,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">100},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{5,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">95},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{3,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">30}};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9">Knapsack</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Capacity</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">10</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9">Output</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">possible</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">235</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-9">Below</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">diagram</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">shows</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">illustration</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Items</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">are</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-9">considered</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sorted</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">by</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9">/</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">.</span>
</div>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-7101325"></a>
                                                    
                                                    
<!--l. 1392--><p class="noindent" ><img 
src="ks-tree-weight.jpg" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.25:</span><span  
class="content">Implementation of 0/1 Knapsack using Branch and
Bound</span></figcaption><!--tex4ht:label?: x1-7101325 -->
                                                    
                                                    
</figure>
<!--l. 1397--><p class="noindent" >Following is C++ implementation of above idea.
</p>
<!--l. 1399-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-71014r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">C</span><span 
class="cmtt-9">++</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">program</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">solve</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">problem</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">using</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71015r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">branch</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71016r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9">#</span><span 
class="cmtt-9">include</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9">bits</span><span 
class="cmtt-9">/</span><span 
class="cmtt-9">stdc</span><span 
class="cmtt-9">++.</span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71017r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9">using</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">namespace</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">std</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71018r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71019r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Structure</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">which</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">corresponding</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71020r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71021r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9">struct</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71022r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71023r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">float</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71024r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71025r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71026r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71027r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">structure</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">information</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">decision</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71028r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71029r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-9">struct</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71030r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71031r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">--&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">decision</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">or</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">index</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71032r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[]</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71033r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">--&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">path</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">this</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71034r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">including</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">this</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71035r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">---&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Upper</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">subtree</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71036r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">this</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71037r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71038r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">float</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71039r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71040r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71041r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Comparison</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">function</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sort</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">according</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71042r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">val</span><span 
class="cmtt-9">/</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">ratio</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71043r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cmp</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">b</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71044r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71045r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">double</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">r1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">double</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">a</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71046r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">double</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">r2</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">double</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">b</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">b</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71047r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">r1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">r2</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71048r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71049r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71050r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Returns</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">subtree</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">rooted</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71051r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">This</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">function</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">mainly</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">uses</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Greedy</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">solution</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">find</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71052r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">an</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">upper</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71053r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[])</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71054r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71055r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">overcomes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">capacity</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71056r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">as</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">expected</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71057r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71058r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71059r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71060r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">initialize</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">by</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71061r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit_bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71062r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71063r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">start</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">including</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">items</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">index</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">more</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71064r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">index</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71065r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71066r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">totweight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71067r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71068r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">checking</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">index</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">condition</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">capacity</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71069r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">condition</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71070r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">while</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">((</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0026;&#x0026;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">totweight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71071r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71072r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">totweight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71073r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit_bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">value</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71074r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">++;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71075r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71076r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71077r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">k</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">not</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">include</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">last</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">partially</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71078r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">upper</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71079r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71080r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit_bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">totweight</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71081r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71082r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71083r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit_bound</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71084r71"></a><span 
class="cmr-5">71</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71085r72"></a><span 
class="cmr-5">72</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71086r73"></a><span 
class="cmr-5">73</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Returns</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">we</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">can</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">get</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">capacity</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71087r74"></a><span 
class="cmr-5">74</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[],</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71088r75"></a><span 
class="cmr-5">75</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71089r76"></a><span 
class="cmr-5">76</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sorting</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">basis</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">per</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">unit</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71090r77"></a><span 
class="cmr-5">77</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71091r78"></a><span 
class="cmr-5">78</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sort</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cmp</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71092r79"></a><span 
class="cmr-5">79</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71093r80"></a><span 
class="cmr-5">80</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">make</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">queue</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">traversing</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71094r81"></a><span 
class="cmr-5">81</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">queue</span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71095r82"></a><span 
class="cmr-5">82</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71096r83"></a><span 
class="cmr-5">83</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71097r84"></a><span 
class="cmr-5">84</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">dummy</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">at</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">starting</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71098r85"></a><span 
class="cmr-5">85</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71099r86"></a><span 
class="cmr-5">86</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71100r87"></a><span 
class="cmr-5">87</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">push</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71101r88"></a><span 
class="cmr-5">88</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71102r89"></a><span 
class="cmr-5">89</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">One</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">by</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">one</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">extract</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">an</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">decision</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71103r90"></a><span 
class="cmr-5">90</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">compute</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">all</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">children</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">extracted</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71104r91"></a><span 
class="cmr-5">91</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">keep</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">saving</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71105r92"></a><span 
class="cmr-5">92</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71106r93"></a><span 
class="cmr-5">93</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">while</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(!</span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">empty</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71107r94"></a><span 
class="cmr-5">94</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71108r95"></a><span 
class="cmr-5">95</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Dequeue</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71109r96"></a><span 
class="cmr-5">96</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">front</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71110r97"></a><span 
class="cmr-5">97</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">pop</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71111r98"></a><span 
class="cmr-5">98</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71112r99"></a><span 
class="cmr-5">99</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">it</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">starting</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assign</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71113r100"></a><span 
class="cmr-5">100</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">==</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-1)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71114r101"></a><span 
class="cmr-5">101</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71115r102"></a><span 
class="cmr-5">102</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71116r103"></a><span 
class="cmr-5">103</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">there</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nothing</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">next</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71117r104"></a><span 
class="cmr-5">104</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">==</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">-1)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71118r105"></a><span 
class="cmr-5">105</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">continue</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71119r106"></a><span 
class="cmr-5">106</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71120r107"></a><span 
class="cmr-5">107</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Else</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">not</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">last</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">then</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">increment</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71121r108"></a><span 
class="cmr-5">108</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">compute</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">children</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71122r109"></a><span 
class="cmr-5">109</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71123r110"></a><span 
class="cmr-5">110</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71124r111"></a><span 
class="cmr-5">111</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Taking</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">’</span><span 
class="cmtt-9">s</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71125r112"></a><span 
class="cmr-5">112</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">’</span><span 
class="cmtt-9">s</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">’</span><span 
class="cmtt-9">s</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71126r113"></a><span 
class="cmr-5">113</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71127r114"></a><span 
class="cmr-5">114</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71128r115"></a><span 
class="cmr-5">115</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">level</span><span 
class="cmtt-9">].</span><span 
class="cmtt-9">value</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71129r116"></a><span 
class="cmr-5">116</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71130r117"></a><span 
class="cmr-5">117</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cumulated</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">less</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">than</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71131r118"></a><span 
class="cmr-5">118</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">greater</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">than</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">previous</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71132r119"></a><span 
class="cmr-5">119</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">update</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxprofit</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71133r120"></a><span 
class="cmr-5">120</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0026;&#x0026;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71134r121"></a><span 
class="cmr-5">121</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71135r122"></a><span 
class="cmr-5">122</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71136r123"></a><span 
class="cmr-5">123</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Get</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">upper</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">decide</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71137r124"></a><span 
class="cmr-5">124</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">whether</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">or</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">not</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71138r125"></a><span 
class="cmr-5">125</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71139r126"></a><span 
class="cmr-5">126</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71140r127"></a><span 
class="cmr-5">127</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">value</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">greater</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">than</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71141r128"></a><span 
class="cmr-5">128</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">then</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">only</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">push</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">into</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">queue</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">further</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71142r129"></a><span 
class="cmr-5">129</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">consideration</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71143r130"></a><span 
class="cmr-5">130</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71144r131"></a><span 
class="cmr-5">131</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">push</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71145r132"></a><span 
class="cmr-5">132</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71146r133"></a><span 
class="cmr-5">133</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Do</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">same</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">thing</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">but</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Without</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">taking</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71147r134"></a><span 
class="cmr-5">134</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71148r135"></a><span 
class="cmr-5">135</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71149r136"></a><span 
class="cmr-5">136</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71150r137"></a><span 
class="cmr-5">137</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71151r138"></a><span 
class="cmr-5">138</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71152r139"></a><span 
class="cmr-5">139</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Q</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">push</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">v</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71153r140"></a><span 
class="cmr-5">140</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71154r141"></a><span 
class="cmr-5">141</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71155r142"></a><span 
class="cmr-5">142</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">maxProfit</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71156r143"></a><span 
class="cmr-5">143</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71157r144"></a><span 
class="cmr-5">144</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71158r145"></a><span 
class="cmr-5">145</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">driver</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">program</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">test</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">above</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">function</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71159r146"></a><span 
class="cmr-5">146</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">main</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71160r147"></a><span 
class="cmr-5">147</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71161r148"></a><span 
class="cmr-5">148</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">W</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">10;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71162r149"></a><span 
class="cmr-5">149</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Item</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{{2,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">40},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{3.14,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">50},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{1.98,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">100},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71163r150"></a><span 
class="cmr-5">150</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{5,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">95},</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{3,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">30}};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71164r151"></a><span 
class="cmr-5">151</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sizeof</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sizeof</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">[0])</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71165r152"></a><span 
class="cmr-5">152</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71166r153"></a><span 
class="cmr-5">153</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cout</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9">Maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">possible</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71167r154"></a><span 
class="cmr-5">154</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">knapsack</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">W</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">arr</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">n</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71168r155"></a><span 
class="cmr-5">155</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71169r156"></a><span 
class="cmr-5">156</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-71170r157"></a><span 
class="cmr-5">157</span></span><span 
class="cmtt-9">}</span>
</div>
<!--l. 1559--><p class="noindent" >Output :
</p>
<!--l. 1561-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-71171r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Maximum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">possible</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">profit</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">235</span>
</div>
<h4 class="subsectionHead"><span class="titlemark">1.9.4   </span> <a 
 id="x1-720001.9.4"></a>8 puzzle problem</h4>
<!--l. 1567--><p class="noindent" >Given a 3 board with 8 tiles (every tile has one number from 1 to 8)
and one empty space. The objective is to place the numbers on tiles
to match the final configuration using the empty space. We can
slide four adjacent (left, right, above, and below) tiles into the
empty space.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-7200126"></a>
                                                    
                                                    
<!--l. 1571--><p class="noindent" ><img 
src="puzzle8init.jpg" alt="PIC"  
width="199" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.26:</span><span  
class="content">8 puzzle problem</span></figcaption><!--tex4ht:label?: x1-7200126 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-730001.9.4"></a>Methods</h5>
<!--l. 1578--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-73002x1">
     <!--l. 1579--><p class="noindent" >DFS (Brute-Force) We can perform a depth-first search
     on state-space (Set of all configurations of a given problem
     i.e. all states that can be reached from the initial state)
     tree.
</p>
     <figure class="figure"> 
<a 
 id="x1-7300327"></a> <img 
src="puzzle-1.jpg" alt="PIC"  
width="274" height="274"  />
<figcaption class="caption" ><span class="id">Figure 1.27:</span><span  
class="content">8 puzzle problem - Puzzle 1 (State Space Tree for
8 Puzzle)</span></figcaption><!--tex4ht:label?: x1-7300327 -->
     </figure>
     <!--l. 1589--><p class="noindent" >In this solution, successive moves can take us away from the
     goal rather than bringing us closer. The search of state-space
     tree follows the leftmost path from the root regardless of the
     initial state. An answer node may never be found in this
     approach.
     </p></li>
<li 
  class="enumerate" id="x1-73005x2">
     <!--l. 1591--><p class="noindent" >BFS (Brute-Force) We can perform a Breadth-first search on
     the state space tree. This always finds a goal state nearest to
     the root. But no matter what the initial state is, the
     algorithm attempts the same sequence of moves like
     DFS.
     </p></li>
<li 
  class="enumerate" id="x1-73007x3">
     <!--l. 1594--><p class="noindent" >Branch and Bound The search for an answer node can often
     be speeded by using an “intelligent” ranking function, also
     called an approximate cost function to avoid searching
                                                    
                                                    
     in sub-trees that do not contain an answer node. It is
     similar to the backtracking technique but uses a BFS-like
     search.
     </p><!--l. 1597--><p class="noindent" >There are basically three types of nodes involved in Branch
     and Bound
     </p><!--l. 1599--><p class="noindent" >
         </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-73009x1">
         <!--l. 1600--><p class="noindent" >Live  node  is  a  node  that  has  been  generated  but
         whose children have not yet been generated.
         </p></li>
<li 
  class="enumerate" id="x1-73011x2">
         <!--l. 1601--><p class="noindent" >E-node is a live node whose children are currently
         being explored. In other words, an E-node is a node
         currently being expanded.
         </p></li>
<li 
  class="enumerate" id="x1-73013x3">
         <!--l. 1602--><p class="noindent" >Dead  node  is  a  generated  node  that  is  not  to  be
         expanded or explored any further. All children of a
         dead node have already been expanded.</p></li></ol>
     <!--l. 1605--><p class="noindent" >Cost function:
     </p><!--l. 1607--><p class="noindent" >Each node <!--l. 1607--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi></math>
     in the search tree is associated with a cost. The cost function
     is useful for determining the next E-node. The next E-node is
     the one with the least cost. The cost function is defined
     as
</p>
     <!--l. 1609-->
     <div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-73014r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">C</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">X</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">g</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">X</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">X</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">where</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73015r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">g</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">X</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">reaching</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73016r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73017r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">X</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">reaching</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">an</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">answer</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="tctt-0900">$</span><span 
class="cmtt-9">X</span><span 
class="tctt-0900">$</span><span 
class="cmtt-9">.</span>
     
     </div>
     <!--l. 1616--><p class="noindent" >The ideal Cost function for an 8-puzzle Algorithm :
                                                    
                                                    
     </p><!--l. 1618--><p class="noindent" >We assume that moving one tile in any direction will have a 1
     unit cost. Keeping that in mind, we define a cost function for
     the 8-puzzle algorithm as below:
</p>
     <!--l. 1620-->
     <div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-73018r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">c</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">f</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">where</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73019r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">f</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">length</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">path</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73020r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">number</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">moves</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">so</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">far</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73021r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">number</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">non</span><span 
class="cmtt-9">-</span><span 
class="cmtt-9">blank</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tiles</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">not</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73022r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">their</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">goal</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">position</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">number</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">mis</span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73023r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9">placed</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tiles</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">There</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">are</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">at</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-73024r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">moves</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">transform</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">state</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">goal</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">state</span>
     
     </div>
     </li></ol>
<!--l. 1631--><p class="noindent" >An algorithm is available for getting an approximation of
<!--l. 1631--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
which is an unknown value. The below diagram shows the path
followed by the algorithm to reach the final configuration
from the given initial configuration of the 8-Puzzle. Note
that only nodes having the least value of cost function are
expanded.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-7302528"></a>
                                                    
                                                    
<!--l. 1635--><p class="noindent" ><img 
src="puzzle8.jpg" alt="PIC"  
width="142" height="170"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.28:</span><span  
class="content">8 puzzle problem</span></figcaption><!--tex4ht:label?: x1-7302528 -->
                                                    
                                                    
</figure>
<!--l. 1640--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73026r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python3</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73027r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">destination</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80">*</span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73028r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">algorithm</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Branch</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73029r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">The</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">assumes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">that</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">instance</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73030r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solvable</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73031r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73032r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Importing</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">copy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">deepcopy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73033r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">copy</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73034r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73035r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Importing</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">heap</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">functions</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">python</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73036r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">library</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Queue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73037r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">heapq</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">heappush</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">heappop</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73038r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73039r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">variable</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">can</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">be</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">changed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">change</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73040r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">8</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80">=</span><span 
class="cmsltt-10x-x-80">3</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">15</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73041r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80">=</span><span 
class="cmsltt-10x-x-80">4</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">24</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">n</span><span 
class="cmsltt-10x-x-80">=</span><span 
class="cmsltt-10x-x-80">5</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80">...</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73042r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span id="textcolor5628"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73043r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73044r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bottom</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">left</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">top</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">right</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73045r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8">row</span><span 
class="cmtt-8"> </span><span id="textcolor5646"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor5649"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor5658"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span id="textcolor5665"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73046r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8">col</span><span 
class="cmtt-8"> </span><span id="textcolor5669"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor5672"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor5678"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor5688"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73047r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73048r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">A</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Queue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73049r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">priorityQueue</span><span id="textcolor5704"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73050r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73051r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Constructor</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initialize</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73052r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Queue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73053r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor5726"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73054r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">heap</span><span 
class="cmtt-8"> </span><span id="textcolor5732"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor5735"><span 
class="cmtt-8">[</span></span><span id="textcolor5737"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73055r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73056r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Inserts</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">new</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">key</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmsltt-10x-x-80">k</span><span 
class="cmsltt-10x-x-80">’</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73057r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">push</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">k</span><span 
class="cmtt-8">)</span><span id="textcolor5761"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73058r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">heappush</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">heap</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">k</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73059r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73060r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Method</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">remove</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">minimum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">element</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73061r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Queue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73062r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor5796"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73063r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">heappop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">heap</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73064r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73065r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Method</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">know</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Queue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">empty</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73066r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">)</span><span id="textcolor5829"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73067r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">heap</span><span id="textcolor5838"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73068r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73069r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">else</span><span id="textcolor5844"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73070r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73071r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73072r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">structure</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73073r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">node</span><span id="textcolor5857"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73074r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73075r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73076r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">)</span><span id="textcolor5879"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73077r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73078r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">parent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73079r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">helps</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tracing</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73080r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">when</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">answer</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">found</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73081r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8"> </span><span id="textcolor5922"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73082r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73083r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73084r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8"> </span><span id="textcolor5937"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73085r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73086r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">position</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">at</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">which</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73087r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">empty</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">space</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tile</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">exists</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73088r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8"> </span><span id="textcolor5973"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73089r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73090r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Storesthe</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">misplaced</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tiles</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73091r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span id="textcolor5992"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73092r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73093r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">moves</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">so</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">far</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73094r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor6015"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73095r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73096r71"></a><span 
class="cmr-5">71</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">method</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">defined</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">so</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">that</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73097r72"></a><span 
class="cmr-5">72</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">queue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">formed</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">based</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">on</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73098r73"></a><span 
class="cmr-5">73</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">variable</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">objects</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73099r74"></a><span 
class="cmr-5">74</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__lt__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nxt</span><span 
class="cmtt-8">)</span><span id="textcolor6069"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73100r75"></a><span 
class="cmr-5">75</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span id="textcolor6077"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nxt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73101r76"></a><span 
class="cmr-5">76</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73102r77"></a><span 
class="cmr-5">77</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">calculate</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73103r78"></a><span 
class="cmr-5">78</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">misplaced</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tiles</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">ie</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">non</span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80">blank</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73104r79"></a><span 
class="cmr-5">79</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tiles</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">their</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">goal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">position</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73105r80"></a><span 
class="cmr-5">80</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">calculateCost</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor6135"><span 
class="cmtt-8">-</span></span><span id="textcolor6137"><span 
class="cmtt-8">&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">int</span><span id="textcolor6141"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73106r81"></a><span 
class="cmr-5">81</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73107r82"></a><span 
class="cmr-5">82</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">count</span><span 
class="cmtt-8"> </span><span id="textcolor6145"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73108r83"></a><span 
class="cmr-5">83</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor6159"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73109r84"></a><span 
class="cmr-5">84</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">j</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor6171"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73110r85"></a><span 
class="cmr-5">85</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">mat</span><span id="textcolor6177"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor6180"><span 
class="cmtt-8">]</span></span><span id="textcolor6182"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor6185"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73111r86"></a><span 
class="cmr-5">86</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span id="textcolor6192"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor6195"><span 
class="cmtt-8">]</span></span><span id="textcolor6197"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor6200"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor6203"><span 
class="cmtt-8">!</span></span><span id="textcolor6205"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span id="textcolor6209"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor6212"><span 
class="cmtt-8">]</span></span><span id="textcolor6214"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor6217"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span id="textcolor6221"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73112r87"></a><span 
class="cmr-5">87</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">count</span><span 
class="cmtt-8"> </span><span id="textcolor6225"><span 
class="cmtt-8">+</span></span><span id="textcolor6227"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73113r88"></a><span 
class="cmr-5">88</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73114r89"></a><span 
class="cmr-5">89</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">count</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73115r90"></a><span 
class="cmr-5">90</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73116r91"></a><span 
class="cmr-5">91</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">newNode</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73117r92"></a><span 
class="cmr-5">92</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor6255"><span 
class="cmtt-8">-</span></span><span id="textcolor6257"><span 
class="cmtt-8">&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">node</span><span id="textcolor6261"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73118r93"></a><span 
class="cmr-5">93</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73119r94"></a><span 
class="cmr-5">94</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Copy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">parent</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73120r95"></a><span 
class="cmr-5">95</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span 
class="cmtt-8"> </span><span id="textcolor6282"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">copy</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">deepcopy</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73121r96"></a><span 
class="cmr-5">96</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73122r97"></a><span 
class="cmr-5">97</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Move</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tile</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">position</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73123r98"></a><span 
class="cmr-5">98</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">x1</span><span 
class="cmtt-8"> </span><span id="textcolor6304"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span id="textcolor6308"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor6311"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73124r99"></a><span 
class="cmr-5">99</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y1</span><span 
class="cmtt-8"> </span><span id="textcolor6315"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span id="textcolor6319"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor6322"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73125r100"></a><span 
class="cmr-5">100</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">x2</span><span 
class="cmtt-8"> </span><span id="textcolor6326"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_empty_tile_pos</span><span id="textcolor6330"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor6333"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73126r101"></a><span 
class="cmr-5">101</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y2</span><span 
class="cmtt-8"> </span><span id="textcolor6337"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_empty_tile_pos</span><span id="textcolor6341"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor6344"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73127r102"></a><span 
class="cmr-5">102</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span id="textcolor6347"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">x1</span><span id="textcolor6350"><span 
class="cmtt-8">]</span></span><span id="textcolor6352"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">y1</span><span id="textcolor6355"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span id="textcolor6360"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">x2</span><span id="textcolor6363"><span 
class="cmtt-8">]</span></span><span id="textcolor6365"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">y2</span><span id="textcolor6368"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor6371"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span id="textcolor6375"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">x2</span><span id="textcolor6378"><span 
class="cmtt-8">]</span></span><span id="textcolor6380"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">y2</span><span id="textcolor6383"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span id="textcolor6388"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">x1</span><span id="textcolor6391"><span 
class="cmtt-8">]</span></span><span id="textcolor6393"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">y1</span><span id="textcolor6396"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73128r103"></a><span 
class="cmr-5">103</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73129r104"></a><span 
class="cmr-5">104</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Set</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">misplaced</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tiles</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73130r105"></a><span 
class="cmr-5">105</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span id="textcolor6411"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">calculateCost</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">new_mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73131r106"></a><span 
class="cmr-5">106</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73132r107"></a><span 
class="cmr-5">107</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_node</span><span 
class="cmtt-8"> </span><span id="textcolor6423"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">node</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73133r108"></a><span 
class="cmr-5">108</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73134r109"></a><span 
class="cmr-5">109</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73135r110"></a><span 
class="cmr-5">110</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73136r111"></a><span 
class="cmr-5">111</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">x</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73137r112"></a><span 
class="cmr-5">112</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">printMatrix</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">)</span><span id="textcolor6467"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73138r113"></a><span 
class="cmr-5">113</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73139r114"></a><span 
class="cmr-5">114</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor6479"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73140r115"></a><span 
class="cmr-5">115</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">j</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor6491"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73141r116"></a><span 
class="cmr-5">116</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8">d</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">mat</span><span id="textcolor6505"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor6508"><span 
class="cmtt-8">]</span></span><span id="textcolor6510"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor6513"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span 
class="cmtt-8"> </span><span id="textcolor6520"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73142r117"></a><span 
class="cmr-5">117</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73143r118"></a><span 
class="cmr-5">118</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73144r119"></a><span 
class="cmr-5">119</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73145r120"></a><span 
class="cmr-5">120</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">check</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">x</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">y</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">valid</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73146r121"></a><span 
class="cmr-5">121</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">coordinate</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73147r122"></a><span 
class="cmr-5">122</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">isSafe</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span id="textcolor6565"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73148r123"></a><span 
class="cmr-5">123</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73149r124"></a><span 
class="cmr-5">124</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">x</span><span 
class="cmtt-8"> </span><span id="textcolor6571"><span 
class="cmtt-8">&#x003E;</span></span><span id="textcolor6573"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">x</span><span 
class="cmtt-8"> </span><span id="textcolor6582"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor6591"><span 
class="cmtt-8">&#x003E;</span></span><span id="textcolor6593"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor6602"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73150r125"></a><span 
class="cmr-5">125</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73151r126"></a><span 
class="cmr-5">126</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">destination</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73152r127"></a><span 
class="cmr-5">127</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">printPath</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">root</span><span 
class="cmtt-8">)</span><span id="textcolor6629"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73153r128"></a><span 
class="cmr-5">128</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73154r129"></a><span 
class="cmr-5">129</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">root</span><span 
class="cmtt-8"> </span><span id="textcolor6635"><span 
class="cmtt-8">=</span></span><span id="textcolor6637"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span id="textcolor6641"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73155r130"></a><span 
class="cmr-5">130</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73156r131"></a><span 
class="cmr-5">131</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73157r132"></a><span 
class="cmr-5">132</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">printPath</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">root</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">parent</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73158r133"></a><span 
class="cmr-5">133</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">printMatrix</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">root</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73159r134"></a><span 
class="cmr-5">134</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73160r135"></a><span 
class="cmr-5">135</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73161r136"></a><span 
class="cmr-5">136</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solve</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80">*</span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">algorithm</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73162r137"></a><span 
class="cmr-5">137</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Branch</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Bound</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">empty_tile_pos</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73163r138"></a><span 
class="cmr-5">138</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">blank</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tile</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">position</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initial</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">state</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73164r139"></a><span 
class="cmr-5">139</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">solve</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">initial</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span><span id="textcolor6721"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73165r140"></a><span 
class="cmr-5">140</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73166r141"></a><span 
class="cmr-5">141</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">priority</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">queue</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">store</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73167r142"></a><span 
class="cmr-5">142</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tree</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73168r143"></a><span 
class="cmr-5">143</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8"> </span><span id="textcolor6749"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">priorityQueue</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73169r144"></a><span 
class="cmr-5">144</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73170r145"></a><span 
class="cmr-5">145</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73171r146"></a><span 
class="cmr-5">146</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span id="textcolor6765"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">calculateCost</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">initial</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73172r147"></a><span 
class="cmr-5">147</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">root</span><span 
class="cmtt-8"> </span><span id="textcolor6777"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">node</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">None</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">initial</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73173r148"></a><span 
class="cmr-5">148</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73174r149"></a><span 
class="cmr-5">149</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73175r150"></a><span 
class="cmr-5">150</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73176r151"></a><span 
class="cmr-5">151</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">push</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">root</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73177r152"></a><span 
class="cmr-5">152</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73178r153"></a><span 
class="cmr-5">153</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Finds</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">least</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73179r154"></a><span 
class="cmr-5">154</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">its</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">children</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73180r155"></a><span 
class="cmr-5">155</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">finally</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">deletes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73181r156"></a><span 
class="cmr-5">156</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73182r157"></a><span 
class="cmr-5">157</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">while</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty</span><span 
class="cmtt-8">()</span><span id="textcolor6874"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73183r158"></a><span 
class="cmr-5">158</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73184r159"></a><span 
class="cmr-5">159</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Find</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">least</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">estimated</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73185r160"></a><span 
class="cmr-5">160</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">delete</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">form</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73186r161"></a><span 
class="cmr-5">161</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73187r162"></a><span 
class="cmr-5">162</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8"> </span><span id="textcolor6915"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pop</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73188r163"></a><span 
class="cmr-5">163</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73189r164"></a><span 
class="cmr-5">164</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">If</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">minimum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">answer</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73190r165"></a><span 
class="cmr-5">165</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span id="textcolor6941"><span 
class="cmtt-8">=</span></span><span id="textcolor6943"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor6947"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73191r166"></a><span 
class="cmr-5">166</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73192r167"></a><span 
class="cmr-5">167</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Print</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73193r168"></a><span 
class="cmr-5">168</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">destination</span><span 
class="cmsltt-10x-x-80">;</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73194r169"></a><span 
class="cmr-5">169</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">printPath</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73195r170"></a><span 
class="cmr-5">170</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73196r171"></a><span 
class="cmr-5">171</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73197r172"></a><span 
class="cmr-5">172</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Generate</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">possible</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">children</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73198r173"></a><span 
class="cmr-5">173</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n</span><span 
class="cmtt-8">)</span><span id="textcolor6990"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73199r174"></a><span 
class="cmr-5">174</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_tile_pos</span><span 
class="cmtt-8"> </span><span id="textcolor6994"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor6997"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73200r175"></a><span 
class="cmr-5">175</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty_tile_pos</span><span id="textcolor7002"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor7005"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor7008"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">row</span><span id="textcolor7012"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor7015"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73201r176"></a><span 
class="cmr-5">176</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty_tile_pos</span><span id="textcolor7021"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor7024"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor7027"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">col</span><span id="textcolor7031"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor7034"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor7038"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73202r177"></a><span 
class="cmr-5">177</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73203r178"></a><span 
class="cmr-5">178</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">isSafe</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">new_tile_pos</span><span id="textcolor7045"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor7048"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_tile_pos</span><span id="textcolor7053"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor7056"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span id="textcolor7059"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73204r179"></a><span 
class="cmr-5">179</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73205r180"></a><span 
class="cmr-5">180</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">child</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73206r181"></a><span 
class="cmr-5">181</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">child</span><span 
class="cmtt-8"> </span><span id="textcolor7072"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">newNode</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mat</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73207r182"></a><span 
class="cmr-5">182</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73208r183"></a><span 
class="cmr-5">183</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">new_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73209r184"></a><span 
class="cmr-5">184</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor7091"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73210r185"></a><span 
class="cmr-5">185</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">minimum</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">,)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73211r186"></a><span 
class="cmr-5">186</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73212r187"></a><span 
class="cmr-5">187</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">child</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">list</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">live</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73213r188"></a><span 
class="cmr-5">188</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pq</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">push</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">child</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73214r189"></a><span 
class="cmr-5">189</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73215r190"></a><span 
class="cmr-5">190</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Driver</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Code</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73216r191"></a><span 
class="cmr-5">191</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73217r192"></a><span 
class="cmr-5">192</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Initial</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">configuration</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73218r193"></a><span 
class="cmr-5">193</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Value</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">0</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">used</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">empty</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">space</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73219r194"></a><span 
class="cmr-5">194</span></span><span 
class="cmtt-8">initial</span><span 
class="cmtt-8"> </span><span id="textcolor7149"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor7152"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span id="textcolor7155"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8"> </span><span id="textcolor7166"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73220r195"></a><span 
class="cmr-5">195</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor7169"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span id="textcolor7180"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73221r196"></a><span 
class="cmr-5">196</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor7183"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8"> </span><span id="textcolor7194"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor7197"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73222r197"></a><span 
class="cmr-5">197</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73223r198"></a><span 
class="cmr-5">198</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Solvable</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Final</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">configuration</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73224r199"></a><span 
class="cmr-5">199</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Value</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">0</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">used</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">empty</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">space</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73225r200"></a><span 
class="cmr-5">200</span></span><span 
class="cmtt-8">final</span><span 
class="cmtt-8"> </span><span id="textcolor7223"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor7226"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span id="textcolor7229"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8"> </span><span id="textcolor7240"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73226r201"></a><span 
class="cmr-5">201</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor7243"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8"> </span><span id="textcolor7254"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73227r202"></a><span 
class="cmr-5">202</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor7257"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8"> </span><span id="textcolor7268"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor7271"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73228r203"></a><span 
class="cmr-5">203</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73229r204"></a><span 
class="cmr-5">204</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Blank</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tile</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">coordinates</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73230r205"></a><span 
class="cmr-5">205</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initial</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">configuration</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73231r206"></a><span 
class="cmr-5">206</span></span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8"> </span><span id="textcolor7289"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor7292"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8"> </span><span id="textcolor7300"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73232r207"></a><span 
class="cmr-5">207</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73233r208"></a><span 
class="cmr-5">208</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">call</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solve</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">puzzle</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73234r209"></a><span 
class="cmr-5">209</span></span><span 
class="cmtt-8">solve</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">initial</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">empty_tile_pos</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-73237r212"></a><span 
class="cmr-5">212</span></span></pre>
<!--l. 1853--><p class="noindent" >Output :
                                                    
                                                    
</p>
<pre class="verbatim" id="verbatim-3">
1 2 3
5 6 0
7 8 4

1 2 3
5 0 6
7 8 4

1 2 3
5 8 6
7 0 4

1 2 3
5 8 6
0 7 4</pre>
<!--l. 1871--><p class="nopar" >
</p>
<h4 class="subsectionHead"><span class="titlemark">1.9.5   </span> <a 
 id="x1-740001.9.5"></a>Job Assignment Problem</h4>
<!--l. 1875--><p class="noindent" >Let there be <span 
class="cmti-10">N </span>workers and <span 
class="cmti-10">N </span>jobs. Any worker can be assigned to
perform any job, incurring some cost that may vary depending on
the work-job assignment. It is required to perform all jobs by
assigning exactly one worker to each job and exactly one job to each
agent in such a way that the total cost of the assignment is
minimized.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-7400129"></a>
                                                    
                                                    
<!--l. 1879--><p class="noindent" ><img 
src="jobassignment.png" alt="PIC"  
width="184" height="142"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.29:</span><span  
class="content">Job Assignment</span></figcaption><!--tex4ht:label?: x1-7400129 -->
                                                    
                                                    
</figure>
<!--l. 1884--><p class="noindent" >Let us explore all approaches for this problem.
     </p><dl class="description"><dt class="description">
     <!--l. 1887--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1887--><p class="noindent" >Solution 1: Brute Force
     </p><!--l. 1889--><p class="noindent" >We generate <!--l. 1889--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi><mo 
class="MathClass-punc">!</mo></math>
     possible job assignments and for each such assignment,
     we compute its total cost and return the less expensive
     assignment. Since the solution is a permutation of the n
     jobs, its complexity is <!--l. 1889--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-punc">!</mo><mo 
class="MathClass-close">)</mo></math>.
     </p></dd><dt class="description">
     <!--l. 1891--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1891--><p class="noindent" >Solution 2: Hungarian Algorithm
     </p><!--l. 1893--><p class="noindent" >The optimal assignment can be found using the Hungarian
     algorithm. The Hungarian algorithm has worst case run-time
     complexity of <!--l. 1893--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>.
     </p></dd><dt class="description">
     <!--l. 1895--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1895--><p class="noindent" >Solution 3: DFS/BFS on state space tree
     </p><!--l. 1897--><p class="noindent" >A state space tree is a N-ary tree with property that any
     path from root to leaf node holds one of many solutions to
     given problem. We can perform depth-first search on state
     space tree and but successive moves can take us away from
     the goal rather than bringing closer. The search of state
     space tree follows leftmost path from the root regardless
     of initial state. An answer node may never be found in this
     approach. We can also perform a Breadth-first search on
     state space tree. But no matter what the initial state is,
     the algorithm attempts the same sequence of moves like
     DFS.
     </p></dd><dt class="description">
                                                    
                                                    
     <!--l. 1899--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 1899--><p class="noindent" >Solution 4: Finding Optimal Solution using Branch and
     Bound  The  selection  rule  for  the  next  node  in  BFS
     and  DFS  is  blind.  i.e.  the  selection  rule  does  not  give
     any preference to a node that has a very good chance
     of  getting  the  search  to  an  answer  node  quickly.  The
     search  for  an  optimal  solution  can  often  be  speeded
     by using an intelligent ranking function, also called an
     approximate cost function to avoid searching in sub-trees
     that do not contain an optimal solution. It is similar to
     BFS-like search but with one major optimization. Instead
     of following FIFO order, we choose a live node with least
     cost. We may not get optimal solution by following node
     with least promising cost, but it will provide very good
     chance of getting the search to an answer node quickly.
     </p><!--l. 1902--><p class="noindent" >There are two approaches to calculate the cost function:
</p>
         <ul class="itemize1">
         <li class="itemize">
         <!--l. 1905--><p class="noindent" >For each worker, we choose job with minimum cost
         from list of unassigned jobs (take minimum entry
         from each row).
         </p></li>
         <li class="itemize">
         <!--l. 1906--><p class="noindent" >For each job, we choose a worker with lowest cost
         for that job from list of unassigned workers (take
         minimum entry from each column).</p></li></ul>
     <!--l. 1909--><p class="noindent" >We will choose the first approach for the solution. Lets take
     below example and try to calculate promising cost when Job 2
     is assigned to worker A.
</p>
     <figure class="figure"> 
<a 
 id="x1-7400230"></a> <img 
src="jobassignment2.png" alt="PIC"  
width="184" height="142"  />
<figcaption class="caption" ><span class="id">Figure 1.30:</span><span  
class="content">Iter 1</span></figcaption><!--tex4ht:label?: x1-7400230 -->
     </figure>
     <!--l. 1918--><p class="noindent" >Since Job 2 is assigned to worker A (marked in green), cost
     becomes 2 and Job 2 and worker A becomes unavailable
                                                    
                                                    
     (marked in red).
</p>
     <figure class="figure"> 
<a 
 id="x1-7400331"></a> <img 
src="jobassignment3.png" alt="PIC"  
width="184" height="142"  />
<figcaption class="caption" ><span class="id">Figure 1.31:</span><span  
class="content">Iter 2</span></figcaption><!--tex4ht:label?: x1-7400331 -->
     </figure>
     <!--l. 1927--><p class="noindent" >Now we assign job 3 to worker B as it has minimum cost from
     list of unassigned jobs. Cost becomes 2 + 3 = 5 and Job 3 and
     worker B also becomes unavailable.
</p>
     <figure class="figure"> 
<a 
 id="x1-7400432"></a> <img 
src="jobassignment4.png" alt="PIC"  
width="184" height="142"  />
<figcaption class="caption" ><span class="id">Figure 1.32:</span><span  
class="content">Iter 3</span></figcaption><!--tex4ht:label?: x1-7400432 -->
     </figure>
     <!--l. 1936--><p class="noindent" >Finally, job 1 gets assigned to worker C as it has minimum
     cost among unassigned jobs and job 4 gets assigned to worker
     C as it is only Job left. Total cost becomes 2 + 3 + 5 + 4 =
     14.
</p>
     <figure class="figure"> 
<a 
 id="x1-7400533"></a> <img 
src="jobassignment5.png" alt="PIC"  
width="184" height="142"  />
<figcaption class="caption" ><span class="id">Figure 1.33:</span><span  
class="content">Iter 4</span></figcaption><!--tex4ht:label?: x1-7400533 -->
     </figure>
     <!--l. 1945--><p class="noindent" >Below diagram shows complete search space diagram showing
     optimal solution path in green.
</p>
     <figure class="figure"> 
<a 
 id="x1-7400634"></a> <img 
src="jobassignment6.png" alt="PIC"  
width="227" height="170"  />
<figcaption class="caption" ><span class="id">Figure 1.34:</span><span  
class="content">Full blown process</span></figcaption><!--tex4ht:label?: x1-7400634 -->
     </figure>
     <!--l. 1954--><p class="noindent" >Below is its C++ implementation.
</p>
     <!--l. 1956-->
     <div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-74007r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Program</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">solve</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Assignment</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">problem</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74008r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">using</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Branch</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Bound</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74009r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9">#</span><span 
class="cmtt-9">include</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9">bits</span><span 
class="cmtt-9">/</span><span 
class="cmtt-9">stdc</span><span 
class="cmtt-9">++.</span><span 
class="cmtt-9">h</span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74010r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9">using</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">namespace</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">std</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74011r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9">#</span><span 
class="cmtt-9">define</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">4</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74012r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74013r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">state</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">space</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74014r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9">struct</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74015r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74016r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">stores</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74017r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">helps</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tracing</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">path</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">when</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">answer</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">found</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74018r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74019r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74020r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">contains</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">ancestors</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74021r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">including</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74022r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pathCost</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74023r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74024r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">contains</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">promising</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74025r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74026r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74027r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">contain</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">worker</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">number</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74028r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">workerID</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74029r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74030r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">contains</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">ID</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74031r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">jobID</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74032r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74033r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Boolean</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">array</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">will</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">contains</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74034r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">info</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">about</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">available</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">jobs</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74035r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">];</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74036r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74037r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74038r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Function</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">allocate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">new</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">search</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74039r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Here</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Person</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74040r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">newNode</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[],</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74041r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74042r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74043r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">new</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74044r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74045r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">++)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74046r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">];</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74047r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">true</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74048r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74049r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74050r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">workerID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74051r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">jobID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74052r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74053r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74054r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74055r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74056r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Function</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">calculate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">promising</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74057r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">after</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">worker</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74058r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">calculateCost</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">],</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74059r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[])</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74060r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74061r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74062r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74063r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">unavailable</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">jobs</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74064r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">available</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9">true</span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74065r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74066r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">start</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">next</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">worker</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74067r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">++)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74068r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74069r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">INT_MAX</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minIndex</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74070r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74071r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">do</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">each</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74072r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">++)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74073r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74074r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">unassigned</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74075r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(!</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0026;&#x0026;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">available</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0026;&#x0026;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74076r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74077r71"></a><span 
class="cmr-5">71</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74078r72"></a><span 
class="cmr-5">72</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">number</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74079r73"></a><span 
class="cmr-5">73</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minIndex</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74080r74"></a><span 
class="cmr-5">74</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74081r75"></a><span 
class="cmr-5">75</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74082r76"></a><span 
class="cmr-5">76</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">];</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74083r77"></a><span 
class="cmr-5">77</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74084r78"></a><span 
class="cmr-5">78</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74085r79"></a><span 
class="cmr-5">79</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74086r80"></a><span 
class="cmr-5">80</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">next</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">worker</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74087r81"></a><span 
class="cmr-5">81</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74088r82"></a><span 
class="cmr-5">82</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74089r83"></a><span 
class="cmr-5">83</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">becomes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">unavailable</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74090r84"></a><span 
class="cmr-5">84</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">available</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">minIndex</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">false</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74091r85"></a><span 
class="cmr-5">85</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74092r86"></a><span 
class="cmr-5">86</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74093r87"></a><span 
class="cmr-5">87</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74094r88"></a><span 
class="cmr-5">88</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74095r89"></a><span 
class="cmr-5">89</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74096r90"></a><span 
class="cmr-5">90</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Comparison</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">object</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">be</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">used</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">order</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">heap</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74097r91"></a><span 
class="cmr-5">91</span></span><span 
class="cmtt-9">struct</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">comp</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74098r92"></a><span 
class="cmr-5">92</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74099r93"></a><span 
class="cmr-5">93</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">operator</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">const</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lhs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74100r94"></a><span 
class="cmr-5">94</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">const</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">rhs</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">const</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74101r95"></a><span 
class="cmr-5">95</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74102r96"></a><span 
class="cmr-5">96</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lhs</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">rhs</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74103r97"></a><span 
class="cmr-5">97</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74104r98"></a><span 
class="cmr-5">98</span></span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74105r99"></a><span 
class="cmr-5">99</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74106r100"></a><span 
class="cmr-5">100</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">print</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Assignments</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74107r101"></a><span 
class="cmr-5">101</span></span><span 
class="cmtt-9">void</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">printAssignments</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74108r102"></a><span 
class="cmr-5">102</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74109r103"></a><span 
class="cmr-5">103</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9">==</span><span 
class="cmtt-9">NULL</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74110r104"></a><span 
class="cmr-5">104</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74111r105"></a><span 
class="cmr-5">105</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74112r106"></a><span 
class="cmr-5">106</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">printAssignments</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">parent</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74113r107"></a><span 
class="cmr-5">107</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cout</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9">Assign</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Worker</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">char</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">workerID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">’</span><span 
class="cmtt-9">A</span><span 
class="cmtt-9">’</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74114r108"></a><span 
class="cmr-5">108</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Job</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">jobID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">endl</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74115r109"></a><span 
class="cmr-5">109</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74116r110"></a><span 
class="cmr-5">110</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74117r111"></a><span 
class="cmr-5">111</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74118r112"></a><span 
class="cmr-5">112</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Finds</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">using</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Branch</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Bound</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74119r113"></a><span 
class="cmr-5">113</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">findMinCost</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">])</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74120r114"></a><span 
class="cmr-5">114</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74121r115"></a><span 
class="cmr-5">115</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Create</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">priority</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">queue</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">store</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74122r116"></a><span 
class="cmr-5">116</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">search</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74123r117"></a><span 
class="cmr-5">117</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">priority_queue</span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">std</span><span 
class="cmtt-9">::</span><span 
class="cmtt-9">vector</span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*&#x003E;,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">comp</span><span 
class="cmtt-9">&#x003E;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74124r118"></a><span 
class="cmr-5">118</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74125r119"></a><span 
class="cmr-5">119</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">initialize</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">heap</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">dummy</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74126r120"></a><span 
class="cmr-5">120</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bool</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9">false</span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74127r121"></a><span 
class="cmr-5">121</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">newNode</span><span 
class="cmtt-9">(-1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">NULL</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74128r122"></a><span 
class="cmr-5">122</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">pathCost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74129r123"></a><span 
class="cmr-5">123</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">root</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">workerID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74130r124"></a><span 
class="cmr-5">124</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74131r125"></a><span 
class="cmr-5">125</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">dummy</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">list</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74132r126"></a><span 
class="cmr-5">126</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">push</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">root</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74133r127"></a><span 
class="cmr-5">127</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74134r128"></a><span 
class="cmr-5">128</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Finds</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74135r129"></a><span 
class="cmr-5">129</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">its</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">childrens</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">list</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74136r130"></a><span 
class="cmr-5">130</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">finally</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">deletes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">it</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">list</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74137r131"></a><span 
class="cmr-5">131</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">while</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(!</span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">empty</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74138r132"></a><span 
class="cmr-5">132</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74139r133"></a><span 
class="cmr-5">133</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Find</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">estimated</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74140r134"></a><span 
class="cmr-5">134</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">top</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74141r135"></a><span 
class="cmr-5">135</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74142r136"></a><span 
class="cmr-5">136</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">found</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">deleted</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">list</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74143r137"></a><span 
class="cmr-5">137</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74144r138"></a><span 
class="cmr-5">138</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">pop</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74145r139"></a><span 
class="cmr-5">139</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74146r140"></a><span 
class="cmr-5">140</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">stores</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">next</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">worker</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74147r141"></a><span 
class="cmr-5">141</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">workerID</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74148r142"></a><span 
class="cmr-5">142</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74149r143"></a><span 
class="cmr-5">143</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">all</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">workers</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">are</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74150r144"></a><span 
class="cmr-5">144</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">i</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">==</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74151r145"></a><span 
class="cmr-5">145</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74152r146"></a><span 
class="cmr-5">146</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">printAssignments</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74153r147"></a><span 
class="cmr-5">147</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74154r148"></a><span 
class="cmr-5">148</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74155r149"></a><span 
class="cmr-5">149</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74156r150"></a><span 
class="cmr-5">150</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">do</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">each</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">job</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74157r151"></a><span 
class="cmr-5">151</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">++)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74158r152"></a><span 
class="cmr-5">152</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74159r153"></a><span 
class="cmr-5">153</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">If</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">unassigned</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74160r154"></a><span 
class="cmr-5">154</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(!</span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">])</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74161r155"></a><span 
class="cmr-5">155</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74162r156"></a><span 
class="cmr-5">156</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">create</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">new</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tree</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74163r157"></a><span 
class="cmr-5">157</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">newNode</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74164r158"></a><span 
class="cmr-5">158</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74165r159"></a><span 
class="cmr-5">159</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">ancestors</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">including</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">current</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">node</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74166r160"></a><span 
class="cmr-5">160</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">pathCost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">min</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">pathCost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">];</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74167r161"></a><span 
class="cmr-5">161</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74168r162"></a><span 
class="cmr-5">162</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">calculate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">its</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74169r163"></a><span 
class="cmr-5">163</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">pathCost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74170r164"></a><span 
class="cmr-5">164</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">calculateCost</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">i</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">j</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9">-&#x003E;</span><span 
class="cmtt-9">assigned</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74171r165"></a><span 
class="cmr-5">165</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74172r166"></a><span 
class="cmr-5">166</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Add</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">child</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">list</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">live</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">nodes</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74173r167"></a><span 
class="cmr-5">167</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">pq</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">push</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">child</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74174r168"></a><span 
class="cmr-5">168</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74175r169"></a><span 
class="cmr-5">169</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74176r170"></a><span 
class="cmr-5">170</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74177r171"></a><span 
class="cmr-5">171</span></span><span 
class="cmtt-9">}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74178r172"></a><span 
class="cmr-5">172</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74179r173"></a><span 
class="cmr-5">173</span></span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Driver</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">code</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74180r174"></a><span 
class="cmr-5">174</span></span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">main</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74181r175"></a><span 
class="cmr-5">175</span></span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74182r176"></a><span 
class="cmr-5">176</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">-</span><span 
class="cmtt-9">coordinate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">represents</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Worker</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74183r177"></a><span 
class="cmr-5">177</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">//</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">y</span><span 
class="cmtt-9">-</span><span 
class="cmtt-9">coordinate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">represents</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Job</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74184r178"></a><span 
class="cmr-5">178</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74185r179"></a><span 
class="cmr-5">179</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74186r180"></a><span 
class="cmr-5">180</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{9,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">7,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">8},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74187r181"></a><span 
class="cmr-5">181</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{6,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">4,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">7},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74188r182"></a><span 
class="cmr-5">182</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{5,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">8,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">8},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74189r183"></a><span 
class="cmr-5">183</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{7,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">6,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">9,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">4}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74190r184"></a><span 
class="cmr-5">184</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74191r185"></a><span 
class="cmr-5">185</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74192r186"></a><span 
class="cmr-5">186</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74193r187"></a><span 
class="cmr-5">187</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74194r188"></a><span 
class="cmr-5">188</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74195r189"></a><span 
class="cmr-5">189</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{82,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">83,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">69,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">92},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74196r190"></a><span 
class="cmr-5">190</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{77,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">37,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">49,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">92},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74197r191"></a><span 
class="cmr-5">191</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{11,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">69,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">5,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">86},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74198r192"></a><span 
class="cmr-5">192</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">8,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">9,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">98,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">23}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74199r193"></a><span 
class="cmr-5">193</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">};</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74200r194"></a><span 
class="cmr-5">194</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*/</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74201r195"></a><span 
class="cmr-5">195</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74202r196"></a><span 
class="cmr-5">196</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74203r197"></a><span 
class="cmr-5">197</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74204r198"></a><span 
class="cmr-5">198</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{2500,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">4000,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3500},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74205r199"></a><span 
class="cmr-5">199</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{4000,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">6000,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3500},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74206r200"></a><span 
class="cmr-5">200</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{2000,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">4000,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2500}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74207r201"></a><span 
class="cmr-5">201</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">};*/</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74208r202"></a><span 
class="cmr-5">202</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74209r203"></a><span 
class="cmr-5">203</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/*</span><span 
class="cmtt-9">int</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">[</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">][</span><span 
class="cmtt-9">N</span><span 
class="cmtt-9">]</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74210r204"></a><span 
class="cmr-5">204</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74211r205"></a><span 
class="cmr-5">205</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{90,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">75,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">75,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">80},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74212r206"></a><span 
class="cmr-5">206</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{30,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">85,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">55,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">65},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74213r207"></a><span 
class="cmr-5">207</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{125,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">95,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">90,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">105},</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74214r208"></a><span 
class="cmr-5">208</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">{45,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">110,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">95,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">115}</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74215r209"></a><span 
class="cmr-5">209</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">};*/</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74216r210"></a><span 
class="cmr-5">210</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74217r211"></a><span 
class="cmr-5">211</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74218r212"></a><span 
class="cmr-5">212</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cout</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9">\</span><span 
class="cmtt-9">nOptimal</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74219r213"></a><span 
class="cmr-5">213</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003C;&#x003C;</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">findMinCost</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">costMatrix</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74220r214"></a><span 
class="cmr-5">214</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74221r215"></a><span 
class="cmr-5">215</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0;</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-74222r216"></a><span 
class="cmr-5">216</span></span><span 
class="cmtt-9">}</span>
     
     </div>
     <!--l. 2176--><p class="noindent" >Output :
                                                    
                                                    
</p>
     <pre class="verbatim" id="verbatim-4">
     Assign Worker A to Job 1
     Assign Worker B to Job 0
     Assign Worker C to Job 2
     Assign Worker D to Job 3
     
     Optimal Cost is 13
     </pre>
     <!--l. 2186--><p class="nopar" ></p></dd></dl>
<h4 class="subsectionHead"><span class="titlemark">1.9.6   </span> <a 
 id="x1-750001.9.6"></a>Traveling Salesman Problem</h4>
<!--l. 2191--><p class="noindent" >Given a set of cities and distance between every pair of cities, the
problem is to find the shortest possible tour that visits every city
exactly once and returns to the starting point.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-7500135"></a>
                                                    
                                                    
<!--l. 2195--><p class="noindent" ><img 
src="TSP.png" alt="PIC"  
width="170" height="142"  />
</p>
<figcaption class="caption" ><span class="id">Figure 1.35:</span><span  
class="content">TSP</span></figcaption><!--tex4ht:label?: x1-7500135 -->
                                                    
                                                    
</figure>
<!--l. 2200--><p class="noindent" >For example, consider the graph shown in figure on right side. A
TSP tour in the graph is 0-1-3-2-0. The cost of the tour is
10+25+30+15 which is 80.
</p><!--l. 2202--><p class="noindent" >In Branch and Bound method, for current node in tree, we compute
a bound on best possible solution that we can get if we down this
node. If the bound on best possible solution itself is worse than
current best (best computed so far), then we ignore the subtree
rooted with the node.
</p><!--l. 2204--><p class="noindent" >Note that the cost through a node includes two costs.
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-75003x1">
     <!--l. 2207--><p class="noindent" >Cost of reaching the node from the root (When we reach
     a node, we have this cost computed)
     </p></li>
<li 
  class="enumerate" id="x1-75005x2">
     <!--l. 2208--><p class="noindent" >Cost of reaching an answer from current node to a leaf
     (We compute a bound on this cost to decide whether to
     ignore subtree with this node or not).
</p>
     </li></ol>
     <dl class="description"><dt class="description">
     <!--l. 2213--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2213--><p class="noindent" >In  cases  of  a  maximization  problem,  an  upper  bound
     tells us the maximum possible solution if we follow the
     given node. For example in 0/1 knapsack we used Greedy
     approach to find an upper bound.
     </p></dd><dt class="description">
     <!--l. 2214--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2214--><p class="noindent" >In cases of a minimization problem, a lower bound tells
     us the minimum possible solution if we follow the given
                                                    
                                                    
     node. For example, in Job Assignment Problem, we get
     a lower bound by assigning least cost job to a worker. In
     branch and bound, the challenging part is figuring out a
     way to compute a bound on best possible solution. Below
     is an idea used to compute bounds for Traveling salesman
     problem.</p></dd></dl>
<!--l. 2218--><p class="noindent" >Cost of any tour can be written as below.
</p>
<!--l. 2220-->
<div class="lstlisting" id="listing-7"><span class="label"><a 
 id="x1-75006r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">T</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(1/2)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">?</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">two</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75007r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">adjacent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75008r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">T</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75009r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">where</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">\</span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">V</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75010r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9">For</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">every</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">vertex</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">we</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">consider</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">two</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">through</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">it</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">T</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75011r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">their</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">costs</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">overall</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">all</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">vertices</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">would</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75012r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9">be</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">twice</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">T</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">We</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">have</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">considered</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">every</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75013r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9">twice</span><span 
class="cmtt-9">.)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75014r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75015r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">two</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">adjacent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75016r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">two</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">adjacent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75017r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75018r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-9">Cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">any</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x003E;=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1/2)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">?</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">Sum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">two</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75019r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weight</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">adjacent</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75020r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">where</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">u</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">\</span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">V</span>
</div>
<!--l. 2238--><p class="noindent" >For example, consider the above shown graph. Below are minimum
cost two edges adjacent to every node.
</p>
<!--l. 2240-->
<div class="lstlisting" id="listing-8"><span class="label"><a 
 id="x1-75021r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Node</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Least</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edges</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Total</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75022r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9">0</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1)</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">25</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75023r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1)</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">35</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75024r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9">2</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2)</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(2,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">45</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75025r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9">3</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3)</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">45</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75026r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75027r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9">Thus</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">on</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">any</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">tour</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75028r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1/2(25</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">35</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">45</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">45)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75029r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">75</span>
</div>
<!--l. 2252--><p class="noindent" >Now we have an idea about computation of lower bound. Let us
see how to how to apply it state space search tree. We start
enumerating all possible nodes (preferably in lexicographical
order)
     </p><dl class="description"><dt class="description">
     <!--l. 2255--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2255--><p class="noindent" >The first one is <span 
class="cmti-10">Root Node</span>: Without loss of generality, we
     assume we start at vertex 0 for which the lower bound has
     been calculated above.
     </p></dd><dt class="description">
     <!--l. 2257--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2257--><p class="noindent" >Dealing  with  Level  2:  The  next  level  enumerates  all
     possible vertices we can go to (keeping in mind that in
                                                    
                                                    
     any path a vertex has to occur only once) which are, 1,
     2, 3 n (Note that the graph is complete). Consider we
     are calculating for vertex 1, Since we moved from 0 to 1,
     our tour has now included the edge 0-1. This allows us to
     make necessary changes in the lower bound of the root.
</p>
     <!--l. 2259-->
     <div class="lstlisting" id="listing-9"><span class="label"><a 
 id="x1-75030r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">vertex</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75031r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Old</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">((</span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75032r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75033r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0-1)</span>
     
     </div>
     <!--l. 2267--><p class="noindent" >How does it work? To include edge 0-1, we add the edge
     cost of 0-1, and subtract an edge weight such that the
     lower bound remains as tight as possible which would be
     the sum of the minimum edges of 0 and 1 divided by
     2. Clearly, the edge subtracted cant be smaller than
     this.
     </p></dd><dt class="description">
     <!--l. 2269--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2269--><p class="noindent" >Dealing with other levels: As we move on to the next level, we
     again enumerate all possible vertices. For the above case going
     further after 1, we check out for 2, 3, 4, n. Consider lower
     bound for 2 as we moved from 1 to 1, we include the edge
     1-2 to the tour and alter the new lower bound for this
     node.
</p>
     <!--l. 2272-->
     <div class="lstlisting" id="listing-10"><span class="label"><a 
 id="x1-75036r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">Lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9">(2)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75037r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Old</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">lower</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">bound</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">((</span><span 
class="cmtt-9">second</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75038r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">minimum</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2)</span><span 
class="cmtt-9">/2)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-75039r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">edge</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">cost</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1-2)</span>
     
     </div>
     <!--l. 2280--><p class="noindent" >Note: The only change in the formula is that this time we
     have included second minimum edge cost for 1, because the
     minimum edge cost has already been subtracted in previous
     level.</p></dd></dl>
<!--l. 2283--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75042r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Python3</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">program</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solve</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75043r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Traveling</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Salesman</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Problem</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75044r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Branch</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Bound</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75045r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">math</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75046r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">maxsize</span><span 
class="cmtt-8"> </span><span id="textcolor9232"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">float</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">inf</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75047r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75048r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">copy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">temporary</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75049r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75050r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">copyToFinal</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8">)</span><span id="textcolor9267"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75051r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">final_path</span><span id="textcolor9271"><span 
class="cmtt-8">[</span></span><span id="textcolor9273"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor9277"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor9281"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9284"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span id="textcolor9288"><span 
class="cmtt-8">[</span></span><span id="textcolor9290"><span 
class="cmtt-8">:</span></span><span id="textcolor9292"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75052r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">final_path</span><span id="textcolor9296"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">N</span><span id="textcolor9299"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9302"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span id="textcolor9306"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor9309"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75053r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75054r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">find</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">minimum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75055r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">having</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">end</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">at</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">i</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75056r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">firstMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span id="textcolor9350"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75057r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8">min</span><span 
class="cmtt-8"> </span><span id="textcolor9355"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxsize</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75058r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">k</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8">)</span><span id="textcolor9370"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75059r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9377"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9380"><span 
class="cmtt-8">]</span></span><span id="textcolor9382"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">k</span><span id="textcolor9385"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9388"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">min</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span id="textcolor9397"><span 
class="cmtt-8">!</span></span><span id="textcolor9399"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">k</span><span id="textcolor9403"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75060r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8">min</span><span 
class="cmtt-8"> </span><span id="textcolor9410"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9414"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9417"><span 
class="cmtt-8">]</span></span><span id="textcolor9419"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">k</span><span id="textcolor9422"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75061r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75062r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">min</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75063r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75064r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">find</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">second</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">minimum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75065r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">cost</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">having</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">end</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">at</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">i</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75066r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">secondMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span id="textcolor9469"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75067r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8">first</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">second</span><span 
class="cmtt-8"> </span><span id="textcolor9477"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxsize</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxsize</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75068r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">j</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8">)</span><span id="textcolor9495"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75069r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span id="textcolor9503"><span 
class="cmtt-8">=</span></span><span id="textcolor9505"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">j</span><span id="textcolor9509"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75070r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8">continue</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75071r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9520"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9523"><span 
class="cmtt-8">]</span></span><span id="textcolor9525"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor9528"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9531"><span 
class="cmtt-8">&#x003C;</span></span><span id="textcolor9533"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">first</span><span id="textcolor9537"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75072r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8">second</span><span 
class="cmtt-8"> </span><span id="textcolor9544"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">first</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75073r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8">first</span><span 
class="cmtt-8"> </span><span id="textcolor9553"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9557"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9560"><span 
class="cmtt-8">]</span></span><span id="textcolor9562"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor9565"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75074r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75075r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8">elif</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span id="textcolor9572"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9575"><span 
class="cmtt-8">]</span></span><span id="textcolor9577"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor9580"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9583"><span 
class="cmtt-8">&#x003C;</span></span><span id="textcolor9585"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">second</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75076r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8">adj</span><span id="textcolor9595"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9598"><span 
class="cmtt-8">]</span></span><span id="textcolor9600"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor9603"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9606"><span 
class="cmtt-8">!</span></span><span id="textcolor9608"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">first</span><span 
class="cmtt-8">)</span><span id="textcolor9613"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75077r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-8">second</span><span 
class="cmtt-8"> </span><span id="textcolor9620"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9624"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor9627"><span 
class="cmtt-8">]</span></span><span id="textcolor9629"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor9632"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75078r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75079r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">second</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75080r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75081r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">that</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">takes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">as</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">arguments</span><span 
class="cmsltt-10x-x-80">:</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75082r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">-&#x003E;</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lower</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75083r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_weight</span><span 
class="cmsltt-10x-x-80">-&#x003E;</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">so</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">far</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75084r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80">-&#x003E;</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">while</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">moving</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75085r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">space</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tree</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75086r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_path</span><span 
class="cmsltt-10x-x-80">[]</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">-&#x003E;</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">where</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">being</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">stored</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75087r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">which</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">would</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">later</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">be</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">copied</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final_path</span><span 
class="cmsltt-10x-x-80">[]</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75088r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">TSPRec</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75089r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span id="textcolor9767"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75090r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8">global</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final_res</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75091r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75092r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">base</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">case</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">when</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reached</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">N</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75093r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">which</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">means</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">covered</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">once</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75094r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor9819"><span 
class="cmtt-8">=</span></span><span id="textcolor9821"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">N</span><span id="textcolor9825"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75095r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75096r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">check</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">there</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edge</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75097r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">last</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">back</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">first</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75098r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9872"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor9875"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor9879"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor9883"><span 
class="cmtt-8">]</span></span><span id="textcolor9885"><span 
class="cmtt-8">]</span></span><span id="textcolor9887"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor9890"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor9893"><span 
class="cmtt-8">]</span></span><span id="textcolor9895"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor9898"><span 
class="cmtt-8">!</span></span><span id="textcolor9900"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor9904"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75099r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75100r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_res</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">has</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">total</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75101r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">got</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75102r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-8">curr_res</span><span 
class="cmtt-8"> </span><span id="textcolor9942"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8"> </span><span id="textcolor9947"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor9951"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor9954"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor9958"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor9962"><span 
class="cmtt-8">]</span></span><span id="textcolor9964"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">\</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75103r62"></a><span 
class="cmr-5">62</span></span><span id="textcolor9977"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor9980"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor9983"><span 
class="cmtt-8">]</span></span><span id="textcolor9985"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75104r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_res</span><span 
class="cmtt-8"> </span><span id="textcolor9994"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final_res</span><span id="textcolor9998"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75105r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-8">copyToFinal</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75106r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmtt-8">final_res</span><span 
class="cmtt-8"> </span><span id="textcolor10014"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_res</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75107r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75108r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75109r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">any</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">other</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">iterate</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertices</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75110r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">build</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">search</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">space</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tree</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recursively</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75111r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8">)</span><span id="textcolor10066"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75112r71"></a><span 
class="cmr-5">71</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75113r72"></a><span 
class="cmr-5">72</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Consider</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">next</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">if</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">it</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">same</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75114r73"></a><span 
class="cmr-5">73</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">diagonal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">entry</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75115r74"></a><span 
class="cmr-5">74</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">already</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75116r75"></a><span 
class="cmr-5">75</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span id="textcolor10121"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10124"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span id="textcolor10127"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span id="textcolor10130"><span 
class="cmtt-8">]</span></span><span id="textcolor10132"><span 
class="cmtt-8">]</span></span><span id="textcolor10134"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor10137"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10140"><span 
class="cmtt-8">!</span></span><span id="textcolor10142"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75117r76"></a><span 
class="cmr-5">76</span></span><span 
class="cmtt-8">visited</span><span id="textcolor10156"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor10159"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10162"><span 
class="cmtt-8">=</span></span><span id="textcolor10164"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">False</span><span 
class="cmtt-8">)</span><span id="textcolor10169"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75118r77"></a><span 
class="cmr-5">77</span></span><span 
class="cmtt-8">temp</span><span 
class="cmtt-8"> </span><span id="textcolor10176"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75119r78"></a><span 
class="cmr-5">78</span></span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8"> </span><span id="textcolor10185"><span 
class="cmtt-8">+</span></span><span id="textcolor10187"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor10191"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10194"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10198"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor10202"><span 
class="cmtt-8">]</span></span><span id="textcolor10204"><span 
class="cmtt-8">]</span></span><span id="textcolor10206"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor10209"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75120r79"></a><span 
class="cmr-5">79</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75121r80"></a><span 
class="cmr-5">80</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">different</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">computation</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75122r81"></a><span 
class="cmr-5">81</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">2</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">other</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">levels</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75123r82"></a><span 
class="cmr-5">82</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10248"><span 
class="cmtt-8">=</span></span><span id="textcolor10250"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor10254"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75124r83"></a><span 
class="cmr-5">83</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10262"><span 
class="cmtt-8">-</span></span><span id="textcolor10264"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">firstMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span id="textcolor10274"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10278"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor10282"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor10286"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75125r84"></a><span 
class="cmr-5">84</span></span><span 
class="cmtt-8">firstMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor10305"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75126r85"></a><span 
class="cmr-5">85</span></span><span 
class="cmtt-8">else</span><span id="textcolor10314"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75127r86"></a><span 
class="cmr-5">86</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10322"><span 
class="cmtt-8">-</span></span><span id="textcolor10324"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">secondMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span id="textcolor10334"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10338"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor10342"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor10346"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75128r87"></a><span 
class="cmr-5">87</span></span><span 
class="cmtt-8">firstMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor10365"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75129r88"></a><span 
class="cmr-5">88</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75130r89"></a><span 
class="cmr-5">89</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">+</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">actual</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lower</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75131r90"></a><span 
class="cmr-5">90</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">that</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">arrived</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">on</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75132r91"></a><span 
class="cmr-5">91</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">If</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">current</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lower</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">&#x003C;</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final_res</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75133r92"></a><span 
class="cmr-5">92</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">need</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">explore</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">further</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75134r93"></a><span 
class="cmr-5">93</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10453"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8"> </span><span id="textcolor10458"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final_res</span><span id="textcolor10462"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75135r94"></a><span 
class="cmr-5">94</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10469"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span id="textcolor10472"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10475"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75136r95"></a><span 
class="cmr-5">95</span></span><span 
class="cmtt-8">visited</span><span id="textcolor10484"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor10487"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10490"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75137r96"></a><span 
class="cmr-5">96</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75138r97"></a><span 
class="cmr-5">97</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">call</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">TSPRec</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">next</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75139r98"></a><span 
class="cmr-5">98</span></span><span 
class="cmtt-8">TSPRec</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75140r99"></a><span 
class="cmr-5">99</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10536"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75141r100"></a><span 
class="cmr-5">100</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75142r101"></a><span 
class="cmr-5">101</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Else</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">have</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">prune</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">by</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">resetting</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75143r102"></a><span 
class="cmr-5">102</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">changes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75144r103"></a><span 
class="cmr-5">103</span></span><span 
class="cmtt-8">curr_weight</span><span 
class="cmtt-8"> </span><span id="textcolor10590"><span 
class="cmtt-8">-</span></span><span id="textcolor10592"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">adj</span><span id="textcolor10596"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10599"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">level</span><span 
class="cmtt-8"> </span><span id="textcolor10603"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor10607"><span 
class="cmtt-8">]</span></span><span id="textcolor10609"><span 
class="cmtt-8">]</span></span><span id="textcolor10611"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor10614"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75145r104"></a><span 
class="cmr-5">104</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10621"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">temp</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75146r105"></a><span 
class="cmr-5">105</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75147r106"></a><span 
class="cmr-5">106</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Also</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">reset</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">array</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75148r107"></a><span 
class="cmr-5">107</span></span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor10644"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor10647"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">False</span><span id="textcolor10650"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10653"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">len</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75149r108"></a><span 
class="cmr-5">108</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">j</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">)</span><span id="textcolor10673"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75150r109"></a><span 
class="cmr-5">109</span></span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span id="textcolor10682"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor10685"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10688"><span 
class="cmtt-8">!</span></span><span id="textcolor10690"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor10693"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span id="textcolor10696"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75151r110"></a><span 
class="cmr-5">110</span></span><span 
class="cmtt-8">visited</span><span id="textcolor10704"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10707"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">j</span><span id="textcolor10710"><span 
class="cmtt-8">]</span></span><span id="textcolor10712"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10715"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75152r111"></a><span 
class="cmr-5">111</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75153r112"></a><span 
class="cmr-5">112</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">function</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">sets</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">up</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final_path</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75154r113"></a><span 
class="cmr-5">113</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">TSP</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">)</span><span id="textcolor10736"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75155r114"></a><span 
class="cmr-5">114</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75156r115"></a><span 
class="cmr-5">115</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Calculate</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initial</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lower</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">root</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75157r116"></a><span 
class="cmr-5">116</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">formula</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80">/</span><span 
class="cmsltt-10x-x-80">2</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">*</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">sum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">first</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">min</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">+</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75158r117"></a><span 
class="cmr-5">117</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">second</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">min</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">all</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">edges</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Also</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initialize</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75159r118"></a><span 
class="cmr-5">118</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">array</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75160r119"></a><span 
class="cmr-5">119</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10815"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75161r120"></a><span 
class="cmr-5">120</span></span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8"> </span><span id="textcolor10822"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor10825"><span 
class="cmtt-8">[</span></span><span id="textcolor10827"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span id="textcolor10830"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10833"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor10839"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75162r121"></a><span 
class="cmr-5">121</span></span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor10847"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor10850"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">False</span><span id="textcolor10853"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10856"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75163r122"></a><span 
class="cmr-5">122</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75164r123"></a><span 
class="cmr-5">123</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Compute</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initial</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75165r124"></a><span 
class="cmr-5">124</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8">)</span><span id="textcolor10879"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75166r125"></a><span 
class="cmr-5">125</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10885"><span 
class="cmtt-8">+</span></span><span id="textcolor10887"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">firstMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor10899"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75167r126"></a><span 
class="cmr-5">126</span></span><span 
class="cmtt-8">secondMin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75168r127"></a><span 
class="cmr-5">127</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75169r128"></a><span 
class="cmr-5">128</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Rounding</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">off</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">lower</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">bound</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">an</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">integer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75170r129"></a><span 
class="cmr-5">129</span></span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10935"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">math</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ceil</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8"> </span><span id="textcolor10944"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75171r130"></a><span 
class="cmr-5">130</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75172r131"></a><span 
class="cmr-5">131</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">We</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">start</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">at</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">so</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">first</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vertex</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75173r132"></a><span 
class="cmr-5">132</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_path</span><span 
class="cmsltt-10x-x-80">[]</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75174r133"></a><span 
class="cmr-5">133</span></span><span 
class="cmtt-8">visited</span><span id="textcolor10982"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor10985"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor10988"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75175r134"></a><span 
class="cmr-5">134</span></span><span 
class="cmtt-8">curr_path</span><span id="textcolor10994"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor10997"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor11000"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75176r135"></a><span 
class="cmr-5">135</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75177r136"></a><span 
class="cmr-5">136</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Call</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">TSPRec</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">curr_weight</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75178r137"></a><span 
class="cmr-5">137</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">equal</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">0</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">1</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75179r138"></a><span 
class="cmr-5">138</span></span><span 
class="cmtt-8">TSPRec</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_bound</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">curr_path</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75180r139"></a><span 
class="cmr-5">139</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75181r140"></a><span 
class="cmr-5">140</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Driver</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">code</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75182r141"></a><span 
class="cmr-5">141</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75183r142"></a><span 
class="cmr-5">142</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Adjacency</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">given</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">graph</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75184r143"></a><span 
class="cmr-5">143</span></span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8"> </span><span id="textcolor11070"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor11073"><span 
class="cmtt-8">[</span></span><span id="textcolor11075"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">15</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">20</span><span id="textcolor11087"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75185r144"></a><span 
class="cmr-5">144</span></span><span id="textcolor11091"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">35</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">25</span><span id="textcolor11103"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75186r145"></a><span 
class="cmr-5">145</span></span><span id="textcolor11107"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">15</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">35</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">30</span><span id="textcolor11119"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75187r146"></a><span 
class="cmr-5">146</span></span><span id="textcolor11123"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">20</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">25</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">30</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor11135"><span 
class="cmtt-8">]</span></span><span id="textcolor11137"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75188r147"></a><span 
class="cmr-5">147</span></span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor11141"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75189r148"></a><span 
class="cmr-5">148</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75190r149"></a><span 
class="cmr-5">149</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final_path</span><span 
class="cmsltt-10x-x-80">[]</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">solution</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75191r150"></a><span 
class="cmr-5">150</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">i</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80">e</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">//</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">salesman</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75192r151"></a><span 
class="cmr-5">151</span></span><span 
class="cmtt-8">final_path</span><span 
class="cmtt-8"> </span><span id="textcolor11178"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor11181"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">None</span><span id="textcolor11184"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor11187"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor11193"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75193r152"></a><span 
class="cmr-5">152</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75194r153"></a><span 
class="cmr-5">153</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80">[]</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">keeps</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">track</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">already</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75195r154"></a><span 
class="cmr-5">154</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">visited</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">nodes</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">in</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">particular</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">path</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75196r155"></a><span 
class="cmr-5">155</span></span><span 
class="cmtt-8">visited</span><span 
class="cmtt-8"> </span><span id="textcolor11227"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor11230"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">False</span><span id="textcolor11233"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor11236"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75197r156"></a><span 
class="cmr-5">156</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75198r157"></a><span 
class="cmr-5">157</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Stores</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">final</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">minimum</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75199r158"></a><span 
class="cmr-5">158</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">shortest</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tour</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75200r159"></a><span 
class="cmr-5">159</span></span><span 
class="cmtt-8">final_res</span><span 
class="cmtt-8"> </span><span id="textcolor11261"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">maxsize</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75201r160"></a><span 
class="cmr-5">160</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75202r161"></a><span 
class="cmr-5">161</span></span><span 
class="cmtt-8">TSP</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">adj</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75203r162"></a><span 
class="cmr-5">162</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75204r163"></a><span 
class="cmr-5">163</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Minimum</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cost</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">:</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">final_res</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75205r164"></a><span 
class="cmr-5">164</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Path</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Taken</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">:</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span 
class="cmtt-8"> </span><span id="textcolor11296"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75206r165"></a><span 
class="cmr-5">165</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor11313"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span id="textcolor11318"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75207r166"></a><span 
class="cmr-5">166</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">final_path</span><span id="textcolor11324"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor11327"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">end</span><span 
class="cmtt-8"> </span><span id="textcolor11333"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-75210r169"></a><span 
class="cmr-5">169</span></span></pre>
                                                    
                                                    
<!--l. 2453--><p class="noindent" >Output :
                                                    
                                                    
</p>
<pre class="verbatim" id="verbatim-5">
Minimum cost : 80
Path Taken : 0 1 3 2 0</pre>
<!--l. 2457--><p class="nopar" >
     </p><dl class="description"><dt class="description">
     <!--l. 2460--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2460--><p class="noindent" >Time Complexity: The worst case complexity of Branch
     and  Bound  remains  same  as  that  of  the  Brute  Force
     clearly because in worst case, we may never get a chance
     to prune a node. Whereas, in practice it performs very
     well depending on the different instance of the TSP. The
     complexity also depends on the choice of the bounding
     function as they are the ones deciding how many nodes to
     be pruned.
</p>
     </dd></dl>
<!--l. 2474--><p class="noindent" >
                                                    
                                                    
</p>
<div class="columns-2">
<h3 class="likesectionHead"><a 
 id="x1-760001.9.6"></a>Notes</h3>
<!--l. 2477--><p class="noindent" >
</p><!--l. 4--><p class="noindent" ><a 
href="#enmark-1" id="ennote-1"><sup class="textsuperscript"><span 
class="cmr-9">1</span></sup></a><a 
 id="x1-76001x1"></a><span 
class="cmr-8">Maloof,   Mark.   ”Artificial   Intelligence:   An   Introduction,   p.   37”.</span>
<span 
class="cmr-8">georgetown.edu. Archived (PDF) from the original on 25 August 2018.</span>
</p><!--l. 26--><p class="noindent" ><a 
href="#enmark-2" id="ennote-2"><sup class="textsuperscript"><span 
class="cmr-9">2</span></sup></a><a 
 id="x1-76002x2"></a><span 
class="cmr-8">Optimism of early AI: * Herbert Simon quote: Simon 1965, p. 96 quoted</span>
<span 
class="cmr-8">in Crevier 1993, p. 109. Marvin Minsky quote: Minsky 1967, p. 2 quoted</span>
<span 
class="cmr-8">in Crevier 1993, p. 109.</span>
</p><!--l. 61--><p class="noindent" ><a 
href="#enmark-3" id="ennote-3"><sup class="textsuperscript"><span 
class="cmr-9">3</span></sup></a><a 
 id="x1-76003x3"></a><span 
class="cmr-8">Haenlein, Michael; Kaplan, Andreas (2019). “A Brief History of Artificial</span>
<span 
class="cmr-8">Intelligence: On the Past, Present, and Future of Artificial Intelligence”.</span>
<span 
class="cmr-8">California Management Review. 61 (4): 514.</span>
</p><!--l. 92--><p class="noindent" ><a 
href="#enmark-4" id="ennote-4"><sup class="textsuperscript"><span 
class="cmr-9">4</span></sup></a><a 
 id="x1-76004x4"></a><span 
class="cmr-8">Biggs, N.; Lloyd, E.; Wilson, R. (1986), Graph Theory, 1736-1936, Oxford</span>
<span 
class="cmr-8">University Press</span>
</p><!--l. 109--><p class="noindent" ><a 
href="#enmark-5" id="ennote-5"><sup class="textsuperscript"><span 
class="cmr-9">5</span></sup></a><a 
 id="x1-76005x5"></a><span 
class="cmr-8">Tutte, W.T. (2001), Graph Theory, Cambridge University Press, p. 30,</span>
<span 
class="cmr-8">ISBN 978-0-521-79489-3, retrieved 2016-03-14</span>
</p><!--l. 127--><p class="noindent" ><a 
href="#enmark-6" id="ennote-6"><sup class="textsuperscript"><span 
class="cmr-9">6</span></sup></a><a 
 id="x1-76006x6"></a><span 
class="cmr-8">Gardner,     Martin     (1992),     Fractal     Music,     Hypercards,     and</span>
<span 
class="cmr-8">moreMathematical Recreations from Scientific American, W. H. Freeman</span>
<span 
class="cmr-8">and Company, p. 203</span>
</p><!--l. 150--><p class="noindent" ><a 
href="#enmark-7" id="ennote-7"><sup class="textsuperscript"><span 
class="cmr-9">7</span></sup></a><a 
 id="x1-76007x7"></a><span 
class="cmr-8">Even, Shimon (2011), Graph Algorithms (2nd ed.), Cambridge University</span>
<span 
class="cmr-8">Press, pp. 4648, ISBN 978-0-521-73653-4.</span>
</p><!--l. 168--><p class="noindent" ><a 
href="#enmark-8" id="ennote-8"><sup class="textsuperscript"><span 
class="cmr-9">8</span></sup></a><a 
 id="x1-76008x8"></a><span 
class="cmr-8">Sedgewick, Robert (2002), Algorithms in C++: Graph Algorithms (3rd</span>
<span 
class="cmr-8">ed.), Pearson Education, ISBN 978-0-201-36118-6.</span>
</p><!--l. 186--><p class="noindent" ><a 
href="#enmark-9" id="ennote-9"><sup class="textsuperscript"><span 
class="cmr-9">9</span></sup></a><a 
 id="x1-76009x9"></a><span 
class="cmr-8">Cormen, Thomas H., Charles E. Leiserson, and Ronald L. Rivest. p.606</span>
</p><!--l. 201--><p class="noindent" ><a 
href="#enmark-10" id="ennote-10"><sup class="textsuperscript"><span 
class="cmr-9">10</span></sup></a><a 
 id="x1-76010x10"></a><span 
class="cmr-8">Mehlhorn, Kurt; Sanders, Peter (2008). Algorithms and Data Structures:</span>
<span 
class="cmr-8">The Basic Toolbox (PDF). Springer.</span>
</p><!--l. 219--><p class="noindent" ><a 
href="#enmark-11" id="ennote-11"><sup class="textsuperscript"><span 
class="cmr-9">11</span></sup></a><a 
 id="x1-76011x11"></a><span 
class="cmr-8">KORF,    Richard    E.    (1985).    ”Depth-first    iterative    deepening”.</span>
<a 
href="https://cse.sc.edu/~mgv/csce580f09/gradPres/korf_IDAStar_1985.pdf" class="url" ><span 
class="cmtt-8">https://cse.sc.edu/</span><span 
class="cmtt-8">~</span><span 
class="cmtt-8">mgv/csce580f09/gradPres/korf</span></mrow><mrow 
><span 
class="cmr-6">I</span></mrow></msub 
><span 
class="cmtt-8">DAStar</span></mrow><mrow 
><span 
class="cmr-6">1</span></mrow></msub 
><span 
class="cmtt-8">985.pdf</span></a>
</p><!--l. 232--><p class="noindent" ><a 
href="#enmark-12" id="ennote-12"><sup class="textsuperscript"><span 
class="cmr-9">12</span></sup></a><a 
 id="x1-76012x12"></a><span 
class="cmr-8">Russell, Stuart J.; Norvig, Peter (2003), Artificial Intelligence: A Modern</span>
<span 
class="cmr-8">Approach (2nd ed.), Upper Saddle River, New Jersey: Prentice Hall, ISBN</span>
<span 
class="cmr-8">0-13-790395-2</span>
</p><!--l. 258--><p class="noindent" ><a 
href="#enmark-13" id="ennote-13"><sup class="textsuperscript"><span 
class="cmr-9">13</span></sup></a><a 
 id="x1-76013x13"></a><span 
class="cmr-8">Russell, Stuart J. (2018). Artificial intelligence a modern approach. Norvig,</span>
<span 
class="cmr-8">Peter (4th ed.). Boston: Pearson. ISBN 978-0134610993. OCLC 1021874142</span>
</p><!--l. 281--><p class="noindent" ><a 
href="#enmark-14" id="ennote-14"><sup class="textsuperscript"><span 
class="cmr-9">14</span></sup></a><a 
 id="x1-76014x14"></a><span 
class="cmr-8">Hart,  P.  E.;  Nilsson,  N.  J.;  Raphael,  B.  (1968).  ”A  Formal  Basis</span>
<span 
class="cmr-8">for   the   Heuristic   Determination   of   Minimum   Cost   Paths”.   IEEE</span>
<span 
class="cmr-8">Transactions  on  Systems  Science  and  Cybernetics.  4  (2):  100107.</span>
<span 
class="cmr-8">doi:10.1109/TSSC.1968.300136</span>
                                                    
                                                    
</p><!--l. 316--><p class="noindent" ><a 
href="#enmark-15" id="ennote-15"><sup class="textsuperscript"><span 
class="cmr-9">15</span></sup></a><a 
 id="x1-76015x15"></a><span 
class="cmr-8">Hart,  P.  E.;  Nilsson,  N.  J.;  Raphael,  B.  (1968).  ”A  Formal  Basis</span>
<span 
class="cmr-8">for   the   Heuristic   Determination   of   Minimum   Cost   Paths”.   IEEE</span>
<span 
class="cmr-8">Transactions  on  Systems  Science  and  Cybernetics.  4  (2):  100107.</span>
<span 
class="cmr-8">doi:10.1109/TSSC.1968.300136</span>
</p>
</div>
                                                    
                                                    
<h2 class="chapterHead"><span class="titlemark">Chapter 2</span><br /><a 
 id="x1-770002"></a>Learning systems</h2>
<h3 class="sectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-780002.1"></a>Definitions</h3>
<!--l. 2484--><p class="noindent" >The oft quoted and widely accepted formal definition of machine
learning as stated by field pioneer <span 
class="cmti-10">Tom M. Mitchell </span>is:
</p><!--l. 2486--><p class="noindent" >
     </p><blockquote class="quote">
     <!--l. 2487--><p class="noindent" >A computer program is said to learn from experience
     <span 
class="cmti-10">E  </span>with  respect  to  some  class  of  tasks  <span 
class="cmti-10">T  </span>and
     performance measure <span 
class="cmti-10">P </span>if its performance at tasks
     in <span 
class="cmti-10">T</span>, as measured by <span 
class="cmti-10">P</span>, improves with experience
     <span 
class="cmti-10">E</span>.</p></blockquote>
<!--l. 2490--><p class="noindent" >The following is my less formal way to describe machine learning.
Machine learning is a subfield of computer science, but is often also
referred to as predictive analytics, or predictive modeling. Its goal
and usage is to build new and/or leverage existing algorithms to
learn from data, in order to build generalizable models that give
accurate predictions, or to find patterns, particularly with new and
unseen similar data.
</p><!--l. 2492--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1.1   </span> <a 
 id="x1-790002.1.1"></a>What is the learning?</h4>
<!--l. 2494--><p class="noindent" >Learning is the process of acquiring new understanding, knowledge,
behaviors, skills, values, attitudes, and preferences. <sup class="textsuperscript"><a 
href="#ennote-16" id="enmark-16"><span 
class="cmr-9">16</span></a></sup> The ability to
learn is possessed by humans, animals, and some machines; there is
also evidence for some kind of learning in certain plants.<sup class="textsuperscript"><a 
href="#ennote-17" id="enmark-17"><span 
class="cmr-9">17</span></a></sup> Some
learning is immediate, induced by a single event (e.g. being burned
by a hot stove), but much skill and knowledge accumulate
from repeated experiences. The changes induced by learning
often last a lifetime, and it is hard to distinguish learned
material that seems to be ”lost” from that which cannot be
retrieved.<sup class="textsuperscript"><a 
href="#ennote-18" id="enmark-18"><span 
class="cmr-9">18</span></a></sup>
                                                    
                                                    
</p><!--l. 2496--><p class="noindent" >Human learning starts at birth (it might even start before) and
continues until death as a consequence of ongoing interactions between
people and their environment. The nature and processes involved in
learning are studied in many fields, including educational
psychology, neuropsychology, experimental psychology, and
pedagogy. Research in such fields has led to the identification of
various sorts of learning. For example, learning may occur as a
result of habituation, or classical conditioning, operant conditioning
or as a result of more complex activities such as play, seen
only in relatively intelligent animals. Learning may occur
consciously or without conscious awareness. Learning that an
aversive event can’t be avoided nor escaped may result in a
condition called learned helplessness. There is evidence for
human behavioral learning prenatally, in which habituation has
been observed as early as 32 weeks into gestation, indicating
that the central nervous system is sufficiently developed and
primed for learning and memory to occur very early on in
development.<sup class="textsuperscript"><a 
href="#ennote-19" id="enmark-19"><span 
class="cmr-9">19</span></a></sup>
</p><!--l. 2498--><p class="noindent" >Play has been approached by several theorists as a form of
learning. Children experiment with the world, learn the rules,
and learn to interact through play. Lev Vygotsky agrees that
play is pivotal for children’s development, since they make
meaning of their environment through playing educational
games. For Vygotsky, however, play is the first form of learning
language and communication and the stage where a child
begins to understand rules and symbols. This has led to a view
that learning in organisms is always related to semiosis.<sup class="textsuperscript"><a 
href="#ennote-20" id="enmark-20"><span 
class="cmr-9">20</span></a></sup>
<sup class="textsuperscript"><a 
href="#ennote-21" id="enmark-21"><span 
class="cmr-9">21</span></a></sup>
</p><!--l. 2500--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-800002.1.1"></a>Types</h5>
<!--l. 2502--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-80002x1">
     <!--l. 2503--><p class="noindent" ><span 
class="cmti-10">Non-associative learning</span>: Non-associative learning refers
     to  ”a  relatively  permanent  change  in  the  strength  of
                                                    
                                                    
     response to a single stimulus due to repeated exposure to
     that stimulus.” This definition exempt the changes caused
     by sensory adaptation, fatigue, or injury. Non-associative
     learning can be divided into habituation and sensitization.
     </p></li>
<li 
  class="enumerate" id="x1-80004x2">
     <!--l. 2504--><p class="noindent" ><span 
class="cmti-10">Active  learning</span>:Active  learning  occurs  when  a  person
     takes   control   of   his/her   learning   experience.   Since
     understanding information is the key aspect of learning,
     it  is  important  for  learners  to  recognize  what  they
     understand and what they do not. By doing so, they can
     monitor their own mastery of subjects. Active learning
     encourages  learners  to  have  an  internal  dialogue  in
     which  they  verbalize  understandings.  This  and  other
     meta-cognitive strategies can be taught to a child over
     time. Studies within metacognition have proven the value
     in active learning, claiming that the learning is usually at
     a stronger level as a result. In addition, learners have more
     incentive to learn when they have control over not only
     how they learn but also what they learn. Active learning
     is  a  key  characteristic  of  student-centered  learning.
     Conversely,  passive  learning  and  direct  instruction  are
     characteristics of teacher-centered learning (or traditional
     education).
     </p></li>
<li 
  class="enumerate" id="x1-80006x3">
     <!--l. 2505--><p class="noindent" ><span 
class="cmti-10">Associative learning</span>: Associative learning is the process
     by  which  a  person  or  animal  learns  an  association
     between two stimuli or events. In <span 
class="cmti-10">classical conditioning</span>
     a previously neutral stimulus is repeatedly paired with
     a  reflex-eliciting  stimulus  until  eventually  the  neutral
     stimulus  elicits  a  response  on  its  own.  In  <span 
class="cmti-10">operant</span>
     <span 
class="cmti-10">conditioning</span>, a behavior that is reinforced or punished in
     the presence of a stimulus becomes more or less likely to
     occur in the presence of that stimulus.</p></li></ol>
                                                    
                                                    
<!--l. 2508--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.1.2   </span> <a 
 id="x1-810002.1.2"></a>What is a system?</h4>
<!--l. 2510--><p class="noindent" >A system is a group of interacting or interrelated elements
that act according to a set of rules to form a unified whole.
A system, surrounded and influenced by its environment,
is described by its boundaries, structure and purpose and
expressed in its functioning. Systems are the subjects of study of
systems theory. The term ”system” comes from the Latin word
<!--l. 2510--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mi 
>y</mi><mi 
>s</mi><mi 
>t</mi><mi 
>ē</mi><mi 
>m</mi><mi 
>a</mi></math>, in turn
from Greek <!--l. 2510--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mi 
>y</mi><mi 
>s</mi><mi 
>t</mi><mi 
>ē</mi><mi 
>m</mi><mi 
>a</mi></math>:
“whole concept made of several parts or members, system”, literary
“composition”.
</p><!--l. 2512--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-820002.1.2"></a>Concepts</h5>
<!--l. 2514--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-82002x1">
     <!--l. 2515--><p class="noindent" ><span 
class="cmti-10">Environment and boundaries</span>: Systems theory views the
     world  as  a  complex  system  of  interconnected  parts.
     One  scopes  a  system  by  defining  its  boundary;  this
     means choosing which entities are inside the system and
     which are outsidepart of the environment. One can make
     simplified representations (models) of the system in order
     to  understand  it  and  to  predict  or  impact  its  future
     behavior.  These  models  may  define  the  structure  and
     behavior of the system.
     </p></li>
<li 
  class="enumerate" id="x1-82004x2">
     <!--l. 2516--><p class="noindent" ><span 
class="cmti-10">Natural and human-made systems</span>: There are natural and
     human-made  (designed)  systems.  Natural  systems  may
     not have an apparent objective but their behavior can be
                                                    
                                                    
     interpreted as purposeful by an observer. Human-made
     systems are made with variable purposes that are achieved
     by some action performed by or with the system. The
     parts of a system must be related; they must be ”designed
     to work as a coherent entity”   otherwise they would be
     two or more distinct systems.
     </p></li>
<li 
  class="enumerate" id="x1-82006x3">
     <!--l. 2517--><p class="noindent" ><span 
class="cmti-10">Theoretical framework</span>: Most systems are open systems,
     exchanging matter and energy with its surroundings; like
     a car, a coffeemaker, or Earth. A closed system exchanges
     energy,  but  not  matter,  with  its  environment;  like  a
     computer or the project Biosphere 2. An isolated system
     exchanges neither matter nor energy with its environment.
     A theoretical example of such system is the Universe.
     </p></li>
<li 
  class="enumerate" id="x1-82008x4">
     <!--l. 2518--><p class="noindent" ><span 
class="cmti-10">Process and transformation process</span>: An open system can
     also  be  viewed  as  a  bounded  transformation  process,
     that  is,  a  black  box  that  is  a  process  or  collection  of
     processes that transforms inputs into outputs. Inputs are
     consumed; outputs are produced. The concept of input
     and output here is very broad. For example, an output of a
     passenger ship is the movement of people from departure
     to destination.
     </p></li>
<li 
  class="enumerate" id="x1-82010x5">
     <!--l. 2519--><p class="noindent" ><span 
class="cmti-10">System  model</span>:  A  system  comprises  multiple  views.
     Man-made  systems  may  have  such  views  as  concept,
     analysis, design, implementation, deployment, structure,
     behavior, input data, and output data views. A system
     model is required to describe and represent all these views.
     </p></li>
<li 
  class="enumerate" id="x1-82012x6">
                                                    
                                                    
     <!--l. 2520--><p class="noindent" ><span 
class="cmti-10">Systems architecture</span>: A systems architecture, using one
     single  integrated  model  for  the  description  of  multiple
     views, is a kind of system model.</p></li></ol>
<!--l. 2523--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-830002.2"></a>Goals &#x0026; Applications</h3>
<!--l. 2526--><p class="noindent" >Machine learning is a buzzword for today’s technology, and it is
growing very rapidly day by day. We are using machine learning in
our daily life even without knowing it such as Google Maps, Google
assistant, Alexa, etc. Below are some most trending real-world
applications of Machine Learning:
</p><!--l. 2528--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.1   </span> <a 
 id="x1-840002.2.1"></a>Image Recognition</h4>
<!--l. 2530--><p class="noindent" >Image recognition is one of the most common applications of
machine learning. It is used to identify objects, persons, places,
digital images, etc. The popular use case of image recognition
and face detection is, Automatic friend tagging suggestion.
Facebook provides us a feature of auto friend tagging suggestion.
Whenever we upload a photo with our Facebook friends, then we
automatically get a tagging suggestion with name, and the
technology behind this is machine learning’s face detection and
recognition algorithm. It is based on the Facebook project named
”Deep Face,” which is responsible for face recognition and person
identification in the picture.
</p><!--l. 2532--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.2   </span> <a 
 id="x1-850002.2.2"></a>Speech Recognition</h4>
<!--l. 2534--><p class="noindent" >While using Google, we get an option of ”Search by voice,” it comes
under speech recognition, and it’s a popular application of machine
                                                    
                                                    
learning. Speech recognition is a process of converting voice
instructions into text, and it is also known as ”Speech to
text”, or ”Computer speech recognition.” At present, machine
learning algorithms are widely used by various applications of
speech recognition. Google assistant, Siri, Cortana, and Alexa
are using speech recognition technology to follow the voice
instructions.
</p><!--l. 2536--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.3   </span> <a 
 id="x1-860002.2.3"></a>Traffic prediction</h4>
<!--l. 2538--><p class="noindent" >If we want to visit a new place, we take help of Google Maps, which
shows us the correct path with the shortest route and predicts the
traffic conditions. It predicts the traffic conditions such as whether
traffic is cleared, slow-moving, or heavily congested with the help of
two ways:
</p><!--l. 2540--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-86002x1">
     <!--l. 2541--><p class="noindent" >Real Time location of the vehicle form Google Map app
     and sensors
     </p></li>
<li 
  class="enumerate" id="x1-86004x2">
     <!--l. 2542--><p class="noindent" >Average time has taken on past days at the same time.</p></li></ol>
<!--l. 2545--><p class="noindent" >Everyone who is using Google Map is helping this app to make it
better. It takes information from the user and sends back to its
database to improve the performance.
</p><!--l. 2547--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.4   </span> <a 
 id="x1-870002.2.4"></a>Product recommendations</h4>
                                                    
                                                    
<!--l. 2549--><p class="noindent" >Machine learning is widely used by various e-commerce and
entertainment companies such as Amazon, Netflix, etc., for product
recommendation to the user. Whenever we search for some product
on Amazon, then we started getting an advertisement for the same
product while internet surfing on the same browser and this is
because of machine learning. Google understands the user interest
using various machine learning algorithms and suggests the
product as per customer interest. As similar, when we use
Netflix, we find some recommendations for entertainment series,
movies, etc., and this is also done with the help of machine
learning.
</p><!--l. 2551--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.5   </span> <a 
 id="x1-880002.2.5"></a>Self-driving cars</h4>
<!--l. 2553--><p class="noindent" >One of the most exciting applications of machine learning is
self-driving cars. Machine learning plays a significant role in
self-driving cars. Tesla, the most popular car manufacturing
company is working on self-driving car. It is using unsupervised
learning method to train the car models to detect people and
objects while driving.
</p><!--l. 2555--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.6   </span> <a 
 id="x1-890002.2.6"></a>Email Spam and Malware Filtering</h4>
<!--l. 2557--><p class="noindent" >Whenever we receive a new email, it is filtered automatically as
important, normal, and spam. We always receive an important mail
in our inbox with the important symbol and spam emails in our
spam box, and the technology behind this is Machine learning.
Below are some spam filters used by Gmail:
</p><!--l. 2559--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-89002x1">
     <!--l. 2560--><p class="noindent" >Content Filter
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-89004x2">
     <!--l. 2561--><p class="noindent" >Header filter
     </p></li>
<li 
  class="enumerate" id="x1-89006x3">
     <!--l. 2562--><p class="noindent" >General blacklists filter
     </p></li>
<li 
  class="enumerate" id="x1-89008x4">
     <!--l. 2563--><p class="noindent" >Rules-based filters
     </p></li>
<li 
  class="enumerate" id="x1-89010x5">
     <!--l. 2564--><p class="noindent" >Permission filters</p></li></ol>
<!--l. 2567--><p class="noindent" >Some machine learning algorithms such as Multi-Layer Perceptron,
Decision tree, and Na Bayes classifier are used for email spam
filtering and malware detection.
</p><!--l. 2569--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.7   </span> <a 
 id="x1-900002.2.7"></a>Virtual Personal Assistant</h4>
<!--l. 2571--><p class="noindent" >We have various virtual personal assistants such as Google
assistant, Alexa, Cortana, Siri. As the name suggests, they help us
in finding the information using our voice instruction. These
assistants can help us in various ways just by our voice instructions
such as Play music, call someone, Open an email, Scheduling an
appointment, etc.
</p><!--l. 2573--><p class="noindent" >These virtual assistants use machine learning algorithms as an
important part. These assistant record our voice instructions, send
it over the server on a cloud, and decode it using ML algorithms
and act accordingly.
                                                    
                                                    
</p><!--l. 2575--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.8   </span> <a 
 id="x1-910002.2.8"></a>Online Fraud Detection</h4>
<!--l. 2577--><p class="noindent" >Machine learning is making our online transaction safe and secure
by detecting fraud transaction. Whenever we perform some online
transaction, there may be various ways that a fraudulent
transaction can take place such as fake accounts, fake ids, and steal
money in the middle of a transaction. So to detect this, Feed
Forward Neural network helps us by checking whether it is a
genuine transaction or a fraud transaction.
</p><!--l. 2579--><p class="noindent" >For each genuine transaction, the output is converted into some
hash values, and these values become the input for the next round.
For each genuine transaction, there is a specific pattern which gets
change for the fraud transaction hence, it detects it and makes our
online transactions more secure.
</p><!--l. 2581--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.9   </span> <a 
 id="x1-920002.2.9"></a>Stock Market trading</h4>
<!--l. 2583--><p class="noindent" >Machine learning is widely used in stock market trading. In
the stock market, there is always a risk of up and downs in
shares, so for this machine learning’s long short term memory
neural network is used for the prediction of stock market
trends.
</p><!--l. 2585--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.10   </span> <a 
 id="x1-930002.2.10"></a>Medical Diagnosis</h4>
<!--l. 2587--><p class="noindent" >In medical science, machine learning is used for diseases diagnoses.
With this, medical technology is growing very fast and able to build
3D models that can predict the exact position of lesions in the
brain. It helps in finding brain tumors and other brain-related
diseases easily.
                                                    
                                                    
</p><!--l. 2589--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.2.11   </span> <a 
 id="x1-940002.2.11"></a>Automatic Language Translation</h4>
<!--l. 2591--><p class="noindent" >Nowadays, if we visit a new place and we are not aware of the
language then it is not a problem at all, as for this also machine
learning helps us by converting the text into our known languages.
Google’s GNMT (Google Neural Machine Translation) provide this
feature, which is a Neural Machine Learning that translates the
text into our familiar language, and it called as automatic
translation.
</p><!--l. 2593--><p class="noindent" >The technology behind the automatic translation is a sequence
to sequence learning algorithm, which is used with image
recognition and translates the text from one language to another
language.
</p><!--l. 2596--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-950002.3"></a>Characteristics</h3>
<!--l. 2598--><p class="noindent" >There are a lot of things to consider while building a great machine
learning system. But often it happens that we as data scientists
only worry about certain parts of the project. Most of the time that
happens to be modelling, but in reality, the success or failure of a
Machine Learning project depends on a lot of other factors.
It is essential to understand what happens before training
a model and after training the model and deploying it in
production.
</p><!--l. 2600--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.1   </span> <a 
 id="x1-960002.3.1"></a>Problem Definition</h4>
<!--l. 2601--><p class="noindent" >There are two types of problems; <span 
class="cmti-10">simple </span>and <span 
class="cmti-10">complex</span>. Simple
problems are either small or does not require much effort, but
complex problems are those problems which needs systematic
approach. The approach which is followed in ML is that each
                                                    
                                                    
problem is factors for Task, Performance, Experience (TPE). In
every ML problem the data is essential for performing task and also
required for experience from database.
</p><!--l. 2603--><p class="noindent" >How to define a problem for Machine learning? That depends on a
lot of factors. Amongst all the elements that we consider, the first
one should be to understand how it will benefit the business. That
is the holy grail of any data science project. If the project does not
help business, the applicability of the same will be in question.
Once after getting an idea and determining business compatibility,
success metric needs to be defined. What does success look like? Is
it 90% accuracy or 95% accuracy or 99% accuracy? The question is
acceptability. 70% of prediction accuracy may be acceptable since
an average human won’t surpass that accuracy ever. At the same
time also beware of lofty targets; it is the time to be logical and
sensible about how every 1 percent accuracy change could affect
success. For example, for a click prediction problem/Fraud
application, a 1% accuracy increase will boost the business bottom
line compared to a 1% accuracy increase in review sentiment
prediction.
</p><!--l. 2605--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.2   </span> <a 
 id="x1-970002.3.2"></a>Data</h4>
<!--l. 2607--><p class="noindent" >There are several questions which needs to be answered at the time
of data acquisition and data creation machine learning model.
The most important question that needs to be answered is
perhaps; does the model need to work with real-time? This
type of questions determine type of the tools or techniques
that are necessary. Suppose that the data is real-time then
strategies for streaming such data sets so as to minimize latency
and accuracy will be at most priority. The most interesting
use-case can be click prediction systems. These systems need
to evaluate user clicks instantaneously and determine the
appropriate place for placing the ad. This must happen so
dynamically with very precise training algorithms. If the algorithm
chosen for such tasks are imprecise that might leads to loss of
revenue.
                                                    
                                                    
</p><!--l. 2609--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.3   </span> <a 
 id="x1-980002.3.3"></a>Evaluation</h4>
<!--l. 2611--><p class="noindent" >How will we evaluate the performance of our Model? The gold
standard here is the train-test-validation split. Frequently making a
train-validation-test set, by sampling, we forgot about an implicit
assumption  Data is rarely ever IID(independently and identically
distributed). In simple terms, our assumption that each data point
is independent of each other and comes from the same distribution
is faulty at best if not downright incorrect. For an internet
company, a data point from 2007 is very different from a data
point that comes in 2019. They dont come from the same
distribution because of a lot of factors- internet speed being
the foremost. If you have a cat vs. dog prediction problem,
you are pretty much good with Random sampling. But, in
most of the machine learning models, the task is to predict
the future. You can think about splitting your data using
the time variable rather than sampling randomly from the
data. For example: for the click prediction problem you can
have all your past data till last month as training data and
data for last month as validation. The next thing you will
need to think about is the baseline model. Let us say we use
RMSE as an evaluation metric for our time series models. We
evaluated the model on the test set, and the RMSE came
out to be 4.8. Is that a good RMSE? How do we know? We
need a baseline RMSE. This could come from a currently
employed model for the same task. Or by using some simple
model. For Time series model, a baseline to defeat is last
day prediction. i.e., predict the number on the previous day.
For NLP classification models, I usually set the baseline to
be the evaluation metric(Accuracy, F1, log loss) of Logistic
regression models on <span 
class="cmti-10">Countvectorizer(Bag of words)</span>. You
should also think about how you will be breaking evaluation in
multiple groups so that your model doesn’t induce unnecessary
biases.
</p><!--l. 2616--><p class="noindent" >Last year, Amazon was in the news for a secret AI recruiting tool
that showed bias against women. To save our Machine Learning
model from such inconsistencies, we need to evaluate our model on
different groups. Maybe our model is not so accurate for women as
it is for men because there is far less number of women in training
                                                    
                                                    
data. Or maybe a model predicting if a product is going to be
bought or not given a view works pretty well for a specific
product category and not for other product categories. Keeping
such things in mind beforehand and thinking precisely about
what could go wrong with a particular evaluation approach is
something that could definitely help us in designing a good ML
system.
</p><!--l. 2619--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.4   </span> <a 
 id="x1-990002.3.4"></a>Features</h4>
<!--l. 2621--><p class="noindent" >Good Features are the backbone of any machine learning model.
And often the part where you would spend the most time. I have
seen that this is the part which you can tune for maximum model
performance. Good feature creation often needs domain knowledge,
creativity, and lots of time. On top of that, the feature creation
exercise might change for different models. For example, feature
creation is very different for Neural networks vs. XGboost.
Understanding various methods for Feature creation is a pretty big
topic in itself.
</p><!--l. 2624--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.5   </span> <a 
 id="x1-1000002.3.5"></a>Modeling</h4>
<!--l. 2626--><p class="noindent" >Now comes the part we mostly tend to care about. And why not? It
is the piece that we end up delivering at the end of the project. And
this is the part for which we have spent all those hours on data
acquisition and cleaning, feature creation and whatnot. So what do
we need to think while creating a model? The first question that
you may need to ask ourselves is that if your model needs to be
interpretable? There are quite a lot of use cases where the business
may want an interpretable model. One such use case is when we
want to do attribution modeling. Here we define the effect of
various advertising streams(TV, radio, newspaper, etc.) on the
revenue. In such cases, understanding the response from each
advertisement stream becomes essential. If we need to maximize
                                                    
                                                    
the accuracy or any other metric, we will still want to go for
black-box models like NeuralNets or XGBoost. Apart from
model selection, there should be other things on your mind
too:
</p><!--l. 2628--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-100002x1">
     <!--l. 2629--><p class="noindent" ><span 
class="cmti-10">Model Architecture</span>: How many layers for NNs, or how
     many trees for GBT or how you need to create feature
     interactions for Linear models.
     </p></li>
<li 
  class="enumerate" id="x1-100004x2">
     <!--l. 2630--><p class="noindent" ><span 
class="cmti-10">How  to  tune  hyperparameters?</span>:  You  should  try  to
     automate this part. There are a lot of tools in the market
     for this. I tend to use hyperopt.
</p>
     </li></ol>
<!--l. 2634--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.3.6   </span> <a 
 id="x1-1010002.3.6"></a>Experimentation</h4>
<!--l. 2636--><p class="noindent" >Now you have created your model. It performs better than the
baseline/your current model. How should we go forward? We have
two choices:
</p><!--l. 2639--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-101002x1">
     <!--l. 2640--><p class="noindent" >Go into an endless loop in improving our model further.
     </p></li>
<li 
  class="enumerate" id="x1-101004x2">
                                                    
                                                    
     <!--l. 2641--><p class="noindent" >Test our model in production settings, get more insights
     about what could go wrong and then continue improving
     our model with continuous integration.</p></li></ol>
<!--l. 2644--><p class="noindent" >One thing I would also like to stress is continuous integration. If
your current model performs better than the existing model, why
not deploy it in production rather than running after incremental
gains? To test the validity of your assumption that your model
being better than the existing model, you can set up an A/B test.
Some users(Test group)see your model while some users(Control)
see the predictions from the previous model. You should always aim
to minimize the time to first online experiment for your model. This
not only generated value but also lets you understand the
shortcomings of your model with realtime feedback which you can
then work on.
</p><!--l. 2646--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-1020002.4"></a>Design</h3>
<!--l. 2648--><p class="noindent" >There is definition for learning systems in section <a 
href="#x1-780002.1">2.1<!--tex4ht:ref: lsdef --></a>. Now we
shall see as how to design a learning system based on that
definition. Let’s take a few examples to understand these
factors.
</p><!--l. 2650--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4.1   </span> <a 
 id="x1-1030002.4.1"></a>Handwriting recognition learning problem</h4>
<!--l. 2652--><p class="noindent" >For handwriting recognition learning problem, T (Task), P
(Performance Measure), and E (Training Experience) i.e., TPE
would be,
     </p><dl class="description"><dt class="description">
     <!--l. 2655--><p class="noindent" >
 </p></dt><dd 
class="description">
                                                    
                                                    
     <!--l. 2655--><p class="noindent" ><span 
class="cmti-10">Task  T</span>:  To  recognize  and  classify  handwritten  words
     within the given images.
     </p></dd><dt class="description">
     <!--l. 2656--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2656--><p class="noindent" ><span 
class="cmti-10">Performance measure P</span>:  Total  percent  of  words  being
     correctly classified by the program.
     </p></dd><dt class="description">
     <!--l. 2657--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2657--><p class="noindent" ><span 
class="cmti-10">Training experience E</span>: A set of handwritten words with
     given classifications/labels.</p></dd></dl>
<!--l. 2660--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4.2   </span> <a 
 id="x1-1040002.4.2"></a>Spam Mail detection learning problem</h4>
<!--l. 2662--><p class="noindent" >For a system being designed to detect spam emails, TPE would
be,
     </p><dl class="description"><dt class="description">
     <!--l. 2665--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2665--><p class="noindent" >Task T: To recognize and classify mails into ’spam’ or ’not
     spam’.
     </p></dd><dt class="description">
     <!--l. 2666--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2666--><p class="noindent" >Performance  measure  P:  Total  percent  of  mails  being
     correctly  classified  as  ’spam’  (or  ’not  spam’  )  by  the
     program.
     </p></dd><dt class="description">
                                                    
                                                    
     <!--l. 2667--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2667--><p class="noindent" >Training experience E: A set of mails with given labels
     (’spam’ / ’not spam’).</p></dd></dl>
<!--l. 2670--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4.3   </span> <a 
 id="x1-1050002.4.3"></a>Checkers learning problem</h4>
<!--l. 2672--><p class="noindent" >For a checkers learning problem, TPE would be,
     </p><dl class="description"><dt class="description">
     <!--l. 2675--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2675--><p class="noindent" >Task T: To play checkers
     </p></dd><dt class="description">
     <!--l. 2676--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2676--><p class="noindent" >Performance measure P: Total percent of the game won
     in the tournament.
     </p></dd><dt class="description">
     <!--l. 2677--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2677--><p class="noindent" >Training experience E: A set of games played against itself</p></dd></dl>
<!--l. 2680--><p class="noindent" >If we are able to find the factors T, P, and E of a learning
problem, we will be able to decide the following three key
components:
</p><!--l. 2682--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-105002x1">
     <!--l. 2683--><p class="noindent" >The exact type of knowledge to be learned (Choosing the
     Target Function)
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-105004x2">
     <!--l. 2684--><p class="noindent" >A representation for this target knowledge (Choosing a
     representation for the Target Function)
     </p></li>
<li 
  class="enumerate" id="x1-105006x3">
     <!--l. 2685--><p class="noindent" >A  learning  mechanism  (Choosing  an  approximation
     algorithm for the Target Function)</p></li></ol>
<!--l. 2688--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.4.4   </span> <a 
 id="x1-1060002.4.4"></a>Choosing and representing Target Function</h4>
<!--l. 2690--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1070002.4.4"></a>Choosing</h5>
<!--l. 2692--><p class="noindent" >Let’s take the example of a checkers-playing program that can
generate the legal moves (M) from any board state (B). The
program needs only to learn how to choose the best move from
among these legal moves. Let’s assume a function <span 
class="cmti-10">NextMove </span>such
that:
</p><!--l. 2694--><p class="noindent" >
     </p><blockquote class="quote">
     <!--l. 2695--><p class="noindent" >NextMove: B -<!--l. 2695--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003E;</mo></math>
     M</p></blockquote>
<!--l. 2698--><p class="noindent" >Here, <span 
class="cmti-10">B </span>denotes the set of board states and <span 
class="cmti-10">M </span>denotes the set
of legal moves given a board state. <span 
class="cmti-10">NextMove </span>is our target
function.
                                                    
                                                    
</p><!--l. 2700--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1080002.4.4"></a>Representation</h5>
<!--l. 2702--><p class="noindent" >We need to choose a representation that the learning algorithm will
use to describe the function <span 
class="cmti-10">NextMove</span>. The function <span 
class="cmti-10">NextMove </span>will
be calculated as a linear combination of the following board
features:
     </p><dl class="description"><dt class="description">
     <!--l. 2705--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2705--><p class="noindent" ><span 
class="cmti-10">xl</span>: the number of black pieces on the board
     </p></dd><dt class="description">
     <!--l. 2706--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2706--><p class="noindent" ><span 
class="cmti-10">x2</span>: the number of red pieces on the board
     </p></dd><dt class="description">
     <!--l. 2707--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2707--><p class="noindent" ><span 
class="cmti-10">x3</span>: the number of black kings on the board
     </p></dd><dt class="description">
     <!--l. 2708--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2708--><p class="noindent" ><span 
class="cmti-10">x4</span>: the number of red kings on the board
     </p></dd><dt class="description">
     <!--l. 2709--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2709--><p class="noindent" ><span 
class="cmti-10">x5</span>: the number of black pieces threatened by red (i.e.,
     which can be captured on red’s next turn)
     </p></dd><dt class="description">
     <!--l. 2710--><p class="noindent" >
 </p></dt><dd 
class="description">
                                                    
                                                    
     <!--l. 2710--><p class="noindent" ><span 
class="cmti-10">x6</span>: the number of red pieces threatened by black</p></dd></dl>
<!--l. 2713--><p class="noindent" >The target function for the above features is as follows.
</p><!--l. 2715--><p class="noindent" >
     </p><blockquote class="quote">
     <!--l. 2716--><p class="noindent" >NextMove = u0 + u1x1 + u2x2 + u3x3 + u4x4 +
     u5x5 + u6x6</p></blockquote>
<!--l. 2719--><p class="noindent" >Here <span 
class="cmti-10">u0, u1 </span>up to <span 
class="cmti-10">u6 </span>are the coefficients that will be chosen(learned)
by the learning algorithm.
</p><!--l. 2721--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1090002.4.4"></a>Choose a Function Approximation Algorithm</h5>
<!--l. 2723--><p class="noindent" >To learn the target function <span 
class="cmti-10">NextMove</span>, we require a set of training
examples, each describing a specific board state <span 
class="cmti-10">b </span>and the
training value (Correct Move) <span 
class="cmti-10">y </span>for <span 
class="cmti-10">b</span>. The training algorithm
learns/approximate the coefficients <span 
class="cmti-10">u0, u1 </span>up to <span 
class="cmti-10">u6 </span>with the help of
these training examples by estimating and adjusting these
weights.
</p><!--l. 2726--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-1100002.5"></a>Develop</h3>
<!--l. 2728--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.5.1   </span> <a 
 id="x1-1110002.5.1"></a>Training data</h4>
<!--l. 2730--><p class="noindent" >In machine learning, a common task is the study and construction
of algorithms that can learn from and make predictions on data. <sup class="textsuperscript"><a 
href="#ennote-22" id="enmark-22"><span 
class="cmr-9">22</span></a></sup>
Such algorithms function by making data-driven predictions or
decisions, through building a mathematical model from input
                                                    
                                                    
data. The data used to build the final model usually or may
comes from multiple datasets. In particular, three datasets
are commonly used in different stages of the creation of the
model.
</p><!--l. 2732--><p class="noindent" >The model is initially fit on a <span 
class="cmti-10">training dataset</span>, which is a set of
examples used to fit the parameters (e.g. weights of connections
between neurons in artificial neural networks) of the model. <sup class="textsuperscript"><a 
href="#ennote-23" id="enmark-23"><span 
class="cmr-9">23</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-24" id="enmark-24"><span 
class="cmr-9">24</span></a></sup>
The model (e.g. a neural net or a naive Bayes classifier) is
trained on the training dataset using a supervised learning
method, for example using optimization methods such as
gradient descent or stochastic gradient descent. In practice, the
training dataset often consists of pairs of an input vector
(or scalar) and the corresponding output vector (or scalar),
where the answer key is commonly denoted as the target (or
label). The current model is run with the training dataset and
produces a result, which is then compared with the target,
for each input vector in the training dataset. Based on the
result of the comparison and the specific learning algorithm
being used, the parameters of the model are adjusted. The
model fitting can include both variable selection and parameter
estimation.
</p><!--l. 2734--><p class="noindent" >Successively, the fitted model is used to predict the responses for
the observations in a second dataset called the <span 
class="cmti-10">validation dataset</span>.
<sup class="textsuperscript"><a 
href="#ennote-25" id="enmark-25"><span 
class="cmr-9">25</span></a></sup> The validation dataset provides an unbiased evaluation of a
model fit on the training dataset while tuning the model’s
hyperparameters (e.g. the number of hidden unitslayers and layer
widthsin a neural network). <sup class="textsuperscript"><a 
href="#ennote-26" id="enmark-26"><span 
class="cmr-9">26</span></a></sup> Validation datasets can be
used for regularization by early stopping (stopping training
when the error on the validation dataset increases, as this is a
sign of overfitting to the training dataset). <sup class="textsuperscript"><a 
href="#ennote-27" id="enmark-27"><span 
class="cmr-9">27</span></a></sup> This simple
procedure is complicated in practice by the fact that the validation
dataset’s error may fluctuate during training, <span 
class="cmti-10">producing multiple</span>
<span 
class="cmti-10">local minima</span>. This complication has led to the creation of
many ad-hoc rules for deciding when overfitting has truly
begun.
</p><!--l. 2736--><p class="noindent" >Finally, the test dataset is a dataset used to provide an unbiased
evaluation of a final model fit on the training dataset. <sup class="textsuperscript"><a 
href="#ennote-28" id="enmark-28"><span 
class="cmr-9">28</span></a></sup> If the data
in the test dataset has never been used in training (for example in
cross-validation), the test dataset is also called a <span 
class="cmti-10">holdout dataset</span>.
The term ”validation set” is sometimes used instead of ”test set” in
                                                    
                                                    
some literature (e.g., if the original dataset was partitioned into
only two subsets, the test set might be referred to as the validation
set).
</p><!--l. 2738--><p class="noindent" >A training dataset is a dataset of examples used during the learning
process and is used to fit the parameters (e.g., weights) of, for
example, a classifier. For classification tasks, a supervised learning
algorithm looks at the training dataset to determine, or learn, the
optimal combinations of variables that will generate a good
predictive model. The goal is to produce a trained (fitted) model
that generalizes well to new, unknown data. The fitted model is
evaluated using new examples from the held-out datasets
(validation and test datasets) to estimate the models accuracy
in classifying new data. To reduce the risk of issues such as
overfitting, the examples in the validation and test datasets
should not be used to train the model. Most approaches that
search through training data for empirical relationships tend to
overfit the data, meaning that they can identify and exploit
apparent relationships in the training data that do not hold in
general.
</p><!--l. 2740--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1120002.5.1"></a>Python practice</h5>
<!--l. 2742--><p class="noindent" >The foremost step in training data is train-test split. The Python
package or library <span 
class="cmti-10">sklearn </span>provides a method <span 
class="cmtt-10">train</span><span 
class="cmtt-10">_test</span><span 
class="cmtt-10">_split</span>
provides a way to perform this step. This method split arrays or
matrices into random train and test subsets.
</p>
<!--l. 2744--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor11340"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor11350"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">model_selection</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor11362"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor11370"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">arange</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">reshape</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor11394"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor11400"><span 
class="cmtt-8">[</span></span><span id="textcolor11402"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor11408"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11411"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span id="textcolor11417"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11420"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span id="textcolor11426"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11429"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span id="textcolor11435"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11438"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">9</span><span id="textcolor11444"><span 
class="cmtt-8">]</span></span><span id="textcolor11446"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112010r10"></a><span 
class="cmr-5">10</span></span><span id="textcolor11449"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">list</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112011r11"></a><span 
class="cmr-5">11</span></span><span id="textcolor11456"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor11471"><span 
class="cmtt-8">]</span></span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112012r12"></a><span 
class="cmr-5">12</span></span></pre>
<!--l. 2757--><p class="noindent" >The above code snippet is related to simulation of data sets. The
Python package <span 
class="cmtt-10">numpy </span>is a best library for this task. It is
possible to simulate a bivariate array with the help of the
method <span 
class="cmtt-10">arange </span>with other method <span 
class="cmtt-10">reshape</span>. The function
<span 
class="cmtt-10">range(5) </span>just hands over a number series starting from zero to
4.
</p>
<!--l. 2759--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112013r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor11473"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">shuffle</span><span id="textcolor11482"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">False</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112014r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor11486"><span 
class="cmtt-8">[</span></span><span id="textcolor11488"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor11497"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor11501"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor11507"><span 
class="cmtt-8">]</span></span><span id="textcolor11509"><span 
class="cmtt-8">]</span></span>
                                                    
                                                    
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112015r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 2764--><p class="noindent" >The function <span 
class="cmtt-10">train</span><span 
class="cmtt-10">_test</span><span 
class="cmtt-10">_split() </span>function splits the data into two
different sets. The set with maximum rows can be considered
for training and the other for testing. It is also possible to
split the data using proportions with the help of argument
<span 
class="cmtt-10">test</span><span 
class="cmtt-10">_size</span>.
</p>
<!--l. 2766--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112016r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor11511"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><span id="textcolor11525"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112017r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">test_size</span><span id="textcolor11540"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">33</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor11548"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">42</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112018r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112019r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor11553"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112020r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor11559"><span 
class="cmtt-8">[</span></span><span id="textcolor11561"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span id="textcolor11567"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112021r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11570"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor11576"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112022r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11579"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">7</span><span id="textcolor11585"><span 
class="cmtt-8">]</span></span><span id="textcolor11587"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112023r8"></a><span 
class="cmr-5">8</span></span><span id="textcolor11590"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112024r9"></a><span 
class="cmr-5">9</span></span><span id="textcolor11594"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span id="textcolor11603"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112025r10"></a><span 
class="cmr-5">10</span></span><span id="textcolor11605"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112026r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor11611"><span 
class="cmtt-8">[</span></span><span id="textcolor11613"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span id="textcolor11619"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112027r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor11622"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">9</span><span id="textcolor11628"><span 
class="cmtt-8">]</span></span><span id="textcolor11630"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112028r13"></a><span 
class="cmr-5">13</span></span><span id="textcolor11633"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112029r14"></a><span 
class="cmr-5">14</span></span><span id="textcolor11637"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor11643"><span 
class="cmtt-8">]</span></span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-112030r15"></a><span 
class="cmr-5">15</span></span></pre>
<!--l. 2783--><p class="noindent" >Rest of the concepts such as training, models/functions, algorithms,
parameters will be handled in forthcoming chapters.
</p><!--l. 2785--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.5.2   </span> <a 
 id="x1-1130002.5.2"></a>Validation dataset</h4>
<!--l. 2787--><p class="noindent" >A validation dataset is a dataset of examples used to tune the
hyperparameters (i.e. the architecture) of a classifier. It is
sometimes also called the <span 
class="cmti-10">development set </span>or the <span 
class="cmti-10">”dev set”</span>. An
example of a hyperparameter for artificial neural networks includes
the number of hidden units in each layer. It, as well as the testing
set (as mentioned above), should follow the same probability
distribution as the training dataset.
</p><!--l. 2789--><p class="noindent" >In order to avoid overfitting, when any classification parameter
needs to be adjusted, it is necessary to have a validation dataset in
addition to the training and test datasets. For example, if the
most suitable classifier for the problem is sought, the training
dataset is used to train the different candidate classifiers, the
validation dataset is used to compare their performances and
decide which one to take and, finally, the test dataset is used
to obtain the performance characteristics such as <span 
class="cmti-10">accuracy,</span>
<span 
class="cmti-10">sensitivity, specificity, F-measure</span>, and so on. The validation dataset
functions as a hybrid: it is training data used for testing, but
neither as part of the low-level training nor as part of the final
testing. The basic aim of using a validation dataset is <span 
class="cmti-10">model</span>
<span 
class="cmti-10">selection</span>.
                                                    
                                                    
</p><!--l. 2791--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1140002.5.2"></a>Python practice</h5>
<!--l. 2793--><p class="noindent" >Testing set is very critical for validating models. That is why it is
referred to <span 
class="cmti-10">validation set</span>. We validate models using accuracy
metrics. Few of the metrics are <span 
class="cmti-10">sensitivity, specificity, precision, F1</span>
score and <span 
class="cmti-10">accuracy </span>as a measure in itself.
</p><!--l. 2795--><p class="noindent" >Example of confusion matrix usage to evaluate the quality of the
output of a classifier on the iris data set. The diagonal elements
represent the number of points for which the predicted label is
equal to the true label, while off-diagonal elements are those that
are mislabeled by the classifier. <span 
class="cmti-10">The higher the diagonal values</span>
<span 
class="cmti-10">of the confusion matrix the better, indicating many correct</span>
<span 
class="cmti-10">predictions</span>.
</p><!--l. 2797--><p class="noindent" >The figures show the confusion matrix with and without
normalization by class support size (number of elements in
each class). This kind of normalization can be interesting in
case of class imbalance to have a more visual interpretation
of which class is being misclassified. Following code snippet
describes as how to load required packages and load required data
set.
</p>
<!--l. 2799--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">model_selection</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">metrics</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plot_confusion_matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">import</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">some</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">play</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">with</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8"> </span><span id="textcolor11704"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor11713"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">data</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor11721"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">target</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8">class_names</span><span 
class="cmtt-8"> </span><span id="textcolor11729"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">target_names</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114014r14"></a><span 
class="cmr-5">14</span></span></pre>
<!--l. 2815--><p class="noindent" >Now its time to <span 
class="cmti-10">train </span>the data and make the classifier.
</p>
<!--l. 2817--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114015r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Split</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">into</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">training</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">set</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">test</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">set</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114016r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><span id="textcolor11769"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor11781"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114017r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114018r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Run</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">classifier</span><span 
class="cmsltt-10x-x-80">,</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">model</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">that</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">too</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">regularized</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">(</span><span 
class="cmsltt-10x-x-80">C</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">too</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">low</span><span 
class="cmsltt-10x-x-80">)</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">see</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114019r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">impact</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">on</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">results</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114020r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">classifier</span><span 
class="cmtt-8"> </span><span id="textcolor11830"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">SVC</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">kernel</span><span id="textcolor11838"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">linear</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">C</span><span id="textcolor11846"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">01</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114021r7"></a><span 
class="cmr-5">7</span></span></pre>
<!--l. 2826--><p class="noindent" >We can print or plot confusion matrix with the following
snippet.
</p>
<!--l. 2828--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114022r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">set_printoptions</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">precision</span><span id="textcolor11865"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114023r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114024r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Plot</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">non</span><span 
class="cmsltt-10x-x-80">-</span><span 
class="cmsltt-10x-x-80">normalized</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">confusion</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114025r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">titles_options</span><span 
class="cmtt-8"> </span><span id="textcolor11882"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor11885"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Confusion</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matrix</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">without</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">normalization</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">None</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Normalized</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">confusion</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matrix</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">true</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span id="textcolor11918"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114026r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">title</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">normalize</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">titles_options</span><span id="textcolor11930"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114027r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">disp</span><span 
class="cmtt-8"> </span><span id="textcolor11934"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plot_confusion_matrix</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">classifier</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">display_labels</span><span id="textcolor11949"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">class_names</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cmap</span><span id="textcolor11955"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">Blues</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">normalize</span><span id="textcolor11965"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">normalize</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114028r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">disp</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ax_</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">set_title</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">title</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114029r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114030r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">title</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114031r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">disp</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">confusion_matrix</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114032r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114033r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">show</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-114034r13"></a><span 
class="cmr-5">13</span></span></pre>
<!--l. 2843--><p class="noindent" >The object <span 
class="cmtt-10">disp </span>has the details of confusion matrix which can be printed
with the help of the statement <span 
class="cmtt-10">print(disp.confusion</span><span 
class="cmtt-10">_matrix)</span>.
The resultant plot appears as below:
</p>
                                                    
                                                    
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1140351"></a>
                                                    
                                                    
<!--l. 2846--><p class="noindent" ><img 
src="confusion-matrix.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 2.1:</span><span  
class="content">Confusion matrix for iris data set using SVM.</span></figcaption><!--tex4ht:label?: x1-1140351 -->
                                                    
                                                    
</figure>
<h4 class="subsectionHead"><span class="titlemark">2.5.3   </span> <a 
 id="x1-1150002.5.3"></a>Cross-validation</h4>
<!--l. 2853--><p class="noindent" >Cross-validation, sometimes called rotation estimation or
out-of-sample testing, is any of various similar model validation
techniques for assessing how the results of a statistical analysis will
generalize to an independent data set. <sup class="textsuperscript"><a 
href="#ennote-29" id="enmark-29"><span 
class="cmr-9">29</span></a></sup> It is mainly used in
settings where the goal is prediction, and one wants to estimate how
accurately a predictive model will perform in practice. In a
prediction problem, a model is usually given a dataset of known
data on which training is run (training dataset), and a dataset of
unknown data (or first seen data) against which the model is tested
(called the validation dataset or testing set). <sup class="textsuperscript"><a 
href="#ennote-30" id="enmark-30"><span 
class="cmr-9">30</span></a></sup> The goal
of cross-validation is to test the model’s ability to predict
new data that was not used in estimating it, in order to flag
problems like overfitting or selection bias and to give an insight
on how the model will generalize to an independent dataset
(i.e., an unknown dataset, for instance from a real problem).
<sup class="textsuperscript"><a 
href="#ennote-31" id="enmark-31"><span 
class="cmr-9">31</span></a></sup>
</p><!--l. 2855--><p class="noindent" >One round of cross-validation involves partitioning a sample of data
into complementary subsets, performing the analysis on one subset
(called the training set), and validating the analysis on the other
subset (called the validation set or testing set). To reduce
variability, in most methods multiple rounds of cross-validation are
performed using different partitions, and the validation results are
combined (e.g. averaged) over the rounds to give an estimate of the
model’s predictive performance.
</p><!--l. 2857--><p class="noindent" >A dataset can be repeatedly split into a training dataset and a
validation dataset: this is known as cross-validation. These repeated
partitions can be done in various ways, such as dividing into 2 equal
datasets and using them as training/validation, and then
validation/training, or repeatedly selecting a random subset as a
validation dataset. To validate the model performance, sometimes
an additional test dataset that was held out from cross-validation is
used. In summary, cross-validation combines (averages) measures of
fitness in prediction to derive a more accurate estimate of model
prediction performance. <sup class="textsuperscript"><a 
href="#ennote-32" id="enmark-32"><span 
class="cmr-9">32</span></a></sup>
                                                    
                                                    
</p><!--l. 2859--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1160002.5.3"></a>Types</h5>
<!--l. 2861--><p class="noindent" >Two types of cross-validation can be distinguished: exhaustive and
non-exhaustive cross-validation.
</p><!--l. 2863--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-116002x1">
     <!--l. 2864--><p class="noindent" ><span 
class="cmbx-10">Exhaustive cross-validation</span>: Exhaustive cross-validation
     methods are cross-validation methods which learn and test on
     all possible ways to divide the original sample into a training
     and a validation set.
         </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-116004x1">
         <!--l. 2866--><p class="noindent" ><span 
class="cmbx-10">Leave-p-out cross-validation</span>: Leave-p-out cross-validation
         (LpO CV) involves using p observations as the validation
         set and the remaining observations as the training
         set. This is repeated on all ways to cut the original
         sample on a validation set of p observations and a
         training  set.  LpO  cross-validation  require  training
         and validating the model <!--l. 2866--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
></math>
         times, where <span 
class="cmti-10">n </span>is the number of observations in the
         original sample, and where <!--l. 2866--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
></math>
         is the binomial coefficient. For <span 
class="cmti-10">p ¿ 1  </span>and for even
         moderately large <span 
class="cmti-10">n</span>, LpO CV can become computationally
         infeasible. For example, with <span 
class="cmti-10">n = 100 </span>and <span 
class="cmti-10">p = 30</span>,
         <!--l. 2866--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>C</mi></mrow><mrow 
><mn>3</mn><mn>0</mn></mrow><mrow 
><mn>1</mn><mn>0</mn><mn>0</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">≈</mo> <mn>3</mn> <mo 
class="MathClass-bin">×</mo> <mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mn>2</mn><mn>5</mn></mrow></msup 
></math>.
         A variant of LpO cross-validation with <span 
class="cmti-10">p=2 </span>known as
         leave-pair-out cross-validation has been recommended
         as a nearly unbiased method for estimating the area
         under ROC curve of binary classifiers.
         </p></li>
<li 
  class="enumerate" id="x1-116006x2">
         <!--l. 2868--><p class="noindent" ><span 
class="cmbx-10">Leave-one-out cross-validation</span>: Leave-one-out cross-validation
                                                    
                                                    
         (LOOCV) is a particular case of leave-p-out cross-validation
         with <span 
class="cmti-10">p = 1</span>.The process looks similar to jackknife;
         however, with cross-validation one computes a statistic
         on the left-out sample(s), while with jackknifing one
         computes a statistic from the kept samples only. LOO
         cross-validation requires less computation time than
         LpO cross-validation because there are only <!--l. 2868--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>C</mi></mrow><mrow 
><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>n</mi></math>
         passes rather than <!--l. 2868--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>C</mi></mrow><mrow 
><mi 
>p</mi></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
></math>.
         However,  <span 
class="cmti-10">n  </span>passes  may  still  require  quite  a  large
         computation time, in which case other approaches
         such as <span 
class="cmti-10">k-fold </span>cross validation may be more appropriate.</p></li></ol>
     </li>
<li 
  class="enumerate" id="x1-116008x2">
     <!--l. 2871--><p class="noindent" ><span 
class="cmbx-10">Non-exhaustive cross-validation</span>: Non-exhaustive cross
     validation methods do not compute all ways of splitting the
     original sample. Those methods are approximations of
     leave-p-out cross-validation.
     </p><!--l. 2873--><p class="noindent" >
         </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-116010x1">
         <!--l. 2874--><p class="noindent" ><span 
class="cmbx-10">k-fold cross-validation</span>: In k-fold cross-validation,
         the  original  sample  is  randomly  partitioned  into
         k  equal  sized  subsamples.  Of  the  k  subsamples,
         a  single  subsample  is  retained  as  the  validation
         data  for  testing  the  model,  and  the  remaining  k
         ?  1  subsamples  are  used  as  training  data.  The
         cross-validation  process  is  then  repeated  k  times,
         with  each  of  the  k  subsamples  used  exactly  once
         as  the  validation  data.  The  k  results  can  then
         be  averaged  to  produce  a  single  estimation.  The
         advantage  of  this  method  over  repeated  random
         sub-sampling  (see  below)  is  that  all  observations
         are  used  for  both  training  and  validation,  and
         each  observation  is  used  for  validation  exactly
         once.  <span 
class="cmti-10">10-fold  </span>cross-validation  is  commonly  used,
         but  in  general  k  remains  an  unfixed  parameter.
         For  example,  setting  <span 
class="cmti-10">k  =  2   </span>results  in  <span 
class="cmti-10">2-fold</span>
                                                    
                                                    
         cross-validation.   In   <span 
class="cmti-10">2-fold   </span>cross-validation,   we
         randomly shuffle the dataset into two sets d0 and
         d1, so that both sets are equal size (this is usually
         implemented by shuffling the data array and then
         splitting  it  in  two).  We  then  train  on  d0  and
         validate  on  d1,  followed  by  training  on  d1  and
         validating  on  <span 
class="cmti-10">d0</span>.  When  <span 
class="cmti-10">k  =  n  </span>(the  number  of
         observations),  <span 
class="cmti-10">k-fold  </span>cross-validation  is  equivalent
         to leave-one-out cross-validation. In <span 
class="cmti-10">stratified k-fold</span>
         cross-validation, the partitions are selected so that
         the mean response value is approximately equal in
         all the partitions. In the case of binary classification,
         this means that each partition contains roughly the
         same proportions of the two types of class labels. In
         repeated cross-validation the data is randomly split
         into k partitions several times. The performance of
         the model can thereby be averaged over several runs,
         but this is rarely desirable in practice.
         </p></li>
<li 
  class="enumerate" id="x1-116012x2">
         <!--l. 2876--><p class="noindent" ><span 
class="cmbx-10">Holdout  method</span>:  In  the  holdout  method,  we
         randomly  assign  data  points  to  two  sets  <span 
class="cmti-10">d0  </span>and
         <span 
class="cmti-10">d1</span>,  usually  called  the  training  set  and  the  test
         set,  respectively.  The  size  of  each  of  the  sets  is
         arbitrary although typically the test set is smaller
         than  the  training  set.  We  then  train  (build  a
         model) on <span 
class="cmti-10">d0  </span>and test (evaluate its performance)
         on <span 
class="cmti-10">d1</span>. In typical cross-validation, results of multiple
         runs  of  model-testing  are  averaged  together;  in
         contrast, the holdout method, in isolation, involves
         a single run. It should be used with caution because
         without such averaging of multiple runs, one may
         achieve highly misleading results. One’s indicator of
         predictive  accuracy  (F*)  will  tend  to  be  unstable
         since  it  will  not  be  smoothed  out  by  multiple
         iterations  (see  below).  Similarly,  indicators  of  the
         specific  role  played  by  various  predictor  variables
         (e.g., values of regression coefficients) will tend to be
         unstable. While the holdout method can be framed
         as  ”the  simplest  kind  of  cross-validation”,  many
                                                    
                                                    
         sources instead classify holdout as a type of simple
         validation, rather than a simple or degenerate form
         of cross-validation.
         </p></li>
<li 
  class="enumerate" id="x1-116014x3">
         <!--l. 2878--><p class="noindent" ><span 
class="cmbx-10">Repeated</span>
         <span 
class="cmbx-10">random sub-sampling validation</span>: This method,
         also known as <span 
class="cmti-10">Monte Carlo </span>cross-validation, creates
         multiple random splits of the dataset into training
         and validation data. For each such split, the model
         is fit to the training data, and predictive accuracy
         is  assessed  using  the  validation  data.  The  results
         are  then  averaged  over  the  splits.  The  advantage
         of this method (over k-fold cross validation) is that
         the  proportion  of  the  training/validation  split  is
         not  dependent  on  the  number  of  iterations  (i.e.,
         the number of partitions). The disadvantage of this
         method  is  that  some  observations  may  never  be
         selected in the validation subsample, whereas others
         may  be  selected  more  than  once.  In  other  words,
         validation  subsets  may  overlap.  This  method  also
         exhibits  Monte  Carlo  variation,  meaning  that  the
         results  will  vary  if  the  analysis  is  repeated  with
         different random splits. As the number of random
         splits  approaches  infinity,  the  result  of  repeated
         random sub-sampling validation tends towards that
         of leave-p-out cross-validation. In a stratified variant
         of this approach, the random samples are generated
         in such a way that the mean response value (i.e. the
         dependent variable in the regression) is equal in the
         training and testing sets. This is particularly useful
         if the responses are dichotomous with an unbalanced
         representation of the two response values in the data.
</p>
         </li></ol>
     </li></ol>
                                                    
                                                    
<!--l. 2884--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1170002.5.3"></a>Python practice</h5>
<!--l. 2886--><p class="noindent" >Learning the parameters of a prediction function and testing it on
the same data is a methodological mistake: a model that would just
repeat the labels of the samples that it has just seen would have a
perfect score but would fail to predict anything useful on yet-unseen
data. <span 
class="cmti-10">This situation is called overfitting</span>. To avoid it, it is common
practice when performing a (supervised) machine learning
experiment to hold out part of the available data as a test set
<span 
class="cmti-10">X</span><span 
class="cmti-10">_test, y</span><span 
class="cmti-10">_test</span>. Note that the word ”experiment” is not intended to
denote academic use only, because even in commercial settings
machine learning usually starts out experimentally. Here is
a flowchart of typical cross validation work-flow in model
training. The best parameters can be determined by grid search
techniques.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1170012"></a>
                                                    
                                                    
<!--l. 2889--><p class="noindent" ><img 
src="cv-grid-search-workflow.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 2.2:</span><span  
class="content">Cross validation using grid search work-flow.</span></figcaption><!--tex4ht:label?: x1-1170012 -->
                                                    
                                                    
</figure>
<!--l. 2894--><p class="noindent" >In scikit-learn a random split into training and test sets can be
quickly computed with the <span 
class="cmti-10">train</span><span 
class="cmti-10">_test</span><span 
class="cmti-10">_split </span>helper function. Lets
load the iris data set to fit a linear support vector machine on
it:
</p>
<!--l. 2896--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117002r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor11991"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117003r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor12001"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">model_selection</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117004r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor12013"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117005r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor12023"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117006r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117007r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor12033"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor12041"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">return_X_y</span><span id="textcolor12049"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117008r7"></a><span 
class="cmr-5">7</span></span><span id="textcolor12053"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117009r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">150</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">150</span><span 
class="cmtt-8">,)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117010r9"></a><span 
class="cmr-5">9</span></span></pre>
<!--l. 2907--><p class="noindent" >We can now quickly sample a training set while holding out
<!--l. 2907--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn><mn>0</mn><mi 
>%</mi></math> of
the data for testing (evaluating) our classifier:
</p>
<!--l. 2909--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117011r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor12076"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><span id="textcolor12090"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117012r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">test_size</span><span id="textcolor12105"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor12113"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117013r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117014r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor12117"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117015r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">90</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">90</span><span 
class="cmtt-8">,)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117016r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor12140"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117017r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">60</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">60</span><span 
class="cmtt-8">,)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117018r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117019r9"></a><span 
class="cmr-5">9</span></span><span id="textcolor12163"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor12168"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">SVC</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">kernel</span><span id="textcolor12176"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">linear</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">C</span><span id="textcolor12184"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117020r10"></a><span 
class="cmr-5">10</span></span><span id="textcolor12196"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">score</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117021r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">96</span><span 
class="cmtt-8">...</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-117022r12"></a><span 
class="cmr-5">12</span></span></pre>
<!--l. 2923--><p class="noindent" >When evaluating different settings (“hyperparameters”) for
estimators, such as the <span 
class="cmti-10">C </span>setting that must be manually set
for an SVM, there is still a risk of overfitting on the test set
because the parameters can be tweaked until the estimator
performs optimally. This way, knowledge about the test set can
“leak” into the model and evaluation metrics no longer report
on generalization performance. To solve this problem, yet
another part of the data set can be held out as a so-called
“validation set”: training proceeds on the training set, after which
evaluation is done on the validation set, and when the experiment
seems to be successful, final evaluation can be done on the test
set.
</p><!--l. 2925--><p class="noindent" >However, by partitioning the available data into three sets,
we drastically reduce the number of samples which can be
used for learning the model, and the results can depend on a
particular random choice for the pair of (train, validation)
sets.
</p><!--l. 2927--><p class="noindent" >A solution to this problem is a procedure called cross-validation
(CV for short). A test set should still be held out for final
evaluation, but the validation set is no longer needed when doing
CV. In the basic approach, called <span 
class="cmti-10">k-fold CV </span>, the training set is split
into k smaller sets (other approaches are described below, but
generally follow the same principles). The following procedure is
followed for each of the <span 
class="cmti-10">k “folds”</span>:
                                                    
                                                    
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-117024x1">
     <!--l. 2930--><p class="noindent" >A model is trained using of the folds as training data;
     </p></li>
<li 
  class="enumerate" id="x1-117026x2">
     <!--l. 2931--><p class="noindent" >The resulting model is validated on the remaining part
     of the data (i.e., it is used as a test set to compute a
     performance measure such as accuracy).</p></li></ol>
<!--l. 2934--><p class="noindent" >The performance measure reported by <span 
class="cmti-10">k-fold cross-validation </span>is
then the average of the values computed in the loop. This approach
can be computationally expensive, but does not waste too much
data (as is the case when fixing an arbitrary validation set), which
is a major advantage in problems such as inverse inference where
the number of samples is very small.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1170273"></a>
                                                    
                                                    
<!--l. 2937--><p class="noindent" ><img 
src="k-fold.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 2.3:</span><span  
class="content">K-Fold Cross Validation</span></figcaption><!--tex4ht:label?: x1-1170273 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1180002.5.3"></a>Computing cross-validated metrics</h5>
<!--l. 2944--><p class="noindent" >The simplest way to use cross-validation is to call the
<span 
class="cmtt-10">cross</span><span 
class="cmtt-10">_val</span><span 
class="cmtt-10">_score </span>helper function on the estimator and the data
set. The following example demonstrates how to estimate
the accuracy of a linear kernel support vector machine on
the iris data set by splitting the data, fitting a model and
computing the score 5 consecutive times (with different splits each
time):
</p>
<!--l. 2946--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor12212"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">model_selection</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cross_val_score</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor12224"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor12229"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">SVC</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">kernel</span><span id="textcolor12237"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">linear</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">C</span><span id="textcolor12245"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor12251"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">42</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor12255"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">scores</span><span 
class="cmtt-8"> </span><span id="textcolor12260"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cross_val_score</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">cv</span><span id="textcolor12275"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor12279"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">scores</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor12285"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">96</span><span 
class="cmtt-8">...,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">96</span><span 
class="cmtt-8">...,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">96</span><span 
class="cmtt-8">...,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span id="textcolor12310"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118006r6"></a><span 
class="cmr-5">6</span></span></pre>
<!--l. 2954--><p class="noindent" >The mean score and the standard deviation are hence given
by:
</p>
<!--l. 2956--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118007r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor12313"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">2f</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">with</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">a</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">standard</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">deviation</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">of</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">2f</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">scores</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mean</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">scores</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">std</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118008r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">98</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">with</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">a</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">standard</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">deviation</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">of</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">02</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-118009r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 2961--><p class="noindent" >There are number of options which can be used
while defining model evaluation rules. Visit
<a 
href="https://scikit-learn.org/stable/modules/cross_validation.html" class="url" ><span 
class="cmtt-10">https://scikit-learn.org/stable/modules/cross</span></mrow><mrow 
><span 
class="cmr-7">v</span></mrow></msub 
><span 
class="cmtt-10">alidation.html</span></a>
for details.
</p><!--l. 2963--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.5.4   </span> <a 
 id="x1-1190002.5.4"></a>Concept representation</h4>
<!--l. 2966--><p class="noindent" >Concepts in Machine Learning can be thought of as a <span 
class="cmti-10">boolean-valued</span>
<span 
class="cmti-10">function </span>defined over a large set of training data. Taking a very
simple example, one possible target concept may be to find the day
when somebody enjoys his/her favorite sport. We have some
attributes/features of the day like, <span 
class="cmti-10">Sky, Air Temperature, Humidity,</span>
<span 
class="cmti-10">Wind, Water, Forecast </span>and based on this we have a target Concept
named <span 
class="cmti-10">EnjoySport</span>. We have the following training example
available
</p>
                                                    
                                                    
<div class="table">
                                                    
                                                    
<!--l. 2969--><p class="noindent" ><a 
 id="x1-1190011"></a></p><figure class="float" 
>
                                                    
                                                    
<div class="tabular"> <table id="TBL-4" class="tabular" 
 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1" /><col 
id="TBL-4-2" /><col 
id="TBL-4-3" /><col 
id="TBL-4-4" /><col 
id="TBL-4-5" /><col 
id="TBL-4-6" /><col 
id="TBL-4-7" /><col 
id="TBL-4-8" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-1"  
class="td11"><span 
class="cmr-5">Example</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-2"  
class="td11"><span 
class="cmr-5">Sky   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-3"  
class="td11"><span 
class="cmr-5">AirTemp</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-4"  
class="td11"><span 
class="cmr-5">Humidity</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-5"  
class="td11"><span 
class="cmr-5">Wind  </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-6"  
class="td11"><span 
class="cmr-5">Water</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-7"  
class="td11"><span 
class="cmr-5">Forecast</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-1-8"  
class="td11"><span 
class="cmr-5">EnjoySport</span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-1"  
class="td11"><span 
class="cmr-5">1          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-2"  
class="td11"><span 
class="cmr-5">Sunny</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-3"  
class="td11"><span 
class="cmr-5">Warm    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-4"  
class="td11"><span 
class="cmr-5">Normal   </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-5"  
class="td11"><span 
class="cmr-5">Strong</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-6"  
class="td11"><span 
class="cmr-5">Warm</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-7"  
class="td11"><span 
class="cmr-5">Same    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-2-8"  
class="td11"><span 
class="cmr-5">Yes          </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-1"  
class="td11"><span 
class="cmr-5">2          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-2"  
class="td11"><span 
class="cmr-5">Sunny</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-3"  
class="td11"><span 
class="cmr-5">Warm    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-4"  
class="td11"><span 
class="cmr-5">High      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-5"  
class="td11"><span 
class="cmr-5">Strong</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-6"  
class="td11"><span 
class="cmr-5">Warm</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-7"  
class="td11"><span 
class="cmr-5">Same    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-3-8"  
class="td11"><span 
class="cmr-5">Yes          </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-1"  
class="td11"><span 
class="cmr-5">3          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-2"  
class="td11"><span 
class="cmr-5">Rainy</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-3"  
class="td11"><span 
class="cmr-5">Cold     </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-4"  
class="td11"><span 
class="cmr-5">High      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-5"  
class="td11"><span 
class="cmr-5">Strong</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-6"  
class="td11"><span 
class="cmr-5">Warm</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-7"  
class="td11"><span 
class="cmr-5">Change </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-4-8"  
class="td11"><span 
class="cmr-5">No           </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-1"  
class="td11"><span 
class="cmr-5">4          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-2"  
class="td11"><span 
class="cmr-5">Sunny</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-3"  
class="td11"><span 
class="cmr-5">Warm    </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-4"  
class="td11"><span 
class="cmr-5">High      </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-5"  
class="td11"><span 
class="cmr-5">Strong</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-6"  
class="td11"><span 
class="cmr-5">Cool  </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-7"  
class="td11"><span 
class="cmr-5">Charge  </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-4-5-8"  
class="td11"><span 
class="cmr-5">Yes          </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-4-6-1"  
class="td11">           </td></tr></table></div>
<figcaption class="caption" ><span class="id">Table 2.1:</span><span  
class="content"></span></figcaption><!--tex4ht:label?: x1-1190011 -->
                                                    
                                                    
</figure>
</div>
<!--l. 2983--><p class="noindent" >Lets Design the problem formally with TPE(Task, Performance,
Experience):
     </p><dl class="description"><dt class="description">
     <!--l. 2986--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2986--><p class="noindent" ><span 
class="cmti-10">Problem</span>: Leaning the day when someone enjoys the sport.
     </p></dd><dt class="description">
     <!--l. 2987--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2987--><p class="noindent" ><span 
class="cmti-10">Task T</span>: Learn to predict the value of <span 
class="cmti-10">EnjoySport </span>for an
     arbitrary day, based on the values of the attributes of the
     day.
     </p></dd><dt class="description">
     <!--l. 2988--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2988--><p class="noindent" ><span 
class="cmti-10">Performance   measure   P</span>:   Total   percent   of   days
     (<span 
class="cmti-10">EnjoySport</span>) correctly predicted.
     </p></dd><dt class="description">
     <!--l. 2989--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 2989--><p class="noindent" ><span 
class="cmti-10">Training experience E</span>: A set of days with given labels
     (<span 
class="cmti-10">EnjoySport: Yes/No</span>)</p></dd></dl>
<!--l. 2992--><p class="noindent" >Let us take a very simple hypothesis representation which consists of a
conjunction of constraints in the instance attributes. We get a hypothesis
<!--l. 2992--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>h</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math> with
the help of example <span 
class="cmti-10">i </span>for our training set as below:
</p><!--l. 2994--><p class="noindent" ><!--l. 2994--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mi 
>i</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-punc">:</mo><mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>x</mi><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mn>3</mn><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mn>4</mn><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mn>5</mn><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mn>6</mn> <mo 
class="MathClass-rel">&#x003E;</mo></math>
</p><!--l. 2996--><p class="noindent" >where <span 
class="cmti-10">x1, x2, x3, x4, x5 </span>and <span 
class="cmti-10">x6 </span>are the values of <span 
class="cmti-10">Sky, AirTemp,</span>
<span 
class="cmti-10">Humidity, Wind, Water </span>and <span 
class="cmti-10">Forecast</span>. Hence <span 
class="cmti-10">h1 </span>will look like(the
first row of the table above):
                                                    
                                                    
</p><!--l. 2998--><p class="noindent" ><!--l. 2998--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mn>1</mn><mo 
class="MathClass-open">(</mo><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-punc">:</mo><mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>S</mi><mi 
>u</mi><mi 
>n</mi><mi 
>n</mi><mi 
>y</mi><mo 
class="MathClass-punc">,</mo><mi 
>W</mi><mi 
>a</mi><mi 
>r</mi><mi 
>m</mi><mo 
class="MathClass-punc">,</mo><mi 
>N</mi><mi 
>o</mi><mi 
>r</mi><mi 
>m</mi><mi 
>a</mi><mi 
>l</mi><mo 
class="MathClass-punc">,</mo><mi 
>S</mi><mi 
>t</mi><mi 
>r</mi><mi 
>o</mi><mi 
>n</mi><mi 
>g</mi><mo 
class="MathClass-punc">,</mo><mi 
>W</mi><mi 
>a</mi><mi 
>r</mi><mi 
>m</mi><mo 
class="MathClass-punc">,</mo><mi 
>S</mi><mi 
>a</mi><mi 
>m</mi><mi 
>e</mi> <mo 
class="MathClass-rel">&#x003E;</mo></math>
Note: <span 
class="cmti-10">x=1 </span>represents a positive hypothesis / Positive example
</p><!--l. 3000--><p class="noindent" >We want to find the most suitable hypothesis which can represent
the concept. For example, Say someone called <span 
class="cmti-10">Ramesh </span>enjoys his
favorite sport only on cold days with high humidity (This seems
independent of the values of the other attributes present in the
training examples).
</p><!--l. 3002--><p class="noindent" ><!--l. 3002--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mi 
>C</mi><mi 
>o</mi><mi 
>l</mi><mi 
>d</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mi 
>i</mi><mi 
>g</mi><mi 
>h</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo> <mo 
class="MathClass-rel">&#x003E;</mo></math>
</p><!--l. 3004--><p class="noindent" >Here <span 
class="cmti-10">? </span>indicates that any value of the attribute is
acceptable. The most <span 
class="cmbxti-10">generic hypothesis </span>will be
<!--l. 3004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo> <mo 
class="MathClass-rel">&#x003E;</mo></math> where
every day is a positive example and the most <span 
class="cmbxti-10">specific hypothesis </span>will
be <!--l. 3004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">?</mo> <mo 
class="MathClass-rel">&#x003E;</mo></math>
where no day is a positive example. We will discuss the two
most popular approaches to find a suitable hypothesis, they
are:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-119003x1">
     <!--l. 3007--><p class="noindent" >Find-S Algorithm
     </p></li>
<li 
  class="enumerate" id="x1-119005x2">
     <!--l. 3008--><p class="noindent" >List-Then-Eliminate Algorithm</p></li></ol>
<h5 class="subsubsectionHead"><a 
 id="x1-1200002.5.4"></a>Find-S Algorithm</h5>
<!--l. 3013--><p class="noindent" >Following are the steps for the <span 
class="cmti-10">Find-S algorithm</span>:
</p><!--l. 3015--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-120002x1">
     <!--l. 3016--><p class="noindent" >Initialize <span 
class="cmti-10">h </span>to the most specific hypothesis in <span 
class="cmti-10">H</span>
     </p></li>
                                                    
                                                    
<li 
  class="enumerate" id="x1-120004x2">
     <!--l. 3017--><p class="noindent" >For each positive training example,
         </p><ol  class="enumerate2" >
<li 
  class="enumerate" id="x1-120006x1">
         <!--l. 3019--><p class="noindent" >For each attribute, constraint <span 
class="cmti-10">ai </span>in <span 
class="cmti-10">h</span>
             </p><ol  class="enumerate3" >
<li 
  class="enumerate" id="x1-120008x1">
             <!--l. 3021--><p class="noindent" >If the constraints <span 
class="cmti-10">ai </span>is satisfied by <span 
class="cmti-10">x</span>
             </p></li>
<li 
  class="enumerate" id="x1-120010x2">
             <!--l. 3022--><p class="noindent" >Then do nothing
             </p></li>
<li 
  class="enumerate" id="x1-120012x3">
             <!--l. 3023--><p class="noindent" >Else replace <span 
class="cmti-10">ai  </span>in h by the next more general
             constraint that is satisfied by <span 
class="cmti-10">x</span></p></li></ol>
         </li></ol>
     </li>
<li 
  class="enumerate" id="x1-120014x3">
     <!--l. 3026--><p class="noindent" >Output hypothesis <span 
class="cmti-10">h</span></p></li></ol>
<!--l. 3029--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1210002.5.4"></a>The <span 
class="cmti-10">LIST-THEN-ELIMINATE </span>Algorithm</h5>
<!--l. 3031--><p class="noindent" >Following are the steps for the <span 
class="cmti-10">LIST-THE-ELIMINATE algorithm</span>:
</p><!--l. 3033--><p class="noindent" ><!--l. 3033--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> <mi 
>e</mi><mi 
>r</mi><mi 
>s</mi><mi 
>i</mi><mi 
>o</mi><mi 
>n</mi><mi 
>S</mi><mi 
>p</mi><mi 
>a</mi><mi 
>c</mi><mi 
>e</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mo 
class="MathClass-bin">−</mo></math> a list containing
every hypothesis in <!--l. 3033--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
</p><!--l. 3035--><p class="noindent" >For each training example, <!--l. 3035--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">&#x003E;</mo></math>.
                                                    
                                                    
</p><!--l. 3037--><p class="noindent" >Remove from <span 
class="cmti-10">VersionSpace </span>any hypothesis <span 
class="cmti-10">h </span>for which <span 
class="cmti-10">h(x) !=</span>
<span 
class="cmti-10">c(x)</span>. Output the list of hypotheses in <span 
class="cmti-10">VersionSpace</span>.
</p><!--l. 3039--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">2.5.5   </span> <a 
 id="x1-1220002.5.5"></a>Function approximation</h4>
<!--l. 3041--><p class="noindent" >Function approximation is an instance of supervised learning, the
primary topic studied in machine learning, artificial neural
networks, pattern recognition, and statistical curve fitting. In
principle, any of the methods studied in these fields can be used in
reinforcement learning. A function approximation problem asks us
to select a function among a well-defined class that closely
matches (”approximates”) a target function in a task-specific
way. The need for function approximations arises in many
branches of applied mathematics, and computer science in
particular.
</p><!--l. 3043--><p class="noindent" >Two major classes of function approximation problems: <span 
class="cmti-10">First</span>, for
known target functions approximation theory is the branch of
numerical analysis that investigates how certain known functions
(for example, special functions) can be approximated by a specific
class of functions (for example, polynomials or rational functions)
that often have desirable properties (inexpensive computation,
continuity, integral and limit values, etc.). <span 
class="cmti-10">Second</span>, the target
function, call it <span 
class="cmti-10">g</span>, may be unknown; instead of an explicit
formula, only a set of points of the form <span 
class="cmti-10">(x, g(x)) </span>is provided.
Depending on the structure of the domain and codomain of <span 
class="cmti-10">g</span>,
several techniques for approximating g may be applicable. For
example, if <span 
class="cmti-10">g </span>is an operation on the real numbers, techniques of
interpolation, extrapolation, regression analysis, and curve
fitting can be used. If the codomain (range or target set) of <span 
class="cmti-10">g</span>
is a finite set, one is dealing with a classification problem
instead.
</p><!--l. 3045--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1230002.5.5"></a>Function approximation theories</h5>
                                                    
                                                    
<!--l. 3047--><p class="noindent" >Approximation theory is concerned with how functions can best be
approximated with simpler functions, and with quantitatively
characterizing the errors introduced thereby. Note that what is
meant by best and simpler will depend on the application. A closely
related topic is the <span 
class="cmti-10">approximation of functions by generalized</span>
<span 
class="cmti-10">Fourier series</span>, that is, approximations based upon summation of a
series of terms based upon orthogonal polynomials. One problem of
particular interest is that of approximating a function in a
computer mathematical library, using operations that can be
performed on the computer or calculator (e.g. addition and
multiplication), such that the result is as close to the actual
function as possible. This is typically done with polynomial or
rational (ratio of polynomials) approximations.
</p><!--l. 3049--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-123002x1">
     <!--l. 3050--><p class="noindent" ><span 
class="cmti-10">Optimal polynomials</span>: Once the domain (typically an
     interval) and degree of the polynomial are chosen, the
     polynomial itself is chosen in such a way as to minimize
     the worst-case error. That is, the goal is to minimize the
     maximum value of
     <!--l. 3050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∣</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">∣</mo></math>,
     where <span 
class="cmti-10">P(x) </span>is the approximating polynomial, <span 
class="cmti-10">f(x) </span>is the
     actual function, and <span 
class="cmti-10">x </span>varies over the chosen interval.
     For well-behaved functions, there exists an Nth-degree
     polynomial that will lead to an error curve that oscillates
     back and forth between
     <!--l. 3050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">+</mo> <mi 
>𝜀</mi></math>
     and
     <!--l. 3050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">−</mo> <mi 
>𝜀</mi></math>
     a total of <span 
class="cmti-10">N+2 </span>times, giving a worst-case error of
     <!--l. 3050--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi></math>.
     It is seen that there exists an Nth-degree polynomial can
     interpolate <span 
class="cmti-10">N+1 </span>points in a curve. Such a polynomial is
     always optimal. It is possible to make contrived
     functions <span 
class="cmti-10">f(x) </span>for which no such polynomial exists, but
     these occur rarely in practice. </p><figure class="figure"> 
<a 
 id="x1-1230034"></a><img 
src="func-aprox.png" alt="PIC"  
width="85" height="85"  />
<figcaption class="caption" ><span class="id">Figure 2.4:</span><span  
class="content">Function approximation: Error <span 
class="cmti-10">P(x) - f(x) </span>for level
polynomial (red), and for purported better polynomial (blue)</span></figcaption><!--tex4ht:label?: x1-1230034 -->
                                                    
                                                    
     </figure>
     <!--l. 3058--><p class="noindent" >For example, the graphs shown to the right show the error in
     approximating <span 
class="cmti-10">log(x) </span>and <span 
class="cmti-10">exp(x) </span>for <span 
class="cmti-10">N = 4</span>. The red curves, for
     the optimal polynomial, are level, that is, they oscillate between
     <!--l. 3058--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">+</mo> <mi 
>𝜀</mi></math> and
     <!--l. 3058--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">−</mo> <mi 
>𝜀</mi></math>
     exactly. Note that, in each case, the number of extrema is
     <span 
class="cmti-10">N+2</span>, that is, 6. Two of the extrema are at the end
     points of the interval, at the left and right edges of the
     graphs.
     </p><!--l. 3060--><p class="noindent" >To prove this is true in general, suppose <span 
class="cmti-10">P </span>is a polynomial of
     degree <span 
class="cmti-10">N </span>having the property described, that is, it gives rise
     to an error function that has <span 
class="cmti-10">N + 2 </span>extrema, of alternating
     signs and equal magnitudes. The red graph to the right shows
     what this error function might look like for <span 
class="cmti-10">N = 4</span>.
     Suppose <span 
class="cmti-10">Q(x) </span>(whose error function is shown in blue to the
     right) is another N-degree polynomial that is a better
     approximation to <span 
class="cmti-10">f  </span>than <span 
class="cmti-10">P</span>. In particular, <span 
class="cmti-10">Q </span>is closer to <span 
class="cmti-10">f</span>
     than <span 
class="cmti-10">P </span>for each value <span 
class="cmti-10">xi </span>where an extreme of <span 
class="cmti-10">P?f  </span>occurs,
     so
     </p><!--l. 3062--><p class="noindent" ><!--l. 3062--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">|</mo><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mo 
class="MathClass-rel">|</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-rel">|</mo><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mo 
class="MathClass-rel">|</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo></math>
     </p><!--l. 3064--><p class="noindent" >When a maximum of <span 
class="cmti-10">P-f  </span>occurs at <span 
class="cmti-10">xi</span>, then
     </p><!--l. 3066--><p class="noindent" ><!--l. 3066--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">|</mo><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mo 
class="MathClass-rel">|</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo></math>
     </p><!--l. 3068--><p class="noindent" >And when a minimum of <span 
class="cmti-10">P-f  </span>occurs at <span 
class="cmti-10">xi</span>, then
     </p><!--l. 3070--><p class="noindent" ><!--l. 3070--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">|</mo><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">&#x003C;</mo> <mo 
class="MathClass-rel">|</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">|</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>
     </p><!--l. 3072--><p class="noindent" >So, as can be seen in the graph,
     <!--l. 3072--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">[</mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo> <mo 
class="MathClass-bin">−</mo> <mo 
class="MathClass-open">[</mo><mi 
>Q</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo></math>
     must alternate in sign for the <span 
class="cmti-10">N + 2 </span>values of <span 
class="cmti-10">xi</span>. But <span 
class="cmti-10">[P(x) -</span>
     <span 
class="cmti-10">f(x)] - [Q(x) - f(x)] </span>reduces to <span 
class="cmti-10">P(x) ? Q(x) </span>which is a
     polynomial of degree <span 
class="cmti-10">N</span>. This function changes sign at least
     <span 
class="cmti-10">N+1 </span>times so, by the Intermediate value theorem, it has <span 
class="cmti-10">N+1</span>
     zeroes, which is impossible for a polynomial of degree
     <span 
class="cmti-10">N</span>.
     </p><!--l. 3074--><p class="noindent" >The following code snippet shows as how to fit a polynomial
     using <span 
class="cmti-10">numpy </span>library of Python. Fit a polynomial
     <!--l. 3074--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>p</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>p</mi><mo 
class="MathClass-open">[</mo><mn>0</mn><mo 
class="MathClass-close">]</mo> <mo 
class="MathClass-bin">∗</mo> <mi 
>x</mi> <mo 
class="MathClass-bin">∗</mo><mo 
class="MathClass-bin">∗</mo><mi 
>d</mi><mi 
>e</mi><mi 
>g</mi> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo> <mo 
class="MathClass-bin">+</mo> <mi 
>p</mi><mo 
class="MathClass-open">[</mo><mi 
>d</mi><mi 
>e</mi><mi 
>g</mi><mo 
class="MathClass-close">]</mo></math> of degree deg
     to points <!--l. 3074--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math>.
                                                    
                                                    
     Returns a vector of coefficients <span 
class="cmti-10">p </span>that <span 
class="cmti-10">minimises the squared</span>
     <span 
class="cmti-10">error in the order deg, deg-1, ..., 0</span>. The <span 
class="cmtt-10">Polynomial.fit</span>
     class method is recommended for new code as it is more stable
     numerically. See the documentation of the method for more
     information.
     </p><!--l. 3076--><p class="noindent" >The solution minimizes the squared error <!--tex4ht:inline--></p><table class="equation"><tr><td>
     <!--l. 3077--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mstyle 
   id="x1-123004r1"  class="label" ></mstyle><!--endlabel--><mi 
>E</mi> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> ∑</mo>
  </mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>k</mi></mrow></munderover 
><mo 
class="MathClass-rel">∥</mo><mi 
>p</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
>
<mi 
>j</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>j</mi></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-rel">∥</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td><td class="eq-no">(2.1)</td></tr></table>
     <!--l. 3080--><p class="nopar" >
     </p><!--l. 3082--><p class="noindent" >in the equations:
     </p><!--l. 3085--><p class="noindent" > <table  
equalrows="false" columnlines="\columnlines " equalcolumns="false" class="array"><mtr><mtd 
class="array" > [0] <span 
class="cmsy-10">∗∗</span><span 
class="cmmi-10">n </span><span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[0] + <span 
class="cmmi-10">... </span>+ <span 
class="cmmi-10">x</span>[0] <span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n </span><span 
class="cmsy-10">− </span>1] + <span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n</span>] = <span 
class="cmmi-10">y</span>[0] </mtd>
</mtr><mtr><mtd 
class="array" ><span 
class="cmmi-10">x</span>[1] <span 
class="cmsy-10">∗∗</span><span 
class="cmmi-10">n </span><span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[0] + <span 
class="cmmi-10">... </span>+ <span 
class="cmmi-10">x</span>[1] <span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n </span><span 
class="cmsy-10">− </span>1] + <span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n</span>] = <span 
class="cmmi-10">y</span>[1]</mtd>
</mtr><mtr><mtd 
class="array" >                    <span 
class="cmmi-10">...</span>                          </mtd>
</mtr><mtr><mtd 
class="array" ><span 
class="cmmi-10">x</span>[<span 
class="cmmi-10">k</span>] <span 
class="cmsy-10">∗∗</span><span 
class="cmmi-10">n </span><span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[0] + <span 
class="cmmi-10">... </span>+ <span 
class="cmmi-10">x</span>[<span 
class="cmmi-10">k</span>] <span 
class="cmsy-10">∗ </span><span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n </span><span 
class="cmsy-10">− </span>1] + <span 
class="cmmi-10">p</span>[<span 
class="cmmi-10">n</span>] = <span 
class="cmmi-10">y</span>[<span 
class="cmmi-10">k</span>]</mtd></mtr><mtr><mtd 
class="array" ><a 
 id="x1-1230011"></a></mtd></mtr>
<!--x--></mtable>
     </p><!--l. 3093--><p class="noindent" >The coefficient matrix of the coefficients p is a Vandermonde
     matrix. <span 
class="cmtt-10">polyfit </span>issues a <span 
class="cmtt-10">RankWarning </span>when the least-squares
     fit is badly conditioned. This implies that the best fit is not
     well-defined due to numerical error. The results may be
     improved by lowering the polynomial degree or by replacing x
     by x - x.mean(). The rcond parameter can also be set
     to a value smaller than its default, but the resulting
     fit may be spurious: including contributions from the
     small singular values can add numerical noise to the
     result.
     </p><!--l. 3095--><p class="noindent" >Note that fitting polynomial coefficients is inherently badly
     conditioned when the degree of the polynomial is large or the
     interval of sample points is badly centered. The quality of
     the fit should always be checked in these cases. When
     polynomial fits are not satisfactory, splines may be a good
                                                    
                                                    
     alternative.
</p>
     <!--l. 3097--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123005r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">warnings</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123006r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">x</span><span 
class="cmtt-8"> </span><span id="textcolor12381"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor12388"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span id="textcolor12420"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123007r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor12425"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor12432"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">9</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor12454"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor12461"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">0</span><span id="textcolor12466"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123008r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">z</span><span 
class="cmtt-8"> </span><span id="textcolor12471"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">polyfit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123009r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">z</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123010r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor12489"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">08703704</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor12497"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">81349206</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">69312169</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor12510"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">03968254</span><span id="textcolor12515"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span>
     <span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123011r7"></a><span 
class="cmr-5">7</span></span></pre>
     <!--l. 3106--><p class="noindent" >It is convenient to use poly1d objects for dealing with
     polynomials:
</p>
     <!--l. 3108--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123012r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">p</span><span 
class="cmtt-8"> </span><span id="textcolor12526"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">poly1d</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">z</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123013r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">p</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123014r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">6143849206349179</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123015r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">p</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123016r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor12556"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">34732142857143039</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123017r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">p</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123018r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">22</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">579365079365115</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span>
     <span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123019r8"></a><span 
class="cmr-5">8</span></span></pre>
     <!--l. 3118--><p class="noindent" >High-order polynomials may oscillate wildly:
</p>
     <!--l. 3120--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123020r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">with</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">warnings</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">catch_warnings</span><span 
class="cmtt-8">()</span><span id="textcolor12586"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123021r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">warnings</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">simplefilter</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">ignore</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">RankWarning</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123022r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p30</span><span 
class="cmtt-8"> </span><span id="textcolor12603"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">poly1d</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">polyfit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">30</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123023r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123024r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">p30</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123025r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor12627"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">80000000000000204</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123026r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">p30</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123027r8"></a><span 
class="cmr-5">8</span></span><span id="textcolor12642"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">99999999999999445</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123028r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">p30</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123029r10"></a><span 
class="cmr-5">10</span></span><span id="textcolor12659"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">10547061179440398</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">may</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vary</span>
     <span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123030r11"></a><span 
class="cmr-5">11</span></span></pre>
     <!--l. 3133--><p class="noindent" >Illustration:
</p>
     <!--l. 3135--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123031r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123032r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">xp</span><span 
class="cmtt-8"> </span><span id="textcolor12681"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">linspace</span><span 
class="cmtt-8">(</span><span id="textcolor12688"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">6</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">100</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123033r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">_</span><span 
class="cmtt-8"> </span><span id="textcolor12700"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">plot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">xp</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">xp</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">-</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">xp</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p30</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">xp</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">--</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123034r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ylim</span><span 
class="cmtt-8">(</span><span id="textcolor12749"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123035r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">(</span><span id="textcolor12756"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123036r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">show</span><span 
class="cmtt-8">()</span>
     <span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-123037r7"></a><span 
class="cmr-5">7</span></span></pre>
     <!--l. 3144--><p class="noindent" >The plot looks like Figure <a 
href="#x1-1230385">2.5<!--tex4ht:ref: poly --></a>:
</p>
     <figure class="figure"> 
<a 
 id="x1-1230385"></a> <img 
src="polyfit.png" alt="PIC"  
width="274" height="274"  />
<figcaption class="caption" ><span class="id">Figure 2.5:</span><span  
class="content">Function   approximation   for   polynomials   using
<span 
class="cmti-10">numpy</span>.</span></figcaption><!--tex4ht:label?: x1-1230385 -->
     </figure>
     </li>
<li 
  class="enumerate" id="x1-123040x2">
     <!--l. 3153--><p class="noindent" ><span 
class="cmti-10">Chebyshev approximation</span>:
     </p><!--l. 3158--><p class="noindent" >One can obtain polynomials very close to the optimal one by
     expanding the given function in terms of Chebyshev
     polynomials and then cutting off the expansion at the desired
     degree. This is similar to the Fourier analysis of the function,
     using the Chebyshev polynomials instead of the usual
     trigonometric functions. If one calculates the coefficients in
     the Chebyshev expansion for a function:
     </p><!--l. 3160--><p class="noindent" ><!--l. 3160--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">∼</mo><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>∞</mi></mrow></msubsup 
><msub><mrow 
><mi 
>c</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>
                                                    
                                                    
     </p><!--l. 3162--><p class="noindent" >and then cuts off the series after the
     <!--l. 3162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>N</mi></mrow></msub 
></math>
     term, one gets an Nth-degree polynomial approximating <span 
class="cmti-10">f(x)</span>.
     The reason this polynomial is nearly optimal is that, for
     functions with rapidly converging power series, if the series is
     cut off after some term, the total error arising from the cutoff
     is close to the first term after the cutoff. That is, the
     first term after the cutoff dominates all later terms.
     The same is true if the expansion is in terms of <span 
class="cmti-10">bucking</span>
     <span 
class="cmti-10">polynomials</span>. If a Chebyshev expansion is cut off after
     <!--l. 3162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>N</mi></mrow></msub 
></math>,
     the error will take a form close to a multiple of
     <!--l. 3162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></math>.
     The Chebyshev polynomials have the property that they are
     level - they oscillate between <span 
class="cmti-10">+1 </span>and <span 
class="cmti-10">-1 </span>in the interval <span 
class="cmti-10">[-1, 1]</span>.
     <!--l. 3162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
</p><!--l. 3164--><p class="noindent" >In the graphs above <a 
href="#x1-1230034">2.4<!--tex4ht:ref: faprox --></a>, note that the blue error function is
sometimes better than (inside of) the red function, but sometimes
worse, meaning that it is not quite the optimal polynomial. The
discrepancy is less serious for the exp function, which has an
extremely rapidly converging power series, than for the log function.
Chebyshev approximation is the basis for <span 
class="cmti-10">ClenshawCurtis</span>
<span 
class="cmti-10">quadrature</span>, a numerical integration technique.
</p></li>
<li 
  class="enumerate" id="x1-123042x3">
<!--l. 3166--><p class="noindent" ><span 
class="cmti-10">Remez’s algorithm</span>: The Remez algorithm (sometimes spelled <span 
class="cmti-10">Remes</span>)
is used to produce an optimal polynomial <span 
class="cmti-10">P(x) </span>approximating a
given function <span 
class="cmti-10">f(x) </span>over a given interval. It is an iterative algorithm
that converges to a polynomial that has an error function with <span 
class="cmti-10">N+2</span>
level extrema. By the theorem above, that polynomial is optimal.
Remez’s algorithm uses the fact that one can construct an
Nth-degree polynomial that leads to level and alternating
error values, given <span 
class="cmti-10">N+2 </span>test points. Given <span 
class="cmti-10">N+2 </span>test points
<!--l. 3166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math> (where
<!--l. 3166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> and
<!--l. 3166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math> are
presumably the end points of the interval of approximation), these
equations need to be solved:
                                                    
                                                    
</p><!--l. 3170--><p class="noindent" >P(x˙1)-f(x˙1)=+<!--l. 3170--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mi 
>𝜀</mi><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">+</mo><mi 
>𝜀</mi><mspace width="0.33em" class="nbsp" /><mspace width="0.33em" class="nbsp" /><mi 
class="MathClass-op">⋮</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mi 
>P</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">±</mo><mi 
>𝜀</mi><mo 
class="MathClass-punc">.</mo></math>
</p><!--l. 3173--><p class="noindent" >The right-hand sides alternate in sign. That is,
</p><!--l. 3175--><p class="noindent" >P˙0+P˙1x˙1+P˙2x˙1ˆ2+P˙3x˙1ˆ3+…+P˙Nx˙1ˆN-f(x˙1)=+<!--l. 3175--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msubsup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
><msubsup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow><mrow 
><mn>3</mn></mrow></msubsup 
> <mo 
class="MathClass-bin">+</mo> <mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>N</mi></mrow></msub 
><msubsup><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>N</mi></mrow></msubsup 
> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mi 
>𝜀</mi><mspace width="0.33em" class="nbsp" /><mspace width="0.33em" class="nbsp" /><mi 
class="MathClass-op">⋮</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></math>
</p><!--l. 3177--><p class="noindent" >Since <!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math>
were given, all of their powers are known, and
<!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><mi 
>f</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>
are also known. That means that the above equations
are just N+2 linear equations in the N+2 variables
<!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>N</mi></mrow></msub 
></math>, and
<!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi></math> . Given the
test points <!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math>,
one can solve this system to get the polynomial <span 
class="cmti-10">P </span>and the number
<!--l. 3177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi></math>.
</p><!--l. 3179--><p class="noindent" >The graph below shows an example of this,
producing a fourth-degree polynomial approximating
<!--l. 3179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>x</mi></mrow></msup 
></math>
over [-1, 1]. The test points were set at
<!--l. 3179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">−</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">−</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>7</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">−</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">+</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>4</mn><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">+</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>9</mn></math>, and
1. Those values are shown in green. The resultant value of
<!--l. 3179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝜀</mi></math> is
<span 
class="cmti-10">4.43 </span><!--l. 3179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">×</mo> <mn>1</mn><mn>0</mn><mi 
>e</mi> <mo 
class="MathClass-bin">−</mo> <mn>4</mn><mo 
class="MathClass-punc">.</mo></math>
</p>
<figure class="figure"> 
<a 
 id="x1-1230436"></a><img 
src="chebachev.png" alt="PIC"  
width="85" height="85"  />
<figcaption class="caption" ><span class="id">Figure 2.6:</span><span  
class="content">Error     of     the     polynomial     produced     by
the    first    step    of    <span 
class="cmti-10">Remez’s   algorithm</span>,    approximating
<!--l. 3184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>x</mi></mrow></msup 
></math>
over    the    interval    <span 
class="cmti-10">[-1,    1]</span>.    Vertical    divisions    are
<!--l. 3184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>4</mn></mrow></msup 
></math>.</span></figcaption><!--tex4ht:label?: x1-1230436 -->
</figure>
<!--l. 3189--><p class="noindent" >Note that the error graph does indeed take on the values
                                                    
                                                    
<!--l. 3189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-bin">±</mo> <mi 
>𝜀</mi></math> at
the six test points, including the end points, but that those points
are not extrema. If the four interior test points had been extrema
(that is, the function <span 
class="cmti-10">P(x)f(x) </span>had <span 
class="cmti-10">maxima </span>or <span 
class="cmti-10">minima </span>there), the
polynomial would be optimal.
</p><!--l. 3191--><p class="noindent" >The second step of Remez’s algorithm consists of moving the test
points to the approximate locations where the error function had its
actual local maxima or minima. For example, one can tell from
looking at the graph that the point at ?0.1 should have been at about
-0.28. The way to do this in the algorithm is to use a single round of
Newton’s method. Since one knows the first and second derivatives
of <!--l. 3191--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo></math>,
one can calculate approximately how far a test point has to be
moved so that the derivative will be zero.
</p><!--l. 3193--><p class="noindent" >Calculating the derivatives of a polynomial is straightforward. One
must also be able to calculate the first and second derivatives
of <span 
class="cmti-10">f(x)</span>. Remez’s algorithm requires an ability to calculate
<!--l. 3193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mspace width="0.17em" class="thinspace"/><mo 
class="MathClass-punc">,</mo></math> and
<!--l. 3193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
class="MathClass-op">″</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mspace width="0.17em" class="thinspace"/></math>
to extremely high precision. The entire algorithm must be
carried out to higher precision than the desired precision of the
result.
</p><!--l. 3195--><p class="noindent" >After moving the test points, the linear equation part is repeated,
getting a new polynomial, and Newton’s method is used again
to move the test points again. This sequence is continued
until the result converges to the desired accuracy. The
algorithm converges very rapidly. Convergence is quadratic
for well-behaved functions - if the test points are within
<!--l. 3195--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn><mn>5</mn></mrow></msup 
></math>
of the correct result, they will be approximately within
<!--l. 3195--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><msup><mrow 
><mn>0</mn></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>3</mn><mn>0</mn></mrow></msup 
></math> of the
correct result after the next round. Remez’s algorithm is typically
started by choosing the extrema of the Chebyshev polynomial
<!--l. 3195--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>T</mi></mrow><mrow 
><mi 
>N</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></math> as
the initial points, since the final error function will be similar to
that polynomial.</p></li></ol>
<!--l. 3199--><p class="noindent" >
                                                    
                                                    
</p>
<div class="columns-2">
<h3 class="likesectionHead"><a 
 id="x1-1240002.5.5"></a>Notes</h3>
<!--l. 3202--><p class="noindent" >
</p><!--l. 4--><p class="noindent" ><a 
href="#enmark-16" id="ennote-16"><sup class="textsuperscript"><span 
class="cmr-9">16</span></sup></a><a 
 id="x1-124001x16"></a><span 
class="cmr-8">Richard  Gross,  Psychology:  The  Science  of  Mind  and  Behaviour  6E,</span>
<span 
class="cmr-8">Hachette UK, ISBN 978-1-4441-6436-7.</span>
</p><!--l. 22--><p class="noindent" ><a 
href="#enmark-17" id="ennote-17"><sup class="textsuperscript"><span 
class="cmr-9">17</span></sup></a><a 
 id="x1-124002x17"></a><span 
class="cmr-8">Karban, R. (2015). Plant Learning and Memory. In: Plant Sensing and</span>
<span 
class="cmr-8">Communication. Chicago and London: The University of Chicago Press,</span>
<span 
class="cmr-8">pp. 3144,</span>
</p><!--l. 48--><p class="noindent" ><a 
href="#enmark-18" id="ennote-18"><sup class="textsuperscript"><span 
class="cmr-9">18</span></sup></a><a 
 id="x1-124003x18"></a><span 
class="cmr-8">Daniel  L.  Schacter;  Daniel  T.  Gilbert;  Daniel  M.  Wegner  (2011)</span>
<span 
class="cmr-8">[2009].   Psychology,   2nd   edition.   Worth   Publishers.   p.   264.   ISBN</span>
<span 
class="cmr-8">978-1-4292-3719-2.</span>
</p><!--l. 72--><p class="noindent" ><a 
href="#enmark-19" id="ennote-19"><sup class="textsuperscript"><span 
class="cmr-9">19</span></sup></a><a 
 id="x1-124004x19"></a><span 
class="cmr-8">Sandman,  Wadhwa;  Hetrick,  Porto;  Peeke  (1997).  ”Human  fetal  heart</span>
<span 
class="cmr-8">rate dishabituation between thirty and thirty-two weeks gestation”. Child</span>
<span 
class="cmr-8">Development. 68 (6): 10311040.</span>
</p><!--l. 98--><p class="noindent" ><a 
href="#enmark-20" id="ennote-20"><sup class="textsuperscript"><span 
class="cmr-9">20</span></sup></a><a 
 id="x1-124005x20"></a><span 
class="cmr-8">Sheridan,  Mary;  Howard,  Justine;  Alderson,  Dawn  (2010).  Play  in</span>
<span 
class="cmr-8">Early  Childhood:  From  Birth  to  Six  Years.  Oxon:  Routledge.  ISBN</span>
<span 
class="cmr-8">978-1-136-83748-7.</span>
</p><!--l. 122--><p class="noindent" ><a 
href="#enmark-21" id="ennote-21"><sup class="textsuperscript"><span 
class="cmr-9">21</span></sup></a><a 
 id="x1-124006x21"></a><span 
class="cmr-8">Sheridan,  Mary;  Howard,  Justine;  Alderson,  Dawn  (2010).  Play  in</span>
<span 
class="cmr-8">Early  Childhood:  From  Birth  to  Six  Years.  Oxon:  Routledge.  ISBN</span>
<span 
class="cmr-8">978-1-136-83748-7.</span>
</p><!--l. 146--><p class="noindent" ><a 
href="#enmark-22" id="ennote-22"><sup class="textsuperscript"><span 
class="cmr-9">22</span></sup></a><a 
 id="x1-124007x22"></a><span 
class="cmr-8">Ron  Kohavi;  Foster  Provost  (1998).  ”Glossary  of  terms”.  Machine</span>
<span 
class="cmr-8">Learning. 30: 271274. doi:10.1023/A:1007411609915.</span>
</p><!--l. 163--><p class="noindent" ><a 
href="#enmark-23" id="ennote-23"><sup class="textsuperscript"><span 
class="cmr-9">23</span></sup></a><a 
 id="x1-124008x23"></a><span 
class="cmr-8">James,  Gareth  (2013).  An  Introduction  to  Statistical  Learning:  with</span>
<span 
class="cmr-8">Applications in R. Springer. p. 176. ISBN 978-1461471370.</span>
</p><!--l. 184--><p class="noindent" ><a 
href="#enmark-24" id="ennote-24"><sup class="textsuperscript"><span 
class="cmr-9">24</span></sup></a><a 
 id="x1-124009x24"></a><span 
class="cmr-8">Ripley,   Brian   (1996).   Pattern   Recognition   and   Neural   Networks.</span>
<span 
class="cmr-8">Cambridge University Press. p. 354. ISBN 978-0521717700.</span>
</p><!--l. 203--><p class="noindent" ><a 
href="#enmark-25" id="ennote-25"><sup class="textsuperscript"><span 
class="cmr-9">25</span></sup></a><a 
 id="x1-124010x25"></a><span 
class="cmr-8">James,  Gareth  (2013).  An  Introduction  to  Statistical  Learning:  with</span>
<span 
class="cmr-8">Applications in R. Springer. p. 176. ISBN 978-1461471370.</span>
</p><!--l. 224--><p class="noindent" ><a 
href="#enmark-26" id="ennote-26"><sup class="textsuperscript"><span 
class="cmr-9">26</span></sup></a><a 
 id="x1-124011x26"></a><span 
class="cmr-8">Ripley,   Brian   (1996).   Pattern   Recognition   and   Neural   Networks.</span>
<span 
class="cmr-8">Cambridge University Press. p. 354. ISBN 978-0521717700.</span>
</p><!--l. 243--><p class="noindent" ><a 
href="#enmark-27" id="ennote-27"><sup class="textsuperscript"><span 
class="cmr-9">27</span></sup></a><a 
 id="x1-124012x27"></a><span 
class="cmr-8">Prechelt, Lutz; Genevi B. Orr (2012-01-01). ”Early Stopping  But When?”.</span>
<span 
class="cmr-8">In Grire Montavon; Klaus-Robert Mller (eds.). Neural Networks: Tricks of</span>
<span 
class="cmr-8">the Trade. Lecture Notes in Computer Science. Springer Berlin Heidelberg.</span>
<span 
class="cmr-8">pp. 5367.</span>
</p><!--l. 280--><p class="noindent" ><a 
href="#enmark-28" id="ennote-28"><sup class="textsuperscript"><span 
class="cmr-9">28</span></sup></a><a 
 id="x1-124013x28"></a><span 
class="cmr-8">Brownlee, Jason (2017-07-13). ”What is the Difference Between Test and</span>
<span 
class="cmr-8">Validation Datasets?”. Retrieved 2017-10-12.</span>
</p><!--l. 298--><p class="noindent" ><a 
href="#enmark-29" id="ennote-29"><sup class="textsuperscript"><span 
class="cmr-9">29</span></sup></a><a 
 id="x1-124014x29"></a><span 
class="cmr-8">Allen, David M (1974). ”The Relationship between Variable Selection and</span>
<span 
class="cmr-8">Data Agumentation and a Method for Prediction”. Technometrics. 16 (1):</span>
                                                    
                                                    
<span 
class="cmr-8">125127. doi:10.2307/1267500. JSTOR 1267500.</span>
</p><!--l. 326--><p class="noindent" ><a 
href="#enmark-30" id="ennote-30"><sup class="textsuperscript"><span 
class="cmr-9">30</span></sup></a><a 
 id="x1-124015x30"></a><span 
class="cmr-8">Galkin, Alexander (November 28, 2011). ”What is the difference between</span>
<span 
class="cmr-8">test set and validation set?”. Retrieved 10 October 2018.</span>
</p><!--l. 349--><p class="noindent" ><a 
href="#enmark-31" id="ennote-31"><sup class="textsuperscript"><span 
class="cmr-9">31</span></sup></a><a 
 id="x1-124016x31"></a><span 
class="cmr-8">Cawley,  Gavin  C.;  Talbot,  Nicola  L.  C.  (2010).  ”On  Over-fitting  in</span>
<span 
class="cmr-8">Model Selection and Subsequent Selection Bias in Performance Evaluation”</span>
<span 
class="cmr-8">(PDF). 11. Journal of Machine Learning Research: 20792107.</span>
</p><!--l. 381--><p class="noindent" ><a 
href="#enmark-32" id="ennote-32"><sup class="textsuperscript"><span 
class="cmr-9">32</span></sup></a><a 
 id="x1-124017x32"></a><span 
class="cmr-8">Grossman,  Robert;  Seni,  Giovanni;  Elder,  John;  Agarwal,  Nitin;  Liu,</span>
<span 
class="cmr-8">Huan (2010). ”Ensemble Methods in Data Mining: Improving Accuracy</span>
<span 
class="cmr-8">Through Combining Predictions”. Synthesis Lectures on Data Mining and</span>
<span 
class="cmr-8">Knowledge Discovery. Morgan  Claypool. 2: 1126.</span>
</p>
</div>
                                                    
                                                    
<!--l. 3236--><p class="noindent" >
                                                    
                                                    
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter 3</span><br /><a 
 id="x1-1250003"></a>Artificial Neural Networks</h2>
<h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-1260003.1"></a>Neural Networks</h3>
<!--l. 3240--><p class="noindent" >A neural network is a network or circuit of neurons, or in a modern
sense, an artificial neural network, composed of artificial neurons or
nodes. <sup class="textsuperscript"><a 
href="#ennote-33" id="enmark-33"><span 
class="cmr-9">33</span></a></sup> Thus a neural network is either a biological neural
network, made up of biological neurons, or an artificial neural
network, for solving artificial intelligence (AI) problems. The
connections of the biological neuron are modeled as <span 
class="cmti-10">weights</span>. A
positive weight reflects an excited connection, while negative values
mean inhibitory connections. All inputs are modified by a weight
and summed. This activity is referred to as a <span 
class="cmti-10">linear combination</span>.
Finally, an activation function controls the amplitude of the output.
For example, an acceptable range of output is usually between 0
and 1, or it could be ?1 and 1. These artificial networks may be
used for predictive modeling, adaptive control and applications
where they can be trained via a dataset. Self-learning resulting
from experience can occur within networks, which can derive
conclusions from a complex and seemingly unrelated set of
information.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1260011"></a>
                                                    
                                                    
<!--l. 3244--><p class="noindent" ><img 
src="ann-ex.png" alt="PIC"  
width="142" height="142"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.1:</span><span  
class="content">ANN model. Obtained from Wikipedia.</span></figcaption><!--tex4ht:label?: x1-1260011 -->
                                                    
                                                    
</figure>
<h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-1270003.2"></a>Overview</h3>
<!--l. 3252--><p class="noindent" >A biological neural network is composed of a groups of chemically
connected or functionally associated neurons. A single neuron may
be connected to many other neurons and the total number
of neurons and connections in a network may be extensive.
Connections, called <span 
class="cmti-10">synapses</span>, are usually formed from <span 
class="cmti-10">axons</span>
to <span 
class="cmti-10">dendrites</span>. Apart from the electrical signaling, there are
other forms of signaling that arise from neurotransmitter
diffusion.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1270012"></a>
                                                    
                                                    
<!--l. 3256--><p class="noindent" ><img 
src="neuron.png" alt="PIC"  
width="256" height="85"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.2:</span><span  
class="content">Neurons</span></figcaption><!--tex4ht:label?: x1-1270012 -->
                                                    
                                                    
</figure>
<!--l. 3261--><p class="noindent" ><span 
class="cmti-10">Artificial intelligence, cognitive modeling, and neural networks are</span>
<span 
class="cmti-10">information processing paradigms inspired by the way biological</span>
<span 
class="cmti-10">neural systems process data</span>. Artificial intelligence and cognitive
modeling try to simulate some properties of biological neural
networks. In the artificial intelligence field, artificial neural
networks have been applied successfully to speech recognition,
image analysis and adaptive control, in order to construct
software agents (in computer and video games) or autonomous
robots.
</p><!--l. 3263--><p class="noindent" >Historically, digital computers evolved from the <span 
class="cmti-10">von Neumann</span>
<span 
class="cmti-10">model</span>, and operate via the execution of explicit instructions via
access to memory by a number of processors. On the other
hand, the origins of neural networks are based on efforts to
model information processing in biological systems. <span 
class="cmti-10">Unlike</span>
<span 
class="cmti-10">the von Neumann model, neural network computing does not</span>
<span 
class="cmti-10">separate memory and processing</span>. Neural network theory has
served both to better identify how the neurons in the brain
function and to provide the basis for efforts to create artificial
intelligence.
</p>
<h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-1280003.3"></a>History</h3>
<!--l. 3267--><p class="noindent" >The preliminary theoretical base for contemporary neural networks
was independently proposed by Alexander Bain (1873) and William
James (1890). <sup class="textsuperscript"><a 
href="#ennote-34" id="enmark-34"><span 
class="cmr-9">34</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-35" id="enmark-35"><span 
class="cmr-9">35</span></a></sup> In their work, both thoughts and body activity
resulted from interactions among neurons within the brain. For
<span 
class="cmti-10">Bain</span>, every activity led to the firing of a certain set of neurons.
When activities were repeated, the connections between those
neurons strengthened. According to his theory, this repetition was
what led to the formation of <span 
class="cmti-10">memory</span>. The general scientific
community at the time was skeptical of Bain’s theory because it
required what appeared to be an inordinate number of neural
connections within the brain. It is now apparent that the brain is
exceedingly complex and that the same brain wiring can handle
multiple problems and inputs. <span 
class="cmti-10">James’s </span>theory was similar to Bain’s,
however, he suggested that memories and actions resulted from
electrical currents flowing among the neurons in the brain. His
                                                    
                                                    
model, by focusing on the flow of electrical currents, did not
require individual neural connections for each memory or
action.
</p><!--l. 3269--><p class="noindent" ><span 
class="cmti-10">C. S. Sherrington </span>(1898) conducted experiments to test James’s
theory. He ran electrical currents down the spinal cords of rats.
However, instead of demonstrating an increase in electrical current
as projected by James, Sherrington found that the electrical current
strength decreased as the testing continued over time. Importantly,
this work led to the discovery of the concept of habituation.
<sup class="textsuperscript"><a 
href="#ennote-36" id="enmark-36"><span 
class="cmr-9">36</span></a></sup>
</p><!--l. 3271--><p class="noindent" ><span 
class="cmti-10">McCulloch </span>and <span 
class="cmti-10">Pitts </span>(1943) created a computational model for
neural networks based on mathematics and algorithms. They called
this model threshold logic. The model paved the way for neural
network research to split into two distinct approaches. One
approach focused on biological processes in the brain and the other
focused on the application of neural networks to artificial
intelligence. <sup class="textsuperscript"><a 
href="#ennote-37" id="enmark-37"><span 
class="cmr-9">37</span></a></sup>
</p><!--l. 3273--><p class="noindent" >In the late 1940s psychologist Donald Hebb created a hypothesis of
learning based on the mechanism of neural plasticity that is now
known as <span 
class="cmti-10">Hebbian learning</span>. Hebbian learning is considered to be a
typical unsupervised learning rule and its later variants were early
models for long term potentiation. These ideas started being
applied to computational models in 1948 with Turing’s B-type
machines. <span 
class="cmti-10">Hebb, Donald (1949). The Organization of Behavior.</span>
<span 
class="cmti-10">New York: Wiley. </span>Farley and Clark (1954) first used computational
machines, then called calculators, to simulate a Hebbian network at
MIT. Other neural network computational machines were
created by Rochester, Holland, Habit, and Duda (1956). <sup class="textsuperscript"><a 
href="#ennote-38" id="enmark-38"><span 
class="cmr-9">38</span></a></sup>
<sup class="textsuperscript"><a 
href="#ennote-39" id="enmark-39"><span 
class="cmr-9">39</span></a></sup>
</p><!--l. 3275--><p class="noindent" >Rosenblatt (1958) created the <span 
class="cmti-10">perceptron</span>, an algorithm for pattern
recognition based on a two-layer learning computer network
using simple addition and subtraction. With mathematical
notation, Rosenblatt also described circuitry not in the basic
perceptron, such as the exclusive-or circuit, a circuit whose
mathematical computation could not be processed until after the
backpropagation algorithm was created by Werbos (1975). <sup class="textsuperscript"><a 
href="#ennote-40" id="enmark-40"><span 
class="cmr-9">40</span></a></sup>
<sup class="textsuperscript"><a 
href="#ennote-41" id="enmark-41"><span 
class="cmr-9">41</span></a></sup>
</p><!--l. 3277--><p class="noindent" >Neural network research stagnated after the publication of machine
learning research by <span 
class="cmti-10">Marvin Minsky </span>and <span 
class="cmti-10">Seymour Papert </span>(1969).
                                                    
                                                    
They discovered two key issues with the computational machines
that processed neural networks. The first issue was that single-layer
neural networks were incapable of processing the exclusive-or
circuit. The second significant issue was that computers were not
sophisticated enough to effectively handle the long run time
required by large neural networks. Neural network research slowed
until computers achieved greater processing power. Also key
in later advances was the backpropagation algorithm which
effectively solved the exclusive-or problem (Werbos 1975). <sup class="textsuperscript"><a 
href="#ennote-42" id="enmark-42"><span 
class="cmr-9">42</span></a></sup> The
parallel distributed processing of the mid-1980s became popular
under the name <span 
class="cmti-10">connectionism</span>. The text by Rumelhart and
McClelland (1986) provided a full exposition on the use of
connectionism in computers to simulate neural processes.
<sup class="textsuperscript"><a 
href="#ennote-43" id="enmark-43"><span 
class="cmr-9">43</span></a></sup>
</p><!--l. 3279--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-1290003.4"></a>Artificial intelligence</h3>
<!--l. 3281--><p class="noindent" >A neural network (NN), in the case of artificial neurons called
artificial neural network (ANN) or simulated neural network (SNN),
is an interconnected group of natural or artificial neurons that uses
a mathematical or computational model for information processing
based on a connectionistic approach to computation. In most cases
an ANN is an adaptive system that changes its structure based on
external or internal information that flows through the network. In
more practical terms neural networks are <span 
class="cmti-10">non-linear </span>statistical data
modeling or decision making tools. They can be used to model
complex relationships between inputs and outputs or to find
patterns in data.
</p><!--l. 3283--><p class="noindent" >An artificial neural network involves a network of simple processing
elements (artificial neurons) which can exhibit complex global
behavior, determined by the connections between the processing
elements and element parameters. Artificial neurons were first
proposed in 1943 by Warren McCulloch, a neurophysiologist, and
Walter Pitts, a logician, who first collaborated at the University of
Chicago. <sup class="textsuperscript"><a 
href="#ennote-44" id="enmark-44"><span 
class="cmr-9">44</span></a></sup>
</p><!--l. 3285--><p class="noindent" >One classical type of artificial neural network is the recurrent
<span 
class="cmti-10">Hopfield network</span>. <sup class="textsuperscript"><a 
href="#ennote-45" id="enmark-45"><span 
class="cmr-9">45</span></a></sup> The concept of a neural network appears to
                                                    
                                                    
have first been proposed by Alan Turing in his 1948 paper
Intelligent Machinery in which he called them ”B-type unorganised
machines”. <sup class="textsuperscript"><a 
href="#ennote-46" id="enmark-46"><span 
class="cmr-9">46</span></a></sup>
</p><!--l. 3287--><p class="noindent" >The utility of artificial neural network models lies in the fact that
they can be used to infer a function from observations and also to
use it. Unsupervised neural networks can also be used to learn
representations of the input that capture the salient characteristics
of the input distribution, e.g., see the Boltzmann machine (1983),
and more recently, deep learning algorithms, which can implicitly
learn the distribution function of the observed data. Learning in
neural networks is particularly useful in applications where the
complexity of the data or task makes the design of such functions
by hand impractical.
</p><!--l. 3289--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-1300003.5"></a>Applications</h3>
<!--l. 3291--><p class="noindent" >Neural networks can be used in different fields. The tasks to which
artificial neural networks are applied tend to fall within the
following broad categories:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 3294--><p class="noindent" >Function approximation, or regression analysis, including
     time series prediction and modeling.
     </p></li>
     <li class="itemize">
     <!--l. 3295--><p class="noindent" >Classification, including pattern and sequence recognition,
     novelty detection and sequential decision making.
     </p></li>
     <li class="itemize">
     <!--l. 3296--><p class="noindent" >Data  processing,  including  filtering,  clustering,  blind
     signal separation and compression.</p></li></ul>
                                                    
                                                    
<!--l. 3299--><p class="noindent" >Application areas of ANNs include nonlinear system identification
and control (vehicle control, process control), game-playing and
decision making (backgammon, chess, racing), pattern recognition
(radar systems, face identification, object recognition), sequence
recognition (gesture, speech, handwritten text recognition), medical
diagnosis, financial applications, data mining (or knowledge
discovery in databases, “KDD”), visualization and e-mail spam
filtering. For example, it is possible to create a semantic profile
of user’s interests emerging from pictures trained for object
recognition.
</p><!--l. 3301--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.6   </span> <a 
 id="x1-1310003.6"></a>von Neumann architecture</h3>
<!--l. 3303--><p class="noindent" >The von Neumann architecturealso known as the von Neumann
model or Princeton architecture, is a computer architecture
based on a 1945 description by John von Neumann and
others in the First Draft of a Report on the EDVAC. <sup class="textsuperscript"><a 
href="#ennote-47" id="enmark-47"><span 
class="cmr-9">47</span></a></sup>
<span class="footnote-mark"><a 
href="ai3.html#fn1x4"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-131001f1"></a>
That document describes a design architecture for an electronic
digital computer with these components:
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 3306--><p class="noindent" >A processing unit that contains an arithmetic logic unit
     and processor registers
     </p></li>
     <li class="itemize">
     <!--l. 3307--><p class="noindent" >A control unit that contains an instruction register and
     program counter
     </p></li>
                                                    
                                                    
     <li class="itemize">
     <!--l. 3308--><p class="noindent" >Memory that stores data and instructions
     </p></li>
     <li class="itemize">
     <!--l. 3309--><p class="noindent" >External mass storage
     </p></li>
     <li class="itemize">
     <!--l. 3310--><p class="noindent" >Input and output mechanisms</p></li></ul>
<!--l. 3313--><p class="noindent" >The term “von Neumann architecture” has evolved to mean any
stored-program computer in which an instruction fetch and a data
operation cannot occur at the same time because they share a
common bus. This is referred to as the <span 
class="cmti-10">von Neumann bottleneck </span>and
often limits the performance of the system.
</p>
<h3 class="sectionHead"><span class="titlemark">3.7   </span> <a 
 id="x1-1320003.7"></a>Turing’s B-type machines</h3>
<!--l. 3317--><p class="noindent" >Also known as <span 
class="cmti-10">unorganized machine </span>is a concept mentioned in a
1948 report in which Alan Turing suggested that the infant
human cortex was what he called an ”unorganized machine”.
<sup class="textsuperscript"><a 
href="#ennote-48" id="enmark-48"><span 
class="cmr-9">48</span></a></sup>
</p><!--l. 3319--><p class="noindent" >Turing defined the class of unorganized machines as largely random
in their initial construction, but capable of being trained to perform
particular tasks. Turing’s unorganized machines were in fact very
early examples of randomly connected, binary neural networks, and
Turing claimed that these were the simplest possible model of the
nervous system.
</p><!--l. 3321--><p class="noindent" >In his 1948 paper Turing defined two examples of his unorganized
machines. The first were A-type machines  these being essentially
randomly connected networks of NAND logic gates. The second
were called B-type machines, which could be created by taking an
A-type machine and replacing every inter-node connection with a
structure called a connection modifier  which itself is made from
A-type nodes. The purpose of the connection modifiers were to
allow the B-type machine to undergo “appropriate interference,
mimicking education” in order to organize the behavior of the
                                                    
                                                    
network to perform useful work. Before the term genetic algorithm
was coined, Turing even proposed the use of what he called a
genetic search to configure his unorganized machines. Turing
claimed that the behavior of B-type machines could be very
complex when the number of nodes in the network was large, and
stated that the “picture of the cortex as an unorganized machine
is very satisfactory from the point of view of evolution and
genetics”. Turing had been interested in the possibility of
simulating neural systems for at least the previous two years.
<span class="footnote-mark"><a 
href="ai4.html#fn2x4"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-132001f2"></a>
</p>
<h3 class="sectionHead"><span class="titlemark">3.8   </span> <a 
 id="x1-1330003.8"></a>Hebbian Learning</h3>
<!--l. 3325--><p class="noindent" >Also known as <span 
class="cmti-10">Hebbian theory </span>is a neuroscientific theory claiming
that an increase in synaptic efficacy arises from a presynaptic cell’s
repeated and persistent stimulation of a postsynaptic cell. It is an
attempt to explain synaptic plasticity, the adaptation of brain
neurons during the learning process. It was introduced by Donald
Hebb in his 1949 book The Organization of Behavior. <sup class="textsuperscript"><a 
href="#ennote-49" id="enmark-49"><span 
class="cmr-9">49</span></a></sup> The theory
is also called Hebb’s rule, Hebb’s postulate, and cell assembly
theory.
</p><!--l. 3327--><p class="noindent" >The theory is often summarized as “Cells that fire together wire
together.” However, Hebb emphasized that cell A needs to ”take
part in firing” cell B, and such causality can occur only if cell A
fires just before, not at the same time as, cell B. This aspect of
causation in Hebb’s work foreshadowed what is now known about
spike-timing-dependent plasticity, which requires temporal
precedence.[3]
</p><!--l. 3329--><p class="noindent" >The theory attempts to explain associative or Hebbian learning, in
which simultaneous activation of cells leads to pronounced increases
in synaptic strength between those cells. It also provides a biological
basis for errorless learning methods for education and memory
                                                    
                                                    
rehabilitation. In the study of neural networks in cognitive function,
it is often regarded as the neuronal basis of unsupervised
learning.
</p><!--l. 3331--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.9   </span> <a 
 id="x1-1340003.9"></a>Python Practice</h3>
<!--l. 3333--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.9.1   </span> <a 
 id="x1-1350003.9.1"></a>Neural Networks</h4>
<!--l. 3341--><p class="noindent" >An Artificial Neural Network (ANN) is an information processing
paradigm that is inspired the brain. ANNs, like people, learn by
example. An ANN is configured for a specific application, such as
pattern recognition or data classification, through a learning
process. Learning largely involves adjustments to the synaptic
connections that exist between the neurons.
</p><!--l. 3343--><p class="noindent" >The brain consists of hundreds of billion of cells called neurons.
These neurons are connected together by synapses which
are nothing but the connections across which a neuron can
send an impulse to another neuron. When a neuron sends an
excitatory signal to another neuron, then this signal will be
added to all of the other inputs of that neuron. If it exceeds a
given threshold then it will cause the target neuron to fire an
action signal forward  this is how the thinking process works
internally.
</p><!--l. 3345--><p class="noindent" >In Computer Science, we model this process by creating networks
on a computer using matrices. These networks can be understood as
abstraction of neurons without all the biological complexities taken
into account. To keep things simple, we will just model a simple
NN, with two layers capable of solving linear classification
problem.
</p><!--l. 3347--><p class="noindent" >Lets say we have a problem where we want to predict output
given a set of inputs and outputs as training example like
so
                                                    
                                                    
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1350013"></a>
                                                    
                                                    
<!--l. 3351--><p class="noindent" ><img 
src="input_set.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.3:</span><span  
class="content">Input sets for NN problem</span></figcaption><!--tex4ht:label?: x1-1350013 -->
                                                    
                                                    
</figure>
<!--l. 3356--><p class="noindent" >Note that the output is directly related to third column i.e. the
values of input 3 is what the output is in every training example in
fig. 2. So for the test example output value should be 1. The
training process consists of the following steps:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-135003x1">
     <!--l. 3359--><p class="noindent" >Forward Propagation: Take the inputs, multiply by the
     weights (just use random numbers as weights) Let <!--l. 3359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msub><mrow 
><mi 
>I</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>I</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>I</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
><msub><mrow 
><mi 
>I</mi></mrow><mrow 
><mn>3</mn></mrow></msub 
></math>.
     Pass the result through a sigmoid formula to calculate the
     neurons output. The Sigmoid function is used to normalise
     the result between 0 and 1: <!--l. 3359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-bin">∕</mo><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mi 
>y</mi></mrow></msup 
></math>
     </p></li>
<li 
  class="enumerate" id="x1-135005x2">
     <!--l. 3360--><p class="noindent" >Back Propagation: Calculate the error i.e the difference
     between the actual output and the expected output. Depending
     on the error, adjust the weights by multiplying the error
     with the input and again with the gradient of the Sigmoid
     curve: <!--l. 3360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>W</mi><mi 
>e</mi><mi 
>i</mi><mi 
>g</mi><mi 
>h</mi><mi 
>t</mi><mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><mi 
>E</mi><mi 
>r</mi><mi 
>r</mi><mi 
>o</mi><mi 
>r</mi> <mo 
class="MathClass-bin">×</mo> <mi 
>I</mi><mi 
>n</mi><mi 
>p</mi><mi 
>u</mi><mi 
>t</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">×</mo> <mo 
class="MathClass-open">[</mo><mi 
>O</mi><mi 
>u</mi><mi 
>t</mi><mi 
>p</mi><mi 
>u</mi><mi 
>t</mi> <mo 
class="MathClass-bin">×</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>O</mi><mi 
>u</mi><mi 
>t</mi><mi 
>p</mi><mi 
>u</mi><mi 
>t</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">]</mo></math>
     ,here <!--l. 3360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mi 
>u</mi><mi 
>t</mi><mi 
>p</mi><mi 
>u</mi><mi 
>t</mi> <mo 
class="MathClass-bin">×</mo> <mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>O</mi><mi 
>u</mi><mi 
>t</mi><mi 
>p</mi><mi 
>u</mi><mi 
>t</mi><mo 
class="MathClass-close">)</mo></math>
     is derivative of sigmoid curve.</p></li></ol>
<!--l. 3363--><p class="noindent" >Repeat the whole process for a few thousands iterations. Lets
code up the whole process in Python. Well be using Numpy
library to help us with all the calculations on matrices easily.
Youd need to install numpy library on your system to run the
code
</p>
<!--l. 3365-->
<div class="lstlisting" id="listing-11"><span class="label"><a 
 id="x1-135006r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">joblib</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">numpy_pickle_utils</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">import</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">xrange</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135007r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-9">from</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">numpy</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">import</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135008r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135009r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135010r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-9">class</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">NeuralNet</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">object</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135011r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">def</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">__init__</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135012r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Generate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">random</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">numbers</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135013r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">random</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">seed</span><span 
class="cmtt-9">(1)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135014r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135015r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Assign</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">random</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weights</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">to</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">3</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">matrix</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135016r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">synaptic_weights</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">2</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">random</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">random</span><span 
class="cmtt-9">((3,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1)</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135017r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135018r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Sigmoid</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">function</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135019r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">def</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">__sigmoid</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135020r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">/</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">exp</span><span 
class="cmtt-9">(-</span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135021r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135022r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">derivative</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Sigmoid</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">function</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135023r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">This</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">is</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">gradient</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">of</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Sigmoid</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">curve</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135024r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">def</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">__sigmoid_derivative</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135025r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">(1</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">x</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135026r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135027r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Train</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">network</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">and</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">adjust</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weights</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">each</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">time</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135028r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">def</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">train</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">outputs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">training_iterations</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135029r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">for</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">iteration</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">in</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">xrange</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">training_iterations</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135030r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Pass</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">training</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">set</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">through</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">network</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135031r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">output</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">learn</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135032r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135033r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Calculate</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">error</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135034r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">error</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">outputs</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">-</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">output</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135035r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135036r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Adjust</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">weights</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">by</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">factor</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135037r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">factor</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">dot</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">T</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">error</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">*</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">__sigmoid_derivative</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">output</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135038r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">synaptic_weights</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">+=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">factor</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135039r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135040r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">network</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">thinks</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135041r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135042r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">def</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">learn</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135043r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">return</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">__sigmoid</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">dot</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">self</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">synaptic_weights</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135044r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135045r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135046r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-9">if</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">__name__</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">==</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9">__main__</span><span 
class="cmtt-9">&#x0022;</span><span 
class="cmtt-9">:</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135047r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Initialize</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135048r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural_network</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">NeuralNet</span><span 
class="cmtt-9">()</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135049r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135050r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">The</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">training</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">set</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135051r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">array</span><span 
class="cmtt-9">([[0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1],</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">[1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0],</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">[1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1]])</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135052r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">outputs</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">=</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">array</span><span 
class="cmtt-9">([[1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1]])</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">T</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135053r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135054r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Train</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">network</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135055r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural_network</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">train</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">inputs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">outputs</span><span 
class="cmtt-9">,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">10000)</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135056r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135057r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">#</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">Test</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">the</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">neural</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">network</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">with</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">a</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">test</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">example</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9"> </span><br /> 
<span class="label"><a 
 id="x1-135058r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">print</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">neural_network</span><span 
class="cmtt-9">.</span><span 
class="cmtt-9">learn</span><span 
class="cmtt-9">(</span><span 
class="cmtt-9">array</span><span 
class="cmtt-9">([1,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">0,</span><span 
class="cmtt-9"> </span><span 
class="cmtt-9">1])</span><span 
class="cmtt-9">)</span><span 
class="cmtt-9">)</span>
</div>
<!--l. 3421--><p class="noindent" >After 10 iterations our neural network predicts the value to be
0.65980921. It looks not good as the answer should really be 1. If we
increase the number of iterations to 100, we get 0.87680541. Our
network is getting smarter! Subsequently, for 10000 iterations we
                                                    
                                                    
get 0.9897704 which is pretty close and indeed a satisfactory
output.
</p>
<h3 class="sectionHead"><span class="titlemark">3.10   </span> <a 
 id="x1-1360003.10"></a>Feedforward networks</h3>
<!--l. 3598--><p class="noindent" >A feedforward neural network is an artificial neural network wherein
connections between the nodes do not form a cycle. <sup class="textsuperscript"><a 
href="#ennote-50" id="enmark-50"><span 
class="cmr-9">50</span></a></sup> As such, it is
different from its descendant: recurrent neural networks. The
feedforward neural network was the first and simplest type of
artificial neural network devised. <sup class="textsuperscript"><a 
href="#ennote-51" id="enmark-51"><span 
class="cmr-9">51</span></a></sup> In this network, the information
moves in only one directionforwardfrom the input nodes, through
the hidden nodes (if any) and to the output nodes. There are no
cycles or loops in the network.
</p><!--l. 3600--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.10.1   </span> <a 
 id="x1-1370003.10.1"></a>Single-layer perceptron</h4>
<!--l. 3602--><p class="noindent" >The simplest kind of neural network is a single-layer perceptron
network, which consists of a single layer of output nodes; the inputs
are fed directly to the outputs via a series of weights. The sum of
the products of the weights and the inputs is calculated in each
node, and if the value is above some threshold (typically 0) the
neuron fires and takes the activated value (typically 1); otherwise it
takes the deactivated value (typically -1). Neurons with this kind of
activation function are also called artificial neurons or linear
threshold units. In the literature the term perceptron often refers to
networks consisting of just one of these units. A similar neuron
was described by Warren McCulloch and Walter Pitts in the
1940s.
</p><!--l. 3604--><p class="noindent" >A perceptron can be created using any values for the activated and
deactivated states as long as the threshold value lies between the
two. Perceptrons can be trained by a simple learning algorithm that
is usually called the delta rule. It calculates the errors between
calculated output and sample output data, and uses this to create
an adjustment to the weights, thus implementing a form of gradient
descent.
                                                    
                                                    
</p><!--l. 3606--><p class="noindent" >Single-layer perceptrons are only capable of learning linearly
separable patterns; in 1969 in a famous monograph entitled
Perceptrons, Marvin Minsky and Seymour Papert showed that it
was impossible for a single-layer perceptron network to learn an
XOR function (nonetheless, it was known that multi-layer
perceptrons are capable of producing any possible boolean
function).
</p><!--l. 3608--><p class="noindent" >Although a single threshold unit is quite limited in its
computational power, it has been shown that networks of parallel
threshold units can approximate any continuous function from a
compact interval of the real numbers into the interval [-1,1]. This
result can be found in Peter Auer, Harald Burgsteiner and
Wolfgang Maass ”A learning rule for very simple universal
approximators consisting of a single layer of perceptrons”.
<sup class="textsuperscript"><a 
href="#ennote-52" id="enmark-52"><span 
class="cmr-9">52</span></a></sup>
</p><!--l. 3610--><p class="noindent" >A single-layer neural network can compute a continuous output
instead of a step function. A common choice is the so-called logistic
function:
</p>
<div class="center" 
>
<!--l. 3612--><p class="noindent" >
</p><!--l. 3613--><p class="noindent" ><!--l. 3613--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>    <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mi 
>x</mi></mrow></msup 
></mrow></mfrac></math></p></div>
<!--l. 3616--><p class="noindent" >With this choice, the single-layer network is identical to the logistic
regression model, widely used in statistical modeling. The
logistic function is one of the family of functions called sigmoid
functions because their S-shaped graphs resemble the final-letter
lower case of the Greek letter Sigma. It has a continuous
derivative, which allows it to be used in backpropagation.
This function is also preferred because its derivative is easily
calculated:
</p>
<div class="center" 
>
<!--l. 3618--><p class="noindent" >
                                                    
                                                    
</p><!--l. 3619--><p class="noindent" ><!--l. 3619--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-open">(</mo><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math></p></div>
<!--l. 3622--><p class="noindent" >(The fact that <!--l. 3622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi></math>
satisfies the differential equation above can easily be shown by
applying the chain rule.)
</p><!--l. 3624--><p class="noindent" >If single-layer neural network activation function is modulo
1, then this network can solve XOR problem with a single
neuron.
</p>
<div class="center" 
>
<!--l. 3626--><p class="noindent" >
</p><!--l. 3627--><p class="noindent" ><!--l. 3627--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mi 
>x</mi><mn>1</mn></math><br />
<!--l. 3628--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math></p></div>
<!--l. 3631--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.10.2   </span> <a 
 id="x1-1380003.10.2"></a>Multi-layer perceptron</h4>
<!--l. 3633--><p class="noindent" >This class of networks consists of multiple layers of computational
units, usually interconnected in a feed-forward way. Each neuron
in one layer has directed connections to the neurons of the
subsequent layer. In many applications the units of these networks
apply a sigmoid function as an activation function. However
sigmoidal activation functions have very small derivative values
outside a small range and do not work well in deep neural
networks due to the vanishing gradient problem. Alternatives to
sigmoidal activation functions that alleviate the vanishing gradient
problems and allow deep networks to be trained have been
proposed.
</p><!--l. 3635--><p class="noindent" >The universal approximation theorem for neural networks states
that every continuous function that maps intervals of real numbers
to some output interval of real numbers can be approximated
arbitrarily closely by a multi-layer perceptron with just one hidden
layer. This result holds for a wide range of activation functions, e.g.
for the sigmoidal functions.
                                                    
                                                    
</p><!--l. 3637--><p class="noindent" >Multi-layer networks use a variety of learning techniques, the most
popular being back-propagation. Here, the output values are
compared with the correct answer to compute the value of some
predefined error-function. By various techniques, the error is then
fed back through the network. Using this information, the algorithm
adjusts the weights of each connection in order to reduce the value
of the error function by some small amount. After repeating this
process for a sufficiently large number of training cycles, the
network will usually converge to some state where the error of
the calculations is small. In this case, one would say that
the network has learned a certain target function. To adjust
weights properly, one applies a general method for non-linear
optimization that is called gradient descent. For this, the network
calculates the derivative of the error function with respect
to the network weights, and changes the weights such that
the error decreases (thus going downhill on the surface of
the error function). For this reason, back-propagation can
only be applied on networks with differentiable activation
functions.
</p><!--l. 3639--><p class="noindent" >In general, the problem of teaching a network to perform
well, even on samples that were not used as training samples,
is a quite subtle issue that requires additional techniques.
This is especially important for cases where only very limited
numbers of training samples are available. The danger is that the
network overfits the training data and fails to capture the
true statistical process generating the data. Computational
learning theory is concerned with training classifiers on a
limited amount of data. In the context of neural networks a
simple heuristic, called early stopping, often ensures that the
network will generalize well to examples not in the training
set.
</p><!--l. 3641--><p class="noindent" >Other typical problems of the back-propagation algorithm are the
speed of convergence and the possibility of ending up in a local
minimum of the error function. Today, there are practical methods
that make back-propagation in multi-layer perceptrons the tool of
choice for many machine learning tasks. One also can use a series of
independent neural networks moderated by some intermediary, a
similar behavior that happens in brain. These neurons can perform
separably and handle a large task, and the results can be finally
combined.
                                                    
                                                    
</p><!--l. 3643--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.10.3   </span> <a 
 id="x1-1390003.10.3"></a>Other feedforward networks</h4>
<!--l. 3645--><p class="noindent" >More generally, any directed acyclic graph may be used for a
feedforward network, with some nodes (with no parents) designated
as inputs, and some nodes (with no children) designated as outputs.
These can be viewed as multilayer networks where some edges skip
layers, either counting layers backwards from the outputs or
forwards from the inputs. Various activation functions can be used,
and there can be relations between weights, as in convolutional
neural networks. Examples of other feedforward networks include
radial basis function networks, which use a different activation
function. Sometimes multi-layer perceptron is used loosely to refer
to any feedforward neural network, while in other cases it is
restricted to specific ones (e.g., with specific activation functions,
or with fully connected layers, or trained by the perceptron
algorithm).
</p><!--l. 3647--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.10.4   </span> <a 
 id="x1-1400003.10.4"></a>Python practice</h4>
<!--l. 3649--><p class="noindent" >The goal of neural networks in general is to approximate some function
<!--l. 3649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi></math>. The
Universal Approximation Theorem says neural networks have the
capacity to accomplish this for a large class of functions. In this
case, we seek to approximate the function that generates a binary
classification problem. We can model this with the binary random
variable <!--l. 3649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi> <mo 
class="MathClass-rel">|</mo><mi 
>X</mi> <mo 
class="MathClass-punc">:</mo> <mi 
>ω</mi> <mo 
class="MathClass-rel">→</mo><mo 
class="MathClass-open">{</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-close">}</mo></math>
with conditional distribution
</p>
<div class="center" 
>
<!--l. 3651--><p class="noindent" >
                                                    
                                                    
</p><!--l. 3652--><p class="noindent" >p(x) = P(Y = y — X = x) = P(Y = 1 — X = x)ˆy (1 - P(Y
= 1 — X = x))ˆ1 - y</p></div>
<!--l. 3655--><p class="noindent" >which we seek to approximate. Instead of approximating this
directly, we divide the function up and approximate each value
y takes. Since this is binary classification, we only need to
approximate
</p>
<div class="center" 
>
<!--l. 3657--><p class="noindent" >
</p><!--l. 3658--><p class="noindent" >P(Y = 1 — X = x) : Rˆ2
<!--l. 3658--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">→</mo> <mo 
class="MathClass-open">[</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-close">]</mo><mo 
class="MathClass-punc">.</mo></math>
</p>
</div>
<!--l. 3661--><p class="noindent" >Since this is a probability function, we will use relative entropy as a
measure of distance, which is typically called a loss function. In
order to approximate the relative entropy, we sample i.i.d.
</p>
<div class="center" 
>
<!--l. 3663--><p class="noindent" >
</p><!--l. 3664--><p class="noindent" >(y˙i, X˙i)˙i = 1ˆn</p></div>
<!--l. 3667--><p class="noindent" >with
</p>
<div class="center" 
>
<!--l. 3669--><p class="noindent" >
</p><!--l. 3670--><p class="noindent" >D(p —— p^) =
<!--l. 3670--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
class="MathClass-op">∫</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--><!--nolimits--></mrow><mrow 
><msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></msub 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow 
><mi 
>p</mi></mrow>
<mrow 
><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mi 
>p</mi><mi 
>d</mi><mi 
>m</mi><br /></math>
</p><!--l. 3671--><p class="noindent" ><!--l. 3671--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">≈</mo><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow>
<mrow 
><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mi 
>p</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><br /></math>
                                                    
                                                    
</p><!--l. 3672--><p class="noindent" ><!--l. 3672--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mo 
class="MathClass-rel">≈</mo><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--> <mrow><mo fence="true" form="prefix"> (</mo><mrow> <mfrac><mrow 
><mi 
>p</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow>
<mrow 
><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow></mfrac> </mrow><mo fence="true" form="postfix">)</mo></mrow> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><br /></math>
</p>
</div>
<!--l. 3675--><p class="noindent" >where <!--l. 3675--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi></math>
is Lebesgue measure. Since p is unknown, we minimize the
estimated loss,
</p>
<div class="center" 
>
<!--l. 3677--><p class="noindent" >
</p><!--l. 3678--><p class="noindent" >D^(p —— p^) =
-<!--l. 3678--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo> <mfrac><mrow 
><mn>1</mn></mrow>
<mrow 
><mi 
>n</mi></mrow></mfrac><br /></math>
</p><!--l. 3679--><p class="noindent" >=
-<mfrac><mrow 
>1</mrow><!--l. 3679--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" >                          <mrow 
><mi 
>n</mi></mrow></mfrac><msubsup><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> <!--nolimits--></mrow><mrow 
>
<mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></msubsup 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><mi 
>p</mi></mrow><mo accent="true">^</mo></mover><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">.</mo></math>
</p>
</div>
<!--l. 3682--><p class="noindent" >We define the single hidden layer neural network. Let W denote the weights
and b be the intercept or bias term. We use sigmoid activations denoted
by <!--l. 3682--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi></math>,
but <!--l. 3682--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>R</mi><mi 
>e</mi><mi 
>l</mi><mi 
>u</mi></math>
is generally preferred. The hidden layer
</p>
<div class="center" 
>
<!--l. 3684--><p class="noindent" >
</p><!--l. 3685--><p class="noindent" >H(X) =
<!--l. 3685--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi 
>X</mi><msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>h</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>h</mi></mrow></msub 
></mrow><mo fence="true" form="postfix">)</mo></mrow></math>
</p>
</div>
<!--l. 3688--><p class="noindent" >and output layer
</p>
                                                    
                                                    
<div class="center" 
>
<!--l. 3690--><p class="noindent" >
</p><!--l. 3691--><p class="noindent" >O(X) =
<!--l. 3691--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>σ</mi> <mrow><mo fence="true" form="prefix"> (</mo><mrow><mi 
>h</mi><mo 
class="MathClass-open">(</mo><mi 
>X</mi><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>o</mi></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>o</mi></mrow></msub 
></mrow><mo fence="true" form="postfix">)</mo></mrow></math>
</p>
</div>
<!--l. 3694--><p class="noindent" >The neural network is fit using gradient descent with the gradients
computed using algorithmic differentiation. These are implemented
naively for simplicity and are not using advanced algorithms
as would be in practice. We generate data using Sklearn’s
<!--l. 3694--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>a</mi><mi 
>k</mi><mi 
>e</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>c</mi><mi 
>i</mi><mi 
>r</mi><mi 
>c</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi></math>
function, split it into a training and test set, and plot with
Matplotlib.
</p>
<!--l. 3696--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">make_circles</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor13244"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1000</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8"> </span><span id="textcolor13250"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">n_ouputs</span><span 
class="cmtt-8"> </span><span id="textcolor13256"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor13265"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">make_circles</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor13272"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">factor</span><span 
class="cmtt-8"> </span><span id="textcolor13280"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">01</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">noise</span><span 
class="cmtt-8"> </span><span id="textcolor13289"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">n_TRAIN</span><span 
class="cmtt-8"> </span><span id="textcolor13297"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">int</span><span 
class="cmtt-8">(.</span><span 
class="cmtt-8">75</span><span 
class="cmtt-8"> </span><span id="textcolor13304"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8"> </span><span id="textcolor13311"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span id="textcolor13315"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor13318"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">n_TRAIN</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor13323"><span 
class="cmtt-8">:</span></span><span id="textcolor13325"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8"> </span><span id="textcolor13329"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span id="textcolor13333"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor13336"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">n_TRAIN</span><span id="textcolor13339"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8"> </span><span id="textcolor13343"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span id="textcolor13347"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n_TRAIN</span><span id="textcolor13350"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor13355"><span 
class="cmtt-8">:</span></span><span id="textcolor13357"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><span id="textcolor13361"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span id="textcolor13365"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">n_TRAIN</span><span id="textcolor13368"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">n_samples</span><span id="textcolor13371"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8">fig</span><span 
class="cmtt-8"> </span><span id="textcolor13375"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">figure</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">figsize</span><span id="textcolor13383"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">scatter</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span id="textcolor13397"><span 
class="cmtt-8">[</span></span><span id="textcolor13399"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">0</span><span id="textcolor13403"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span id="textcolor13408"><span 
class="cmtt-8">[</span></span><span id="textcolor13410"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">1</span><span id="textcolor13414"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">c</span><span 
class="cmtt-8"> </span><span id="textcolor13420"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">xlabel</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">X1</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ylabel</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">X2</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">savefig</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">nn_plot</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pdf</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">bbox_inches</span><span id="textcolor13453"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">tight</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140021r21"></a><span 
class="cmr-5">21</span></span></pre>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1400224"></a>
                                                    
                                                    
<!--l. 3720--><p class="noindent" ><img 
src="ff1.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.4:</span><span  
class="content">Circular data</span></figcaption><!--tex4ht:label?: x1-1400224 -->
                                                    
                                                    
</figure>
<!--l. 3725--><p class="noindent" >The neural network implementation
</p>
<!--l. 3727--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140023r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">class</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">NN</span><span 
class="cmtt-8">()</span><span id="textcolor13463"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140024r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">__init__</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8"> </span><span id="textcolor13483"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span id="textcolor13488"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140025r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor13494"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140026r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8"> </span><span id="textcolor13502"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140027r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8"> </span><span id="textcolor13510"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140028r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8"> </span><span id="textcolor13518"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140029r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140030r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_h</span><span 
class="cmtt-8"> </span><span id="textcolor13526"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">randn</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140031r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_h</span><span 
class="cmtt-8"> </span><span id="textcolor13544"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">01</span><span 
class="cmtt-8"> </span><span id="textcolor13550"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">zeros</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140032r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_o</span><span 
class="cmtt-8"> </span><span id="textcolor13567"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">randn</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140033r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_o</span><span 
class="cmtt-8"> </span><span id="textcolor13585"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">01</span><span 
class="cmtt-8"> </span><span id="textcolor13591"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">zeros</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140034r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140035r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">)</span><span id="textcolor13613"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140036r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor13618"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor13623"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">exp</span><span 
class="cmtt-8">(</span><span id="textcolor13630"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140037r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140038r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">loss</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p_pred</span><span 
class="cmtt-8">)</span><span id="textcolor13647"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140039r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span id="textcolor13651"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">1</span><span id="textcolor13654"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span id="textcolor13659"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor13662"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor13665"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sum</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor13675"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">log</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">p_pred</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor13685"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor13691"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor13697"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">log</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor13707"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p_pred</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140040r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140041r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span id="textcolor13724"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140042r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">squeeze</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">round</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">forward_prop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span id="textcolor13742"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">O</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13747"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140043r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140044r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward_prop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span id="textcolor13760"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140045r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Hidden</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140046r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8"> </span><span id="textcolor13769"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_h</span><span 
class="cmtt-8"> </span><span id="textcolor13780"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_h</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140047r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">H</span><span 
class="cmtt-8"> </span><span id="textcolor13788"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140048r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140049r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Output</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140050r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A_o</span><span 
class="cmtt-8"> </span><span id="textcolor13804"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">H</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_o</span><span 
class="cmtt-8"> </span><span id="textcolor13815"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_o</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140051r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">O</span><span 
class="cmtt-8"> </span><span id="textcolor13823"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A_o</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140052r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140053r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13838"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140054r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">H</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13846"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">H</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140055r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">A_o</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13854"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A_o</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140056r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">O</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13862"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">O</span><span class="lstinline"></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140057r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140058r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140059r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">This</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">is</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">not</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">a</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">true</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">implmentation</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">backprop</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140060r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">backward_prop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward</span><span 
class="cmtt-8">)</span><span id="textcolor13899"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140061r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one_n</span><span 
class="cmtt-8"> </span><span id="textcolor13903"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ones</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140062r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor13916"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y_</span><span id="textcolor13921"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">newaxis</span><span id="textcolor13926"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">convert</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">column</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vector</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140063r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140064r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_o</span><span 
class="cmtt-8"> </span><span id="textcolor13943"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor13949"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward</span><span id="textcolor13953"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">O</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13958"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140065r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_dW_o</span><span 
class="cmtt-8"> </span><span id="textcolor13963"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor13967"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor13973"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward</span><span id="textcolor13977"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">H</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor13982"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_o</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140066r44"></a><span 
class="cmr-5">44</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_db_o</span><span 
class="cmtt-8"> </span><span id="textcolor13992"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor13996"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor14002"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one_n</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_o</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140067r45"></a><span 
class="cmr-5">45</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140068r46"></a><span 
class="cmr-5">46</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_h</span><span 
class="cmtt-8"> </span><span id="textcolor14014"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">dA_o</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_o</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor14029"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">forward</span><span id="textcolor14038"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14043"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor14047"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor14053"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">forward</span><span id="textcolor14061"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">A_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14066"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140069r47"></a><span 
class="cmr-5">47</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_dW_h</span><span 
class="cmtt-8"> </span><span id="textcolor14073"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor14077"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor14083"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_h</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140070r48"></a><span 
class="cmr-5">48</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_db_h</span><span 
class="cmtt-8"> </span><span id="textcolor14095"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor14099"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor14105"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one_n</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">@</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dA_h</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140071r49"></a><span 
class="cmr-5">49</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140072r50"></a><span 
class="cmr-5">50</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140073r51"></a><span 
class="cmr-5">51</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_dW_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14121"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_dW_h</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140074r52"></a><span 
class="cmr-5">52</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_db_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14129"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_db_h</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140075r53"></a><span 
class="cmr-5">53</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_dW_o</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14137"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_dW_o</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140076r54"></a><span 
class="cmr-5">54</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_db_o</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14145"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dL_db_o</span><span class="lstinline"></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140077r55"></a><span 
class="cmr-5">55</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">}</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140078r56"></a><span 
class="cmr-5">56</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140079r57"></a><span 
class="cmr-5">57</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14165"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">max_iter</span><span 
class="cmtt-8"> </span><span id="textcolor14174"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1001</span><span 
class="cmtt-8">)</span><span id="textcolor14179"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140080r58"></a><span 
class="cmr-5">58</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">max_iter</span><span 
class="cmtt-8">)</span><span id="textcolor14194"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140081r59"></a><span 
class="cmr-5">59</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward_prop_dict</span><span 
class="cmtt-8"> </span><span id="textcolor14198"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">forward_prop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140082r60"></a><span 
class="cmr-5">60</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">G</span><span 
class="cmtt-8"> </span><span id="textcolor14209"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">backward_prop</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">forward_prop_dict</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140083r61"></a><span 
class="cmr-5">61</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140084r62"></a><span 
class="cmr-5">62</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Gradient</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">step</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140085r63"></a><span 
class="cmr-5">63</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_h</span><span 
class="cmtt-8"> </span><span id="textcolor14233"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_h</span><span 
class="cmtt-8"> </span><span id="textcolor14240"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14245"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">G</span><span id="textcolor14249"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_dW_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14254"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140086r64"></a><span 
class="cmr-5">64</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_h</span><span 
class="cmtt-8"> </span><span id="textcolor14260"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_h</span><span 
class="cmtt-8"> </span><span id="textcolor14267"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14272"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">G</span><span id="textcolor14276"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_db_h</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14281"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140087r65"></a><span 
class="cmr-5">65</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140088r66"></a><span 
class="cmr-5">66</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_o</span><span 
class="cmtt-8"> </span><span id="textcolor14287"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">W_o</span><span 
class="cmtt-8"> </span><span id="textcolor14294"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14299"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">G</span><span id="textcolor14303"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_dW_o</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14308"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140089r67"></a><span 
class="cmr-5">67</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_o</span><span 
class="cmtt-8"> </span><span id="textcolor14314"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">b_o</span><span 
class="cmtt-8"> </span><span id="textcolor14321"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14326"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">G</span><span id="textcolor14330"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">dL_db_o</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14335"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140090r68"></a><span 
class="cmr-5">68</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140091r69"></a><span 
class="cmr-5">69</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">100</span><span 
class="cmtt-8"> </span><span id="textcolor14345"><span 
class="cmtt-8">=</span></span><span id="textcolor14347"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor14351"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140092r70"></a><span 
class="cmr-5">70</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">f</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Iteration</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8">i</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Training</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Loss</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8">self</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">loss</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">squeeze</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">forward_prop_dict</span><span 
class="cmtt-8">[’</span><span 
class="cmtt-8">O</span><span 
class="cmtt-8">’])</span><span 
class="cmtt-8">)</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140093r71"></a><span 
class="cmr-5">71</span></span></pre>
<!--l. 3800--><p class="noindent" >We use 10 hidden units in the hidden layer and report the 0-1
accuracy on both the training and test sets.
</p>
<!--l. 3802--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140094r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">nn</span><span 
class="cmtt-8"> </span><span id="textcolor14392"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">NN</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor14399"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_TRAIN</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8"> </span><span id="textcolor14407"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_features</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_outputs</span><span 
class="cmtt-8"> </span><span id="textcolor14415"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_ouputs</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_hidden</span><span 
class="cmtt-8"> </span><span id="textcolor14423"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140095r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">nn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">train</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140096r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140097r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Train</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor14448"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span id="textcolor14453"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor14456"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor14459"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sum</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">nn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor14473"><span 
class="cmtt-8">=</span></span><span id="textcolor14475"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140098r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Test</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor14492"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span id="textcolor14497"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor14500"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor14503"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sum</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">nn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor14517"><span 
class="cmtt-8">=</span></span><span id="textcolor14519"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-140099r6"></a><span 
class="cmr-5">6</span></span></pre>
<!--l. 3810--><p class="noindent" >Output
                                                    
                                                    
</p>
<pre class="verbatim" id="verbatim-6">
Iteration: 0, Training Loss: 0.7119608071592811
Iteration: 100, Training Loss: 0.639833196437629
Iteration: 200, Training Loss: 0.5215796424999427
Iteration: 300, Training Loss: 0.368528633036507
Iteration: 400, Training Loss: 0.25561713311943096
Iteration: 500, Training Loss: 0.1887819942694729
Iteration: 600, Training Loss: 0.14915555078792483
Iteration: 700, Training Loss: 0.12416122322345967
Iteration: 800, Training Loss: 0.10734573047261009
Iteration: 900, Training Loss: 0.0953975198921105
Iteration: 1000, Training Loss: 0.08652396074499336
Train accuracy: 0.9906666666666666
Test accuracy: 0.992</pre>
<!--l. 3826--><p class="nopar" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.11   </span> <a 
 id="x1-1410003.11"></a>Backpropagation network</h3>
<!--l. 3831--><p class="noindent" >In machine learning, backpropagation is a widely used algorithm
for training feedforward neural networks. Generalizations of
backpropagation exist for other artificial neural networks (ANNs),
and for functions generally. These classes of algorithms are all
referred to generically as “backpropagation”. In fitting a neural
network, backpropagation computes the gradient of the loss
function with respect to the weights of the network for a
single inputoutput example, and does so efficiently, unlike
a naive direct computation of the gradient with respect to
each weight individually. This efficiency makes it feasible
to use gradient methods for training multilayer networks,
updating weights to minimize loss; gradient descent, or variants
such as stochastic gradient descent, are commonly used. The
backpropagation algorithm works by computing the gradient of
the loss function with respect to each weight by the chain
rule, computing the gradient one layer at a time, iterating
                                                    
                                                    
backward from the last layer to avoid redundant calculations of
intermediate terms in the chain rule; this is an example of dynamic
programming.
</p><!--l. 3833--><p class="noindent" >The term backpropagation strictly refers only to the algorithm for
computing the gradient, not how the gradient is used; however, the
term is often used loosely to refer to the entire learning algorithm,
including how the gradient is used, such as by stochastic gradient
descent. Backpropagation generalizes the gradient computation in
the delta rule, which is the single-layer version of backpropagation,
and is in turn generalized by automatic differentiation, where
backpropagation is a special case of reverse accumulation (or
“reverse mode”). The term backpropagation and its general use in
neural networks was announced in Rumelhart, Hinton &#x0026; Williams
(1986a), then elaborated and popularized in Rumelhart, Hinton
&#x0026; Williams (1986b), but the technique was independently
rediscovered many times, and had many predecessors dating to
the 1960s; see  History. A modern overview is given in the
deep learning textbook by Goodfellow, Bengio  Courville
(2016).
</p><!--l. 3835--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.11.1   </span> <a 
 id="x1-1420003.11.1"></a>Overview</h4>
<!--l. 3837--><p class="noindent" >Backpropagation computes the gradient in weight space of a
feedforward neural network, with respect to a loss function.
Denote:
</p><!--l. 3839--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-142002x1">
     <!--l. 3840--><p class="noindent" ><!--l. 3840--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>:
     input (vector of features)
     </p></li>
<li 
  class="enumerate" id="x1-142004x2">
     <!--l. 3841--><p class="noindent" ><!--l. 3841--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>:
                                                    
                                                    
     target output For classification, output will be a vector of
     class probabilities (e.g., <!--l. 3842--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>7</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>2</mn><mo 
class="MathClass-close">)</mo></math>,
     and target output is a specific class, encoded by the one-hot/dummy
     variable (e.g., <!--l. 3842--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></math>.
     </p></li>
<li 
  class="enumerate" id="x1-142006x3">
     <!--l. 3843--><p class="noindent" ><!--l. 3843--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi></math>:
     loss function or “cost function” For classification, this is
     usually cross entropy (XC, log loss), while for regression
     it is usually squared error loss (SEL).
     </p></li>
<li 
  class="enumerate" id="x1-142008x4">
     <!--l. 3845--><p class="noindent" ><!--l. 3845--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>:
     the number of layers
     </p></li>
<li 
  class="enumerate" id="x1-142010x5">
     <!--l. 3846--><p class="noindent" ><!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>l</mi></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-open">(</mo><msubsup><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>j</mi><mi 
>k</mi></mrow><mrow 
><mi 
>l</mi></mrow></msubsup 
><mo 
class="MathClass-close">)</mo></math>:
     the weights between layer <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>
     and <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi></math>,
     where <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>j</mi><mi 
>k</mi></mrow><mrow 
><mi 
>l</mi></mrow></msubsup 
></math>
     is the weight between the <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>t</mi><mi 
>h</mi></math>
     node in layer <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi> <mo 
class="MathClass-bin">−</mo> <mn>1</mn></math>
     and the <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>j</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>t</mi><mi 
>h</mi></math>
     node in layer <!--l. 3846--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi></math>
     </p></li>
<li 
  class="enumerate" id="x1-142012x6">
     <!--l. 3847--><p class="noindent" ><!--l. 3847--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>l</mi></mrow></msup 
></math>:
     activation functions at layer <!--l. 3847--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi></math>
     For classification the last layer is usually the logistic function
     for binary classification, and <span 
class="cmti-10">softmax </span>(<span 
class="cmti-10">softargmax</span>) for multi-class
     classification, while for the hidden layers this was traditionally
     a <span 
class="cmti-10">sigmoid function </span>(logistic function or others) on each
     node (coordinate), but today is more varied, with rectifier
     (<span 
class="cmti-10">ramp, ReLU</span>) being common.</p></li></ol>
                                                    
                                                    
<!--l. 3851--><p class="noindent" >In the derivation of backpropagation, other intermediate quantities
are used; they are introduced as needed below. Bias terms are not
treated specially, as they correspond to a weight with a fixed input
of 1. For the purpose of backpropagation, the specific loss function
and activation functions do not matter, as long as they and their
derivatives can be evaluated efficiently. Traditional activation
functions include but are not limited to sigmoid, tanh, and ReLU.
Since, swish, mish, and other activation functions were proposed as
well. The overall network is a combination of function composition
and matrix multiplication:
</p>
<div class="center" 
>
<!--l. 3853--><p class="noindent" >
</p><!--l. 3854--><p class="noindent" ><!--l. 3854--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-punc">:</mo><mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>L</mi></mrow></msup 
><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mi 
>L</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>L</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
><mo 
class="MathClass-rel">⋯</mo><msup><mrow 
><mi 
>f</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>W</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-rel">⋯</mo><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math></p></div>
<!--l. 3857--><p class="noindent" >For a training set there will be a set of inputoutput pairs,
<!--l. 3857--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" > <mrow><mo fence="true" form="prefix"> {</mo><mrow><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow><mo fence="true" form="postfix">}</mo></mrow></math>. For each
inputoutput pair <!--l. 3857--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>
in the training set, the loss of the model on that pair is
the cost of the difference between the predicted output
<!--l. 3857--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math> and the target
output <!--l. 3857--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>:
</p>
<div class="center" 
>
<!--l. 3859--><p class="noindent" >
</p><!--l. 3860--><p class="noindent" ><!--l. 3860--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>C</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>g</mi><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math></p></div>
<!--l. 3863--><p class="noindent" >During model evaluation, the weights are fixed, while the
inputs vary (and the target output may be unknown), and the
network ends with the output layer (it does not include the loss
function). During model training, the inputoutput pair is fixed,
while the weights vary, and the network ends with the loss
function.
</p><!--l. 3865--><p class="noindent" >Backpropagation computes the gradient for a fixed inputoutput pair
                                                    
                                                    
<!--l. 3865--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>, where the
weights <!--l. 3865--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>j</mi><mi 
>k</mi></mrow><mrow 
><mi 
>l</mi></mrow></msubsup 
></math>
can vary. Each individual component of the gradient,
<!--l. 3865--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>∂</mi><mi 
>C</mi><mo 
class="MathClass-bin">∕</mo><mi 
>∂</mi><msubsup><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>j</mi><mi 
>k</mi></mrow><mrow 
><mi 
>l</mi></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo></math>
can be computed by the chain rule; however, doing this
separately for each weight is inefficient. Backpropagation
efficiently computes the gradient by avoiding duplicate
calculations and not computing unnecessary intermediate
values, by computing the gradient of each layer  specifically,
the gradient of the weighted input of each layer, denoted by
<!--l. 3865--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>δ</mi></mrow><mrow 
><mi 
>l</mi></mrow></msup 
></math>
from back to front.
</p><!--l. 3867--><p class="noindent" >Informally, the key point is that since the only way a weight in
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>W</mi></mrow><mrow 
><mi 
>l</mi></mrow></msup 
></math> affects
the loss is through its effect on the next layer, and it does so linearly,
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>δ</mi></mrow><mrow 
><mi 
>l</mi></mrow></msup 
></math> are the
only data you need to compute the gradients of the weights at layer
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi></math>,
and then you can compute the previous layer
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>δ</mi></mrow><mrow 
><mi 
>l</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></math> and
repeat recursively. This avoids inefficiency in two ways. Firstly, it
avoids duplication because when computing the gradient at layer
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi></math>, you
do not need to recompute all the derivatives on later layers
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>l</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></math> each
time. Secondly, it avoids unnecessary intermediate calculations
because at each stage it directly computes the gradient of
the weights with respect to the ultimate output (the loss),
rather than unnecessarily computing the derivatives of the
values of hidden layers with respect to changes in weights
<!--l. 3867--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>a</mi></mrow><mrow 
><msup><mrow 
><mi 
>j</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></mrow><mrow 
><msup><mrow 
><mi 
>l</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
>
  </mrow></msubsup 
><mo 
class="MathClass-bin">∕</mo><mi 
>∂</mi><msubsup><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>j</mi><mi 
>k</mi></mrow><mrow 
><mi 
>l</mi></mrow></msubsup 
></math>.
</p><!--l. 3869--><p class="noindent" >Backpropagation can be expressed for simple feedforward networks
in terms of matrix multiplication, or more generally in terms of the
adjoint graph.
</p><!--l. 3871--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.11.2   </span> <a 
 id="x1-1430003.11.2"></a>Learning as an optimization problem</h4>
                                                    
                                                    
<!--l. 3873--><p class="noindent" >To understand the mathematical derivation of the backpropagation
algorithm, it helps to first develop some intuition about the
relationship between the actual output of a neuron and the correct
output for a particular training example. Consider a simple neural
network with two input units, one output unit and no hidden
units, and in which each neuron uses a linear output (unlike
most work on neural networks, in which mapping from inputs
to outputs is non-linear)[g] that is the weighted sum of its
input.
</p><!--l. 3875--><p class="noindent" >Initially, before training, the weights will be set randomly. Then the
neuron learns from training examples, which in this case consist of a set
of tuples <!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>t</mi><mo 
class="MathClass-close">)</mo></math>
where <!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
and <!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
are the inputs to the network and t is the correct output
(the output the network should produce given those inputs,
when it has been trained). The initial network, given
<!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> and
<!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>, will compute
an output <!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math>
that likely differs from t (given random weights). A loss function
<!--l. 3875--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mo 
class="MathClass-open">(</mo><mi 
>t</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo></math> is
used for measuring the discrepancy between the target output t and
the computed output y. For regression analysis problems the
squared error can be used as a loss function, for classification the
categorical crossentropy can be used.
</p><!--l. 3877--><p class="noindent" >As an example consider a regression problem using the square error
as a loss:
</p>
<div class="center" 
>
<!--l. 3879--><p class="noindent" >
</p><!--l. 3880--><p class="noindent" ><!--l. 3880--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mo 
class="MathClass-open">(</mo><mi 
>t</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>t</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>y</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>E</mi><mo 
class="MathClass-punc">,</mo></math></p></div>
<!--l. 3883--><p class="noindent" >where <span 
class="cmti-10">E </span>is the discrepancy or error.
</p><!--l. 3885--><p class="noindent" >Consider the network on a single training case:
<!--l. 3885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>0</mn><mo 
class="MathClass-close">)</mo></math>. Thus,
the input <!--l. 3885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
                                                    
                                                    
and <!--l. 3885--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
are 1 and 1 respectively and the correct output, <span 
class="cmti-10">t </span>is 0. Now if the
relation is plotted between the network’s output y on the horizontal
axis and the error E on the vertical axis, the result is a parabola.
The minimum of the parabola corresponds to the output y
which minimizes the error E. For a single training case, the
minimum also touches the horizontal axis, which means the error
will be zero and the network can produce an output y that
exactly matches the target output t. Therefore, the problem of
mapping inputs to outputs can be reduced to an optimization
problem of finding a function that will produce the minimal
error.
</p><!--l. 3887--><p class="noindent" >However, the output of a neuron depends on the weighted sum of
all its inputs:
</p>
<div class="center" 
>
<!--l. 3889--><p class="noindent" >
</p><!--l. 3890--><p class="noindent" ><!--l. 3890--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo></math></p></div>
<!--l. 3893--><p class="noindent" >where <!--l. 3893--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
and <!--l. 3893--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
are the weights on the connection from the input units to the
output unit. Therefore, the error also depends on the incoming
weights to the neuron, which is ultimately what needs to be
changed in the network to enable learning.
</p><!--l. 3895--><p class="noindent" >In this example, upon injecting the training data the loss function
becomes
</p>
<div class="center" 
>
<!--l. 3897--><p class="noindent" >
</p><!--l. 3898--><p class="noindent" ><!--l. 3898--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>t</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>y</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">.</mo></math></p></div>
<!--l. 3902--><p class="noindent" >Then, the loss function <!--l. 3902--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi></math>
takes the form of a parabolic cylinder with its base directed along
                                                    
                                                    
<!--l. 3902--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>. Since all sets of
weights that satisfy <!--l. 3902--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>
minimize the loss function, in this case additional constraints are
required to converge to a unique solution. Additional constraints
could either be generated by setting specific conditions to the
weights, or by injecting additional training data.
</p><!--l. 3904--><p class="noindent" >One commonly used algorithm to find the set of weights that
minimizes the error is gradient descent. By backpropagation, the
steepest descent direction is calculated of the loss function versus
the present synaptic weights. Then, the weights can be modified
along the steepest descent direction, and the error is minimized in
an efficient way.
</p><!--l. 3906--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.11.3   </span> <a 
 id="x1-1440003.11.3"></a>Loss function</h4>
<!--l. 3908--><p class="noindent" >The loss function is a function that maps values of one or more
variables onto a real number intuitively representing some ”cost”
associated with those values. For backpropagation, the loss function
calculates the difference between the network output and its
expected output, after a training example has propagated through
the network.
</p><!--l. 3910--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1450003.11.3"></a>Assumptions</h5>
<!--l. 3911--><p class="noindent" >The mathematical expression of the loss function must
fulfill two conditions in order for it to be possibly used in
backpropagation. The first is that it can be written as an average
<!--l. 3911--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mi 
>n</mi></mrow></mfrac><msub><mrow 
><mi 
class="MathClass-op"> ∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
></math> over error
functions <!--l. 3911--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>x</mi></mrow></msub 
></math>, for
<!--l. 3911--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math> individual training
examples, <!--l. 3911--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>.
The reason for this assumption is that the backpropagation
algorithm calculates the gradient of the error function for a
single training example, which needs to be generalized to
                                                    
                                                    
the overall error function. The second assumption is that it
can be written as a function of the outputs from the neural
network.
</p><!--l. 3913--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1460003.11.3"></a>Example loss function</h5>
<!--l. 3915--><p class="noindent" >Let <!--l. 3915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></math> be
vectors in <!--l. 3915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>n</mi></mrow></msup 
></math>.
</p><!--l. 3917--><p class="noindent" >Select an error function <!--l. 3917--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
measuring the difference between two outputs. The standard choice
is the square of the Euclidean distance between the vectors
<!--l. 3917--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi></math> and
<!--l. 3917--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></math>:
</p>
<div class="center" 
>
<!--l. 3919--><p class="noindent" >
</p><!--l. 3920--><p class="noindent" ><!--l. 3920--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>2</mn><mi 
>y</mi> <mo 
class="MathClass-bin">−</mo> <msup><mrow 
><mi 
>y</mi><msup><mrow 
></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></mrow><mrow 
><mn>2</mn></mrow></msup 
></math></p></div>
<!--l. 3923--><p class="noindent" >The error function over <!--l. 3923--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>n</mi></math>
training examples can then be written as an average of losses over
individual examples:
</p>
<div class="center" 
>
<!--l. 3925--><p class="noindent" >
</p><!--l. 3926--><p class="noindent" ><!--l. 3926--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>E</mi> <mo 
class="MathClass-rel">=</mo>  <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>2</mn><mi 
>n</mi></mrow></mfrac><msub><mrow 
><mi 
class="MathClass-op"> ∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>x</mi></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-bin">−</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mo 
class="MathClass-open">(</mo><mi 
>x</mi><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></math></p></div>
<!--l. 3929--><p class="noindent" >
</p>
                                                    
                                                    
<h4 class="subsectionHead"><span class="titlemark">3.11.4   </span> <a 
 id="x1-1470003.11.4"></a>Python practice</h4>
<!--l. 3931--><p class="noindent" >BPN was discovered by Rumelhart, Williams  Honton in 1986. The
core concept of BPN is to backpropagate or spread the error from
units of output layer to internal hidden layers in order to tune the
weights to ensure lower error rates. It is considered a practice of
fine-tuning the weights of neural networks in each iteration. Proper
tuning of the weights will make a sure minimum loss and this
will make a more robust, and generalizable trained neural
network.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1470015"></a>
                                                    
                                                    
<!--l. 3934--><p class="noindent" ><img 
src="backprop.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.5:</span><span  
class="content">Backpropagation procedure</span></figcaption><!--tex4ht:label?: x1-1470015 -->
                                                    
                                                    
</figure>
<!--l. 3939--><p class="noindent" >BPN learns in an iterative manner. In each iteration, it compares
training examples with the actual target label. target label can be a
class label or continuous value. The backpropagation algorithm
works in the following steps:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-147003x1">
     <!--l. 3942--><p class="noindent" ><span 
class="cmti-10">Initialize Network</span>: BPN randomly initializes the weights.
     </p></li>
<li 
  class="enumerate" id="x1-147005x2">
     <!--l. 3943--><p class="noindent" ><span 
class="cmti-10">Forward Propagate</span>: After initialization, we will propagate
     into the forward direction. In this phase, we will compute
     the output and calculate the error from the target output.
     </p></li>
<li 
  class="enumerate" id="x1-147007x3">
     <!--l. 3944--><p class="noindent" ><span 
class="cmti-10">Back Propagate Error</span>: For each observation, weights are
     modified in order to reduce the error in a technique called
     the delta rule or gradient descent. It modifies weights in
     a backward direction to all the hidden layers.</p></li></ol>
<h5 class="subsubsectionHead"><a 
 id="x1-1480003.11.4"></a>Importing libraries</h5>
<!--l. 3949--><p class="noindent" >Lets import the required modules and libraries such as numpy,
pandas, scikit-learn, and matplotlib.
</p>
<!--l. 3951--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Import</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Libraries</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pandas</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pd</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">model_selection</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-148007r7"></a><span 
class="cmr-5">7</span></span></pre>
<!--l. 3960--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1490003.11.4"></a>Load Dataset</h5>
                                                    
                                                    
<!--l. 3962--><p class="noindent" >Lets first load the Iris dataset using
<!--l. 3962--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>l</mi><mi 
>o</mi><mi 
>a</mi><mi 
>d</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>i</mi><mi 
>r</mi><mi 
>i</mi><mi 
>s</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-close">)</mo></math>
function of scikit-learn library and seprate them in features
and target labels. This data set has three classes Iris-setosa,
Iris-versicolor, and Iris-virginica.
</p>
<!--l. 3964--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Load</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dataset</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">data</span><span 
class="cmtt-8"> </span><span id="textcolor14578"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">features</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">target</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">X</span><span id="textcolor14593"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">data</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">data</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">y</span><span id="textcolor14599"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">data</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">target</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-149007r7"></a><span 
class="cmr-5">7</span></span></pre>
<!--l. 3973--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1500003.11.4"></a>Prepare Dataset</h5>
<!--l. 3975--><p class="noindent" >Create dummy variables for class labels using
<!--l. 3975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>g</mi><mi 
>e</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>d</mi><mi 
>u</mi><mi 
>m</mi><mi 
>m</mi><mi 
>i</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-close">)</mo></math>
function
</p>
<!--l. 3977--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dummy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">variable</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor14613"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pd</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">get_dummies</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">values</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y</span><span id="textcolor14627"><span 
class="cmtt-8">[</span></span><span id="textcolor14629"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">3</span><span id="textcolor14632"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150005r5"></a><span 
class="cmr-5">5</span></span></pre>
<!--l. 3984--><p class="noindent" >Output:
</p>
<!--l. 3986--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150006r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor14637"><span 
class="cmtt-8">[</span></span><span id="textcolor14639"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor14648"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150007r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor14651"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor14660"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150008r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor14663"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor14672"><span 
class="cmtt-8">]</span></span><span id="textcolor14674"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dtype</span><span id="textcolor14679"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">uint8</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-150009r4"></a><span 
class="cmr-5">4</span></span></pre>
<!--l. 3992--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1510003.11.4"></a>Split train and test set</h5>
<!--l. 3994--><p class="noindent" >To understand model performance, dividing the dataset into a
training set and a test set is a good strategy.
</p><!--l. 3996--><p class="noindent" >Let’s split dataset by using function
<!--l. 3996--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi><mi 
>r</mi><mi 
>a</mi><mi 
>i</mi><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>t</mi><mi 
>e</mi><mi 
>s</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>p</mi><mi 
>l</mi><mi 
>i</mi><mi 
>t</mi><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-close">)</mo></math>.
you need to pass basically 3 parameters features, target, and
<!--l. 3996--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>t</mi><mi 
>e</mi><mi 
>s</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>e</mi><mi 
>t</mi></math> size. Additionally,
you can use <!--l. 3996--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>o</mi><mi 
>m</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>t</mi><mi 
>a</mi><mi 
>t</mi><mi 
>e</mi></math>
in order to get the same kind of train and test set.
                                                    
                                                    
</p>
<!--l. 3998--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-151001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80">Split</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">into</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">train</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">test</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">data</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-151002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">X_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8"> </span><span id="textcolor14708"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">train_test_split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">test_size</span><span id="textcolor14720"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">20</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor14726"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-151003r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 4003--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1520003.11.4"></a>Initialize Hyperparameters and Weights</h5>
<!--l. 4005--><p class="noindent" >Lets initialize the hyperparameters such as learning rate, iterations,
input size, number of hidden layers, and number of output
layers.
</p>
<!--l. 4007--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Initialize</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">variables</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor14737"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">iterations</span><span 
class="cmtt-8"> </span><span id="textcolor14745"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5000</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><span id="textcolor14751"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">size</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">input</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">features</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">input_size</span><span 
class="cmtt-8"> </span><span id="textcolor14768"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">hidden</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layers</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neurons</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">hidden_size</span><span 
class="cmtt-8"> </span><span id="textcolor14785"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">neurons</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">at</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">output</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8">output_size</span><span 
class="cmtt-8"> </span><span id="textcolor14806"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8">results</span><span 
class="cmtt-8"> </span><span id="textcolor14812"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pd</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DataFrame</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">columns</span><span id="textcolor14820"><span 
class="cmtt-8">=</span></span><span id="textcolor14822"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">mse</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor14832"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152016r16"></a><span 
class="cmr-5">16</span></span></pre>
<!--l. 4025--><p class="noindent" >Lets initialize the weights for hidden and output layers with random
values.
</p>
<!--l. 4027--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152017r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Initialize</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weights</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152018r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">seed</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152019r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152020r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initializing</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">hidden</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152021r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">W1</span><span 
class="cmtt-8"> </span><span id="textcolor14863"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">normal</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">scale</span><span id="textcolor14873"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">size</span><span id="textcolor14881"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">input_size</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">hidden_size</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152022r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152023r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">initializing</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">output</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152024r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8"> </span><span id="textcolor14905"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">normal</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">scale</span><span id="textcolor14915"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">size</span><span id="textcolor14923"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">hidden_size</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">output_size</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-152025r9"></a><span 
class="cmr-5">9</span></span></pre>
<!--l. 4038--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1530003.11.4"></a>Helper Functions</h5>
<!--l. 4040--><p class="noindent" >Lets create helper functions such as sigmoid,
<!--l. 4040--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>m</mi><mi 
>e</mi><mi 
>a</mi><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>q</mi><mi 
>u</mi><mi 
>a</mi><mi 
>r</mi><mi 
>e</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>e</mi><mi 
>r</mi><mi 
>r</mi><mi 
>o</mi><mi 
>r</mi></math>, and
accuracy.
</p>
<!--l. 4042--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">)</span><span id="textcolor14939"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor14945"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor14951"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">exp</span><span 
class="cmtt-8">(</span><span id="textcolor14958"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8">x</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">mean_squared_error</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y_pred</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_true</span><span 
class="cmtt-8">)</span><span id="textcolor14972"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">y_pred</span><span 
class="cmtt-8"> </span><span id="textcolor14979"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_true</span><span 
class="cmtt-8">)</span><span id="textcolor14984"><span 
class="cmtt-8">**</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sum</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><span id="textcolor14992"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span id="textcolor14997"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8">y_pred</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">size</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">y_pred</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_true</span><span 
class="cmtt-8">)</span><span id="textcolor15012"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">acc</span><span 
class="cmtt-8"> </span><span id="textcolor15016"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_pred</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">argmax</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">axis</span><span id="textcolor15024"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor15029"><span 
class="cmtt-8">=</span></span><span id="textcolor15031"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_true</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">argmax</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">axis</span><span id="textcolor15039"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">return</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">acc</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mean</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-153010r10"></a><span 
class="cmr-5">10</span></span></pre>
<!--l. 4054--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1540003.11.4"></a>Backpropagation Neural Network</h5>
                                                    
                                                    
<!--l. 4056--><p class="noindent" >In this phase, we will create backpropagation neural network in
three steps feedforward propagation, error calculation and
backpropagation phase. Here , we will create a for loop for given
number of iterations that execute the three steps(feedforward
propagation, error calculation and backpropagation phase) and
update the weights in each iteration.
</p>
<!--l. 4058--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">itr</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">range</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">iterations</span><span 
class="cmtt-8">)</span><span id="textcolor15059"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">feedforward</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">propagation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">on</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">hidden</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Z1</span><span 
class="cmtt-8"> </span><span id="textcolor15075"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x_train</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8"> </span><span id="textcolor15089"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">Z1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">on</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">output</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">layer</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Z2</span><span 
class="cmtt-8"> </span><span id="textcolor15105"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8"> </span><span id="textcolor15119"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">Z2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Calculating</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">error</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">mse</span><span 
class="cmtt-8"> </span><span id="textcolor15133"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">mean_squared_error</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">acc</span><span 
class="cmtt-8"> </span><span id="textcolor15145"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">results</span><span id="textcolor15156"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">results</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">append</span><span 
class="cmtt-8">(</span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">mse</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor15166"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">mse</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">&#x0022;</span><span id="textcolor15174"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">acc</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8">ignore_index</span><span id="textcolor15180"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">backpropagation</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">E1</span><span 
class="cmtt-8"> </span><span id="textcolor15190"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8"> </span><span id="textcolor15195"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_train</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dW1</span><span 
class="cmtt-8"> </span><span id="textcolor15201"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">E1</span><span 
class="cmtt-8"> </span><span id="textcolor15206"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8"> </span><span id="textcolor15211"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor15217"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">E2</span><span 
class="cmtt-8"> </span><span id="textcolor15224"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">dW1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dW2</span><span 
class="cmtt-8"> </span><span id="textcolor15240"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">E2</span><span 
class="cmtt-8"> </span><span id="textcolor15245"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8"> </span><span id="textcolor15250"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor15256"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">weight</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">updates</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2_update</span><span 
class="cmtt-8"> </span><span id="textcolor15268"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dW1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor15283"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1_update</span><span 
class="cmtt-8"> </span><span id="textcolor15289"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x_train</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dW2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor15304"><span 
class="cmtt-8">/</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">N</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154029r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8"> </span><span id="textcolor15310"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8"> </span><span id="textcolor15315"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor15320"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2_update</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154030r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1</span><span 
class="cmtt-8"> </span><span id="textcolor15326"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1</span><span 
class="cmtt-8"> </span><span id="textcolor15331"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">learning_rate</span><span 
class="cmtt-8"> </span><span id="textcolor15336"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1_update</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-154031r31"></a><span 
class="cmr-5">31</span></span></pre>
<!--l. 4091--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1550003.11.4"></a>Plot MSE and Accuracy</h5>
<!--l. 4093--><p class="noindent" >Lets plot mean squared error in each iteration using pandas <span 
class="cmti-10">plot()</span>
funciton.
</p>
<!--l. 4095--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-155001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">results</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">mse</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">plot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">title</span><span id="textcolor15347"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Mean</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Squared</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Error</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-155002r2"></a><span 
class="cmr-5">2</span></span></pre>
<!--l. 4099--><p class="noindent" >Output:
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1550036"></a>
                                                    
                                                    
<!--l. 4102--><p class="noindent" ><img 
src="bp-plot1.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.6:</span><span  
class="content">Mean squared error</span></figcaption><!--tex4ht:label?: x1-1550036 -->
                                                    
                                                    
</figure>
<!--l. 4106--><p class="noindent" >Lets plot accuracy in each iteration using pandas plot() funciton.
</p>
<!--l. 4108--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-155004r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">results</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">plot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">title</span><span id="textcolor15364"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Accuracy</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-155005r2"></a><span 
class="cmr-5">2</span></span></pre>
<!--l. 4112--><p class="noindent" >Output:
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1550067"></a>
                                                    
                                                    
<!--l. 4115--><p class="noindent" ><img 
src="bp-plot2.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.7:</span><span  
class="content">Accuracy</span></figcaption><!--tex4ht:label?: x1-1550067 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1560003.11.4"></a>Predict for Test Data and Evaluate the Performance</h5>
<!--l. 4121--><p class="noindent" >Lets make prediction for the test data and assess the performance
of Backpropagation neural network.
</p>
<!--l. 4123--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">feedforward</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">Z1</span><span 
class="cmtt-8"> </span><span id="textcolor15375"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">x_test</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8"> </span><span id="textcolor15389"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">Z1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">Z2</span><span 
class="cmtt-8"> </span><span id="textcolor15398"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">dot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">W2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8"> </span><span id="textcolor15412"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sigmoid</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">Z2</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">acc</span><span 
class="cmtt-8"> </span><span id="textcolor15421"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">accuracy</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">A2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_test</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Accuracy</span><span 
class="cmtt-8">:</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">format</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">acc</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156010r10"></a><span 
class="cmr-5">10</span></span></pre>
<!--l. 4135--><p class="noindent" >Output:
</p>
<!--l. 4137--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156011r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">Accuracy</span><span id="textcolor15447"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">8</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-156012r2"></a><span 
class="cmr-5">2</span></span></pre>
<!--l. 4141--><p class="noindent" >you can see in the above output, we are getting 80% accuracy on
test dataset.
</p><!--l. 4146--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.12   </span> <a 
 id="x1-1570003.12"></a>Agents in Artificial Intelligence</h3>
<!--l. 4148--><p class="noindent" >An AI system can be defined as the study of the rational agent and
its environment. The agents sense the environment through sensors
and act on their environment through actuators. An AI agent can
have mental properties such as knowledge, belief, intention,
etc.
</p><!--l. 4150--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.12.1   </span> <a 
 id="x1-1580003.12.1"></a>What is an Agent?</h4>
<!--l. 4152--><p class="noindent" >An agent can be anything that perceiveits environment through
sensors and act upon that environment through actuators. An
Agent runs in the cycle of perceiving, thinking, and acting. An
agent can be:
</p><!--l. 4154--><p class="noindent" >
                                                    
                                                    
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-158002x1">
     <!--l. 4155--><p class="noindent" ><span 
class="cmti-10">Human-Agent</span>: A human agent has eyes, ears, and other
     organs which work for sensors and hand, legs, vocal tract
     work for actuators.
     </p></li>
<li 
  class="enumerate" id="x1-158004x2">
     <!--l. 4156--><p class="noindent" ><span 
class="cmti-10">Robotic Agent</span>: A robotic agent can have cameras, infrared
     range  finder,  NLP  for  sensors  and  various  motors  for
     actuators.
     </p></li>
<li 
  class="enumerate" id="x1-158006x3">
     <!--l. 4157--><p class="noindent" ><span 
class="cmti-10">Software Agent</span>: Software agent can have keystrokes, file
     contents as sensory input and act on those inputs and
     display output on the screen.</p></li></ol>
<!--l. 4160--><p class="noindent" >Hence the world around us is full of agents such as thermostat,
cellphone, camera, and even we are also agents. we should first
know about sensors, effectors, and actuators.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1580078"></a>
                                                    
                                                    
<!--l. 4163--><p class="noindent" ><img 
src="thermostat.jpg" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.8:</span><span  
class="content">Thermostat</span></figcaption><!--tex4ht:label?: x1-1580078 -->
                                                    
                                                    
</figure>
     <ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-158009x1">
     <!--l. 4169--><p class="noindent" ><span 
class="cmti-10">Sensor</span>:  Sensor  is  a  device  which  detects  the  change
     in the environment and sends the information to other
     electronic  devices.  An  agent  observes  its  environment
     through sensors.
     </p></li>
<li 
  class="enumerate" id="x1-158011x2">
     <!--l. 4171--><p class="noindent" ><span 
class="cmti-10">Actuators</span>:  Actuators  are  the  component  of  machines
     that converts energy into motion. The actuators are only
     responsible  for  moving  and  controlling  a  system.  An
     actuator can be an electric motor, gears, rails, etc.
     </p></li>
<li 
  class="enumerate" id="x1-158013x3">
     <!--l. 4173--><p class="noindent" ><span 
class="cmti-10">Effectors</span>:  Effectors  are  the  devices  which  affect  the
     environment. Effectors can be legs, wheels, arms, fingers,
     wings, fins, and display screen.</p></li></ol>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-1580149"></a>
                                                    
                                                    
<!--l. 4177--><p class="noindent" ><img 
src="intel-agents.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.9:</span><span  
class="content">Intelligent Agents</span></figcaption><!--tex4ht:label?: x1-1580149 -->
                                                    
                                                    
</figure>
<h4 class="subsectionHead"><span class="titlemark">3.12.2   </span> <a 
 id="x1-1590003.12.2"></a>Intelligent Agents</h4>
<!--l. 4184--><p class="noindent" >An intelligent agent is an autonomous entity which act upon an
environment using sensors and actuators for achieving goals. An
intelligent agent may learn from the environment to achieve their
goals. A thermostat is an example of an intelligent agent. Following
are the main four rules for an AI agent:
     </p><dl class="description"><dt class="description">
     <!--l. 4187--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4187--><p class="noindent" >Rule 1: An AI agent must have the ability to perceive the
     environment.
     </p></dd><dt class="description">
     <!--l. 4188--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4188--><p class="noindent" >Rule 2: The observation must be used to make decisions.
     </p></dd><dt class="description">
     <!--l. 4189--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4189--><p class="noindent" >Rule 3: Decision should result in an action.
     </p></dd><dt class="description">
     <!--l. 4190--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4190--><p class="noindent" >Rule 4: The action taken by an AI agent must be a rational
     action.</p></dd></dl>
<!--l. 4193--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.12.3   </span> <a 
 id="x1-1600003.12.3"></a>Rational Agent</h4>
                                                    
                                                    
<!--l. 4195--><p class="noindent" >A rational agent is an agent which has clear preference, models
uncertainty, and acts in a way to maximize its performance measure
with all possible actions. A rational agent is said to perform the
right things. AI is about creating rational agents to use for game
theory and decision theory for various real-world scenarios. For an
AI agent, the rational action is most important because in AI
reinforcement learning algorithm, for each best possible action,
agent gets the positive reward and for each wrong action, an agent
gets a negative reward.
</p><!--l. 4197--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1610003.12.3"></a>Rationality</h5>
<!--l. 4199--><p class="noindent" >The rationality of an agent is measured by its performance
measure. Rationality can be judged on the basis of following
points:
</p><!--l. 4201--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-161002x1">
     <!--l. 4202--><p class="noindent" >Performance measure which defines the success criterion.
     </p></li>
<li 
  class="enumerate" id="x1-161004x2">
     <!--l. 4203--><p class="noindent" >Agent prior knowledge of its environment.
     </p></li>
<li 
  class="enumerate" id="x1-161006x3">
     <!--l. 4204--><p class="noindent" >Best possible actions that an agent can perform.
     </p></li>
<li 
  class="enumerate" id="x1-161008x4">
     <!--l. 4205--><p class="noindent" >The sequence of percepts.</p></li></ol>
                                                    
                                                    
<!--l. 4208--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.12.4   </span> <a 
 id="x1-1620003.12.4"></a>Structure of an AI Agent</h4>
<!--l. 4210--><p class="noindent" >The task of AI is to design an agent program which implements
the agent function. The structure of an intelligent agent is a
combination of architecture and agent program. It can be viewed
as:
</p>
<div class="center" 
>
<!--l. 4212--><p class="noindent" >
</p><!--l. 4213--><p class="noindent" >Agent = Architecture + Agent program</p></div>
<!--l. 4216--><p class="noindent" >Following are the main three terms involved in the structure of an
AI agent:
</p><!--l. 4218--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-162002x1">
     <!--l. 4219--><p class="noindent" ><span 
class="cmti-10">Architecture</span>: Architecture is machinery that an AI agent
     executes on.
     </p></li>
<li 
  class="enumerate" id="x1-162004x2">
     <!--l. 4220--><p class="noindent" ><span 
class="cmti-10">Agent Function</span>: Agent function is used to map a percept
     to an action.
     </p></li>
<li 
  class="enumerate" id="x1-162006x3">
     <!--l. 4221--><p class="noindent" ><span 
class="cmti-10">Agent program</span>: Agent program is an implementation of
     agent function. An agent program executes on the physical
     architecture to produce function f.</p></li></ol>
                                                    
                                                    
<!--l. 4224--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.12.5   </span> <a 
 id="x1-1630003.12.5"></a>PEAS Representation</h4>
<!--l. 4226--><p class="noindent" >PEAS is a type of model on which an AI agent works upon. When
we define an AI agent or rational agent, then we can group its
properties under PEAS representation model. It is made up of four
words:
     </p><dl class="description"><dt class="description">
     <!--l. 4229--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4229--><p class="noindent" >P: Performance measure
     </p></dd><dt class="description">
     <!--l. 4230--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4230--><p class="noindent" >E: Environment
     </p></dd><dt class="description">
     <!--l. 4231--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4231--><p class="noindent" >A: Actuators
     </p></dd><dt class="description">
     <!--l. 4232--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4232--><p class="noindent" >S: Sensors</p></dd></dl>
<!--l. 4235--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1640003.12.5"></a>Example</h5>
<!--l. 4237--><p class="noindent" >Let’s suppose a self-driving car then PEAS representation will
be:
                                                    
                                                    
     </p><dl class="description"><dt class="description">
     <!--l. 4240--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4240--><p class="noindent" >Performance: Safety, time, legal drive, comfort
     </p></dd><dt class="description">
     <!--l. 4241--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4241--><p class="noindent" >Environment:   Roads,   other   vehicles,   road   signs,
     pedestrian
     </p></dd><dt class="description">
     <!--l. 4242--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4242--><p class="noindent" >Actuators: Steering, accelerator, brake, signal, horn
     </p></dd><dt class="description">
     <!--l. 4243--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4243--><p class="noindent" >Sensors:    Camera,    GPS,    speedometer,    odometer,
     accelerometer, sonar.</p></dd></dl>
<!--l. 4246--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.12.6   </span> <a 
 id="x1-1650003.12.6"></a>Types of agents</h4>
<!--l. 4248--><p class="noindent" >Agents can be grouped into five classes based on their degree of
perceived intelligence and capability. All these agents can improve
their performance and generate better action over the time. These
are given below:
</p><!--l. 4250--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-165002x1">
     <!--l. 4251--><p class="noindent" >Simple Reflex Agent
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-165004x2">
     <!--l. 4252--><p class="noindent" >Model-based reflex agent
     </p></li>
<li 
  class="enumerate" id="x1-165006x3">
     <!--l. 4253--><p class="noindent" >Goal-based agents
     </p></li>
<li 
  class="enumerate" id="x1-165008x4">
     <!--l. 4254--><p class="noindent" >Utility-based agent
     </p></li>
<li 
  class="enumerate" id="x1-165010x5">
     <!--l. 4255--><p class="noindent" >Learning agent</p></li></ol>
<!--l. 4258--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1660003.12.6"></a>Simple Reflex agent</h5>
<!--l. 4260--><p class="noindent" >The Simple reflex agents are the simplest agents. These agents take
decisions on the basis of the current percepts and ignore the rest of
the percept history. These agents only succeed in the fully
observable environment. The Simple reflex agent does not consider
any part of percepts history during their decision and action
process. The Simple reflex agent works on Condition-action rule,
which means it maps the current state to action. Such as
a Room Cleaner agent, it works only if there is dirt in the
room.
</p><!--l. 4262--><p class="noindent" >Problems for the simple reflex agent design approach:
</p><!--l. 4264--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-166002x1">
                                                    
                                                    
     <!--l. 4265--><p class="noindent" >They have very limited intelligence
     </p></li>
<li 
  class="enumerate" id="x1-166004x2">
     <!--l. 4266--><p class="noindent" >They do not have knowledge of non-perceptual parts of
     the current state
     </p></li>
<li 
  class="enumerate" id="x1-166006x3">
     <!--l. 4267--><p class="noindent" >Mostly too big to generate and to store.
     </p></li>
<li 
  class="enumerate" id="x1-166008x4">
     <!--l. 4268--><p class="noindent" >Not adaptive to changes in the environment.
</p>
     </li></ol>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-16600910"></a>
                                                    
                                                    
<!--l. 4273--><p class="noindent" ><img 
src="simple-reflex-agent.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.10:</span><span  
class="content">Simple reflex agent</span></figcaption><!--tex4ht:label?: x1-16600910 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1670003.12.6"></a>Model-based reflex agent</h5>
<!--l. 4280--><p class="noindent" >The Model-based agent can work in a partially observable
environment, and track the situation. A model-based agent has two
important factors:
</p><!--l. 4282--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-167002x1">
     <!--l. 4283--><p class="noindent" ><span 
class="cmti-10">Model</span>: It is knowledge about ”how things happen in the
     world,” so it is called a Model-based agent.
     </p></li>
<li 
  class="enumerate" id="x1-167004x2">
     <!--l. 4284--><p class="noindent" ><span 
class="cmti-10">Internal State</span>: It is a representation of the current state
     based on percept history.</p></li></ol>
<!--l. 4286--><p class="noindent" >These agents have the model, ”which is knowledge of the world”
and based on the model they perform actions. Updating the agent
state requires information about: <span 
class="cmti-10">How the world evolves </span>and <span 
class="cmti-10">How</span>
<span 
class="cmti-10">the agent’s action affects the world.</span>
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-16700511"></a>
                                                    
                                                    
<!--l. 4289--><p class="noindent" ><img 
src="model-based-reflex-agent.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.11:</span><span  
class="content">Model based reflex agent</span></figcaption><!--tex4ht:label?: x1-16700511 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1680003.12.6"></a>Goal-based agents</h5>
<!--l. 4296--><p class="noindent" >The knowledge of the current state environment is not always
sufficient to decide for an agent to what to do. The agent needs to
know its goal which describes desirable situations. Goal-based
agents expand the capabilities of the model-based agent by having
the ”goal” information. They choose an action, so that they
can achieve the goal. These agents may have to consider a
long sequence of possible actions before deciding whether
the goal is achieved or not. Such considerations of different
scenario are called searching and planning, which makes an agent
proactive.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-16800112"></a>
                                                    
                                                    
<!--l. 4299--><p class="noindent" ><img 
src="goal-based-agent.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.12:</span><span  
class="content">Goal-based agents</span></figcaption><!--tex4ht:label?: x1-16800112 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1690003.12.6"></a>Utility-based agents</h5>
<!--l. 4306--><p class="noindent" >These agents are similar to the goal-based agent but provide an
extra component of utility measurement which makes them different
by providing a measure of success at a given state. Utility-based
agent act based not only goals but also the best way to achieve the
goal. The Utility-based agent is useful when there are multiple
possible alternatives, and an agent has to choose in order to
perform the best action. The utility function maps each state to a
real number to check how efficiently each action achieves the
goals.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-16900113"></a>
                                                    
                                                    
<!--l. 4310--><p class="noindent" ><img 
src="utility-based-agent.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.13:</span><span  
class="content">Utility based agent</span></figcaption><!--tex4ht:label?: x1-16900113 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-1700003.12.6"></a>Learning Agents</h5>
<!--l. 4317--><p class="noindent" >A learning agent in AI is the type of agent which can learn from its
past experiences, or it has learning capabilities. It starts to act with
basic knowledge and then able to act and adapt automatically
through learning.
</p><!--l. 4319--><p class="noindent" >A learning agent has mainly four conceptual components, which
are:
</p><!--l. 4321--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-170002x1">
     <!--l. 4322--><p class="noindent" ><span 
class="cmti-10">Learning                      element</span>:                          It
     is responsible for making improvements by learning from
     environment
     </p></li>
<li 
  class="enumerate" id="x1-170004x2">
     <!--l. 4323--><p class="noindent" ><span 
class="cmti-10">Critic</span>: Learning element takes feedback from critic which
     describes that how well the agent is doing with respect to
     a fixed performance standard.
     </p></li>
<li 
  class="enumerate" id="x1-170006x3">
     <!--l. 4324--><p class="noindent" ><span 
class="cmti-10">Performance  element</span>:  It  is  responsible  for  selecting
     external action
     </p></li>
<li 
  class="enumerate" id="x1-170008x4">
     <!--l. 4325--><p class="noindent" ><span 
class="cmti-10">Problem  generator</span>:  This  component  is  responsible  for
     suggesting actions that will lead to new and informative
     experiences.</p></li></ol>
                                                    
                                                    
<!--l. 4327--><p class="noindent" >Hence, learning agents are able to learn, analyze performance, and
look for new ways to improve the performance.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-17000914"></a>
                                                    
                                                    
<!--l. 4330--><p class="noindent" ><img 
src="learning-agent.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.14:</span><span  
class="content">Learning agent</span></figcaption><!--tex4ht:label?: x1-17000914 -->
                                                    
                                                    
</figure>
<h3 class="sectionHead"><span class="titlemark">3.13   </span> <a 
 id="x1-1710003.13"></a>Agent Environment in AI</h3>
<!--l. 4337--><p class="noindent" >An environment is everything in the world which surrounds the
agent, but it is not a part of an agent itself. An environment can be
described as a situation in which an agent is present. The
environment is where agent lives, operate and provide the agent
with something to sense and act upon it. An environment is mostly
said to be non-feministic.
</p><!--l. 4339--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">3.13.1   </span> <a 
 id="x1-1720003.13.1"></a>Features of Environment</h4>
<!--l. 4341--><p class="noindent" >As per Russell and Norvig, an environment can have various
features from the point of view of an agent:
</p><!--l. 4343--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-172002x1">
     <!--l. 4344--><p class="noindent" >Fully observable vs Partially Observable
     </p></li>
<li 
  class="enumerate" id="x1-172004x2">
     <!--l. 4345--><p class="noindent" >Static vs Dynamic
     </p></li>
<li 
  class="enumerate" id="x1-172006x3">
     <!--l. 4346--><p class="noindent" >Discrete vs Continuous
     </p></li>
<li 
  class="enumerate" id="x1-172008x4">
     <!--l. 4347--><p class="noindent" >Deterministic vs Stochastic
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-172010x5">
     <!--l. 4348--><p class="noindent" >Single-agent vs Multi-agent
     </p></li>
<li 
  class="enumerate" id="x1-172012x6">
     <!--l. 4349--><p class="noindent" >Episodic vs sequential
     </p></li>
<li 
  class="enumerate" id="x1-172014x7">
     <!--l. 4350--><p class="noindent" >Known vs Unknown
     </p></li>
<li 
  class="enumerate" id="x1-172016x8">
     <!--l. 4351--><p class="noindent" >Accessible vs Inaccessible</p></li></ol>
<!--l. 4354--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1730003.13.1"></a>Fully observable vs Partially Observable</h5>
<!--l. 4356--><p class="noindent" >If an agent sensor can sense or access the complete state of an
environment at each point of time then it is a <span 
class="cmti-10">fully observable</span>
environment, else it is <span 
class="cmti-10">partially observable</span>. A fully observable
environment is easy as there is no need to maintain the internal
state to keep track history of the world. An agent with no sensors
in all environments then such an environment is called as
<span 
class="cmti-10">unobservable</span>.
</p><!--l. 4358--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1740003.13.1"></a>Deterministic vs Stochastic</h5>
<!--l. 4360--><p class="noindent" >If an agent’s current state and selected action can completely
determine the next state of the environment, then such environment
                                                    
                                                    
is called a deterministic environment. A stochastic environment is
random in nature and cannot be determined completely by an
agent. In a deterministic, fully observable environment, agent does
not need to worry about uncertainty.
</p><!--l. 4363--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1750003.13.1"></a>Episodic vs Sequential</h5>
<!--l. 4365--><p class="noindent" >In an episodic environment, there is a series of one-shot actions, and
only the current percept is required for the action. However, in
Sequential environment, an agent requires memory of past actions
to determine the next best actions.
</p><!--l. 4367--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1760003.13.1"></a>Single-agent vs Multi-agent</h5>
<!--l. 4369--><p class="noindent" >If only one agent is involved in an environment, and operating by
itself then such an environment is called single agent environment.
However, if multiple agents are operating in an environment, then
such an environment is called a multi-agent environment. The agent
design problems in the multi-agent environment are different from
single agent environment.
</p><!--l. 4371--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1770003.13.1"></a>Static vs Dynamic</h5>
<!--l. 4373--><p class="noindent" >If the environment can change itself while an agent is deliberating
then such environment is called a dynamic environment else it is
called a static environment. Static environments are easy to deal
because an agent does not need to continue looking at the world
while deciding for an action. However for dynamic environment,
agents need to keep looking at the world at each action. Taxi
driving is an example of a dynamic environment whereas Crossword
puzzles are an example of a static environment.
                                                    
                                                    
</p><!--l. 4375--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1780003.13.1"></a>Discrete vs Continuous</h5>
<!--l. 4377--><p class="noindent" >If in an environment there are a finite number of percepts
and actions that can be performed within it, then such an
environment is called a discrete environment else it is called
continuous environment. A chess gamecomes under discrete
environment as there is a finite number of moves that can be
performed. A self-driving car is an example of a continuous
environment.
</p><!--l. 4379--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1790003.13.1"></a>Known vs Unknown</h5>
<!--l. 4381--><p class="noindent" >Known and unknown are not actually a feature of an environment,
but it is an agent’s state of knowledge to perform an action. In a
known environment, the results for all actions are known to the
agent. While in unknown environment, agent needs to learn how it
works in order to perform an action. It is quite possible that a
known environment to be partially observable and an Unknown
environment to be fully observable.
</p><!--l. 4383--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1800003.13.1"></a>Accessible vs Inaccessible</h5>
<!--l. 4385--><p class="noindent" >If an agent can obtain complete and accurate information about the
state’s environment, then such an environment is called an
Accessible environment else it is called inaccessible. An empty room
whose state can be defined by its temperature is an example of an
accessible environment. Information about an event on earth is an
example of Inaccessible environment.
                                                    
                                                    
</p><!--l. 4387--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.14   </span> <a 
 id="x1-1810003.14"></a>Turing Test in AI</h3>
<!--l. 4389--><p class="noindent" >In 1950, Alan Turing introduced a test to check whether a
machine can think like a human or not, this test is known
as the Turing Test. In this test, Turing proposed that the
computer can be said to be an intelligent if it can mimic human
response under specific conditions. Turing Test was introduced
by Turing in his 1950 paper, ”Computing Machinery and
Intelligence,” which considered the question, ”Can Machine
think?”
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-18100115"></a>
                                                    
                                                    
<!--l. 4392--><p class="noindent" ><img 
src="turing-test-in-ai.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 3.15:</span><span  
class="content">Turing test in AI</span></figcaption><!--tex4ht:label?: x1-18100115 -->
                                                    
                                                    
</figure>
<!--l. 4397--><p class="noindent" >The Turing test is based on a party game ”Imitation game,” with
some modifications. This game involves three players in which one
player is Computer, another player is human responder, and the
third player is a human Interrogator, who is isolated from other two
players and his job is to find that which player is machine among
two of them. Consider, Player A is a computer, Player B is human,
and Player C is an interrogator. Interrogator is aware that one of
them is machine, but he needs to identify this on the basis of
questions and their responses.
</p><!--l. 4399--><p class="noindent" >The conversation between all players is via keyboard and screen so
the result would not depend on the machine’s ability to convert
words as speech. The test result does not depend on each correct
answer, but only how closely its responses like a human answer. The
computer is permitted to do everything possible to force a wrong
identification by the interrogator.
</p><!--l. 4401--><p class="noindent" >The questions and answers can be like:
     </p><dl class="description"><dt class="description">
     <!--l. 4404--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4404--><p class="noindent" ><span 
class="cmbx-10">Interrogator</span>: Are you a computer?
     </p></dd><dt class="description">
     <!--l. 4406--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4406--><p class="noindent" ><span 
class="cmbx-10">PlayerA (Computer)</span>: No
     </p></dd><dt class="description">
     <!--l. 4408--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4408--><p class="noindent" ><span 
class="cmbx-10">Interrogator</span>: Multiply two large numbers such as <!--l. 4408--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mn>2</mn><mn>5</mn><mn>6</mn><mn>8</mn><mn>9</mn><mn>6</mn><mn>4</mn><mn>8</mn><mn>9</mn> <mo 
class="MathClass-bin">∗</mo> <mn>4</mn><mn>5</mn><mn>6</mn><mn>7</mn><mn>2</mn><mn>5</mn><mn>8</mn><mn>9</mn><mn>6</mn><mo 
class="MathClass-close">)</mo></math>
     </p></dd><dt class="description">
     <!--l. 4410--><p class="noindent" >
 </p></dt><dd 
class="description">
     <!--l. 4410--><p class="noindent" ><span 
class="cmbx-10">Player A</span>: Long pause and give the wrong answer.
</p>
                                                    
                                                    
     </dd></dl>
<!--l. 4414--><p class="noindent" >In this game, if an interrogator would not be able to identify which
is a machine and which is human, then the computer passes the test
successfully, and the machine is said to be intelligent and can think
like a human.
</p><!--l. 4417--><p class="noindent" >”In 1991, the New York businessman Hugh Loebner announces the
prize competition, offering a <span 
class="tcrm-1000">$</span>100,000 prize for the first computer to
pass the Turing test. However, no AI program to till date, come
close to passing an undiluted Turing test”.
</p>
<h4 class="subsectionHead"><span class="titlemark">3.14.1   </span> <a 
 id="x1-1820003.14.1"></a>Chatbots to attempt the Turing test</h4>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4422--><p class="noindent" ><span 
class="cmbx-10">ELIZA</span>:  ELIZA  was  a  Natural  language  processing
     computer  program  created  by  Joseph  Weizenbaum.  It
     was created to demonstrate the ability of communication
     between  machine  and  humans.  It  was  one  of  the  first
     chatterbots, which has attempted the Turing Test.
     </p></li>
     <li class="itemize">
     <!--l. 4424--><p class="noindent" ><span 
class="cmbx-10">Parry</span>: Parry was a chatterbot created by Kenneth Colby
     in 1972. Parry was designed to simulate a person with
     Paranoid  schizophrenia(most  common  chronic  mental
     disorder). Parry was described as ”ELIZA with attitude.”
     Parry was tested using a variation of the Turing Test in
     the early 1970s.
     </p></li>
     <li class="itemize">
     <!--l. 4426--><p class="noindent" ><span 
class="cmbx-10">Eugene Goostman</span>: Eugene Goostman was a chatbot
     developed  in  Saint  Petersburg  in  2001.  This  bot  has
     competed  in  the  various  number  of  Turing  Test.  In
     June 2012, at an event, Goostman won the competition
     promoted as largest-ever Turing test content, in which
     it   has   convinced   29%   of   judges   that   it   was   a
                                                    
                                                    
     human.Goostman resembled as a 13-year old virtual boy.</p></li></ul>
<!--l. 4429--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">3.15   </span> <a 
 id="x1-1830003.15"></a>The Chinese Room Argument</h3>
<!--l. 4431--><p class="noindent" >There were many philosophers who really disagreed with the
complete concept of Artificial Intelligence. The most famous
argument in this list was ”Chinese Room.” In the year 1980, John
Searle presented ”Chinese Room” thought experiment, in his paper
”Mind, Brains, and Program,” which was against the validity of
Turing’s Test. According to his argument, ”Programming a
computer may make it to understand a language, but it will not
produce a real understanding of language or consciousness in a
computer.” He argued that Machine such as ELIZA and Parry
could easily pass the Turing test by manipulating keywords and
symbol, but they had no real understanding of language. So it
cannot be described as ”thinking” capability of a machine such as a
human.
</p><!--l. 4433--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-1840003.15"></a>Features required for a machine to pass the Turing test</h5>
<!--l. 4435--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-184002x1">
     <!--l. 4436--><p class="noindent" ><span 
class="cmti-10">Natural   language   processing</span>:   NLP   is   required   to
     communicate   with   Interrogator   in   general   human
     language like English.
     </p></li>
<li 
  class="enumerate" id="x1-184004x2">
     <!--l. 4437--><p class="noindent" ><span 
class="cmti-10">Knowledge   representation</span>:   To   store   and   retrieve
     information during the test.
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-184006x3">
     <!--l. 4438--><p class="noindent" ><span 
class="cmti-10">Automated  reasoning</span>:  To  use  the  previously  stored
     information for answering the questions.
     </p></li>
<li 
  class="enumerate" id="x1-184008x4">
     <!--l. 4439--><p class="noindent" ><span 
class="cmti-10">Machine learning</span>: To adapt new changes and can detect
     generalized patterns.
     </p></li>
<li 
  class="enumerate" id="x1-184010x5">
     <!--l. 4440--><p class="noindent" ><span 
class="cmti-10">Vision   (For   total   Turing   test)</span>:   To   recognize   the
     interrogator actions and other objects during a test.
     </p></li>
<li 
  class="enumerate" id="x1-184012x6">
     <!--l. 4441--><p class="noindent" ><span 
class="cmti-10">Motor Control (For total Turing test)</span>: To act upon objects
     if requested.</p></li></ol>
                                                    
                                                    
<h2 class="chapterHead"><span class="titlemark">Chapter 4</span><br /><a 
 id="x1-1850004"></a>Natural language processing</h2>
<!--l. 4446--><p class="noindent" >Natural language processing (NLP) is a subfield of linguistics,
computer science, and artificial intelligence concerned with the
interactions between computers and human language, in particular
how to program computers to process and analyze large amounts of
natural language data. The goal is a computer capable of
”understanding” the contents of documents, including the
contextual nuances of the language within them. The technology
can then accurately extract information and insights contained in
the documents as well as categorize and organize the documents
themselves. Challenges in natural language processing frequently
involve speech recognition, natural language understanding, and
natural language generation.
</p>
<h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-1860004.1"></a>History</h3>
<!--l. 4450--><p class="noindent" >Natural language processing has its roots in the 1950s. Already in
1950, Alan Turing published an article titled ”Computing
Machinery and Intelligence” which proposed what is now called the
Turing test as a criterion of intelligence, a task that involves the
automated interpretation and generation of natural language, but
at the time not articulated as a problem separate from artificial
intelligence.
</p><!--l. 4452--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.1   </span> <a 
 id="x1-1870004.1.1"></a>Symbolic NLP (1950s  early 1990s)</h4>
<!--l. 4454--><p class="noindent" >The premise of symbolic NLP is well-summarized by John Searle’s
Chinese room experiment: Given a collection of rules (e.g., a
Chinese phrasebook, with questions and matching answers), the
computer emulates natural language understanding (or other NLP
tasks) by applying those rules to the data it is confronted
with.
</p>
                                                    
                                                    
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4457--><p class="noindent" ><span 
class="cmbx-10">1950s</span>:  The  Georgetown  experiment  in  1954  involved
     fully automatic translation of more than sixty Russian
     sentences into English. The authors claimed that within
     three   or   five   years,   machine   translation   would   be
     a  solved  problem.  However,  real  progress  was  much
     slower,  and  after  the  ALPAC  report  in  1966,  which
     found  that  ten-year-long  research  had  failed  to  fulfill
     the  expectations,  funding  for  machine  translation  was
     dramatically reduced. Little further research in machine
     translation  was  conducted  until  the  late  1980s  when
     the  first  statistical  machine  translation  systems  were
     developed.
     </p></li>
     <li class="itemize">
     <!--l. 4459--><p class="noindent" ><span 
class="cmbx-10">1960s</span>:   Some   notably   successful   natural   language
     processing systems developed in the 1960s were SHRDLU,
     a natural language system working in restricted ”blocks
     worlds”  with  restricted  vocabularies,  and  ELIZA,  a
     simulation  of  a  Rogerian  psychotherapist,  written  by
     Joseph Weizenbaum between 1964 and 1966. Using almost
     no information about human thought or emotion, ELIZA
     sometimes provided a startlingly human-like interaction.
     When the ”patient” exceeded the very small knowledge
     base,  ELIZA  might  provide  a  generic  response,  for
     example, responding to ”My head hurts” with ”Why do
     you say your head hurts?”.
     </p></li>
     <li class="itemize">
     <!--l. 4461--><p class="noindent" ><span 
class="cmbx-10">1970s</span>:  During  the  1970s,  many  programmers  began
     to   write   ”conceptual   ontologies”,   which   structured
     real-world   information   into   computer-understandable
     data.  Examples  are  MARGIE  (Schank,  1975),  SAM
     (Cullingford,  1978),  PAM  (Wilensky,  1978),  TaleSpin
     (Meehan,   1976),   QUALM   (Lehnert,   1977),   Politics
     (Carbonell, 1979), and Plot Units (Lehnert 1981). During
     this time, the first many chatterbots were written (e.g.,
     PARRY).
                                                    
                                                    
     </p></li>
     <li class="itemize">
     <!--l. 4463--><p class="noindent" ><span 
class="cmbx-10">1980s</span>:
     The 1980s and early 1990s mark the hey-day of symbolic
     methods in NLP. Focus areas of the time included research
     on rule-based parsing (e.g., the development of HPSG as a
     computational operationalization of generative grammar),
     morphology (e.g., two-level morphology), semantics (e.g.,
     Lesk algorithm), reference (e.g., within Centering Theory)
     and other areas of natural language understanding (e.g., in
     the Rhetorical Structure Theory). Other lines of research
     were  continued,  e.g.,  the  development  of  chatterbots
     with Racter and Jabberwacky. An important development
     (that eventually led to the statistical turn in the 1990s)
     was the rising importance of quantitative evaluation in
     this period. <sup class="textsuperscript"><a 
href="#ennote-53" id="enmark-53"><span 
class="cmr-9">53</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-54" id="enmark-54"><span 
class="cmr-9">54</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-55" id="enmark-55"><span 
class="cmr-9">55</span></a></sup>
</p>
     </li></ul>
<!--l. 4467--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.2   </span> <a 
 id="x1-1880004.1.2"></a>Statistical NLP (1990s2010s)</h4>
<!--l. 4469--><p class="noindent" >Up to the 1980s, most natural language processing systems
were based on complex sets of hand-written rules. Starting in
the late 1980s, however, there was a revolution in natural
language processing with the introduction of machine learning
algorithms for language processing. This was due to both the
steady increase in computational power (see Moore’s law)
and the gradual lessening of the dominance of Chomskyan
theories of linguistics (e.g. transformational grammar), whose
theoretical underpinnings discouraged the sort of corpus linguistics
that underlies the machine-learning approach to language
processing.
</p>
     <ul class="itemize1">
     <li class="itemize">
                                                    
                                                    
     <!--l. 4472--><p class="noindent" ><span 
class="cmbx-10">1990s</span>: Many of the notable early successes on statistical
     methods  in  NLP  occurred  in  the  field  of  machine
     translation,  due  especially  to  work  at  IBM  Research.
     These systems were able to take advantage of existing
     multilingual  textual  corpora  that  had  been  produced
     by the Parliament of Canada and the European Union
     as  a  result  of  laws  calling  for  the  translation  of  all
     governmental  proceedings  into  all  official  languages  of
     the corresponding systems of government. However, most
     other systems depended on corpora specifically developed
     for the tasks implemented by these systems, which was
     (and  often  continues  to  be)  a  major  limitation  in  the
     success  of  these  systems.  As  a  result,  a  great  deal
     of  research  has  gone  into  methods  of  more  effectively
     learning from limited amounts of data.
     </p></li>
     <li class="itemize">
     <!--l. 4473--><p class="noindent" ><span 
class="cmbx-10">2000s</span>: With the growth of the web, increasing amounts
     of raw (unannotated) language data has become available
     since  the  mid-1990s.  Research  has  thus  increasingly
     focused  on  unsupervised  and  semi-supervised  learning
     algorithms.  Such  algorithms  can  learn  from  data  that
     has not been hand-annotated with the desired answers
     or using a combination of annotated and non-annotated
     data.  Generally,  this  task  is  much  more  difficult  than
     supervised learning, and typically produces less accurate
     results for a given amount of input data. However, there
     is an enormous amount of non-annotated data available
     (including, among other things, the entire content of the
     World  Wide  Web),  which  can  often  make  up  for  the
     inferior results if the algorithm used has a low enough
     time complexity to be practical.</p></li></ul>
<!--l. 4476--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.3   </span> <a 
 id="x1-1890004.1.3"></a>Neural NLP (present)</h4>
<!--l. 4478--><p class="noindent" >In the 2010s, representation learning and deep neural network-style
machine learning methods became widespread in natural language
                                                    
                                                    
processing, due in part to a flurry of results showing that such
techniques can achieve state-of-the-art results in many natural
language tasks, for example in language modeling, parsing, and
many others. This is increasingly important in medicine and
healthcare, where NLP is being used to analyze notes and text in
electronic health records that would otherwise be inaccessible for
study when seeking to improve care. <sup class="textsuperscript"><a 
href="#ennote-56" id="enmark-56"><span 
class="cmr-9">56</span></a></sup>
</p><!--l. 4480--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.4   </span> <a 
 id="x1-1900004.1.4"></a>Components of NLP</h4>
<!--l. 4482--><p class="noindent" >There are the following two components of NLP
</p><!--l. 4484--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.5   </span> <a 
 id="x1-1910004.1.5"></a>Natural Language Understanding (NLU)</h4>
<!--l. 4486--><p class="noindent" >Natural Language Understanding (NLU) helps the machine to
understand and analyse human language by extracting the
metadata from content such as concepts, entities, keywords,
emotion, relations, and semantic roles. NLU mainly used in
Business applications to understand the customer’s problem in both
spoken and written language.
</p><!--l. 4488--><p class="noindent" >NLU involves the following tasks:
</p><!--l. 4490--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-191002x1">
     <!--l. 4491--><p class="noindent" >It   is   used   to   map   the   given   input   into   useful
     representation. It is used to analyze different aspects of
     the language.
</p>
     </li></ol>
                                                    
                                                    
<!--l. 4496--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.6   </span> <a 
 id="x1-1920004.1.6"></a>Natural Language Generation (NLG)</h4>
<!--l. 4498--><p class="noindent" >Natural Language Generation (NLG) acts as a translator
that converts the computerized data into natural language
representation. It mainly involves Text planning, Sentence planning,
and Text Realization.
</p><!--l. 4500--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.1.7   </span> <a 
 id="x1-1930004.1.7"></a>Difference between NLU and NLG</h4>
<div class="table">
                                                    
                                                    
<!--l. 4502--><p class="noindent" ><a 
 id="x1-1930011"></a></p><figure class="float" 
>
                                                    
                                                    
<div class="tabular"> <table id="TBL-6" class="tabular" 
 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1" /><col 
id="TBL-6-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-1-1"  
class="td11"><span 
class="cmr-5">NLU                                          </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-1-2"  
class="td11"><span 
class="cmr-5">NLG                                               </span></td></tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-2-1"  
class="td11"><span 
class="cmr-5">NLU is the process of reading </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-2-2"  
class="td11"><span 
class="cmr-5">NLG is the process of writing</span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-3-1"  
class="td11"><span 
class="cmr-5">and interpreting language.               </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-3-2"  
class="td11"><span 
class="cmr-5">or generating language.                        </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-4-1"  
class="td11"><span 
class="cmr-5">It produces non-linguistic                </span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-4-2"  
class="td11"><span 
class="cmr-5">It produces constructing natural language</span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-6-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-5-1"  
class="td11"><span 
class="cmr-5">outputs from natural language inputs.</span></td><td  style="text-align:left; white-space:nowrap;" id="TBL-6-5-2"  
class="td11"><span 
class="cmr-5">outputs from non-linguistic inputs.         </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-6-6-1"  
class="td11">                                           </td></tr></table></div>
<figcaption class="caption" ><span class="id">Table 4.1:</span><span  
class="content">Difference between NLU and NLG</span></figcaption><!--tex4ht:label?: x1-1930011 -->
                                                    
                                                    
</figure>
</div>
<h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-1940004.2"></a>Applications of NLP</h3>
<!--l. 4518--><p class="noindent" >The following are the applications of NLP
</p>
     <ul class="itemize1">
     <li class="itemize">
     <!--l. 4521--><p class="noindent" ><span 
class="cmti-10">Question  Answering</span>:  Question  Answering  focuses  on
     building systems that automatically answer the questions
     asked by humans in a natural language.
     </p></li>
     <li class="itemize">
     <!--l. 4522--><p class="noindent" ><span 
class="cmti-10">Spam  Detection</span>:  Spam  detection  is  used  to  detect
     unwanted e-mails getting to a user’s inbox.
     </p></li>
     <li class="itemize">
     <!--l. 4523--><p class="noindent" ><span 
class="cmti-10">Sentiment Analysis</span>: Sentiment Analysis is also known as
     opinion  mining.  It  is  used  on  the  web  to  analyse  the
     attitude, behaviour, and emotional state of the sender.
     This application is implemented through a combination
     of NLP (Natural Language Processing) and statistics by
     assigning  the  values  to  the  text  (positive,  negative,  or
     natural), identify the mood of the context (happy, sad,
     angry, etc.)
     </p></li>
     <li class="itemize">
     <!--l. 4524--><p class="noindent" ><span 
class="cmti-10">Machine  Translation</span>:  Machine  translation  is  used  to
     translate  text  or  speech  from  one  natural  language  to
     another natural language.
     </p></li>
     <li class="itemize">
                                                    
                                                    
     <!--l. 4525--><p class="noindent" ><span 
class="cmti-10">Spelling correction</span>: Microsoft Corporation provides word
     processor  software  like  MS-word,  PowerPoint  for  the
     spelling correction.
     </p></li>
     <li class="itemize">
     <!--l. 4526--><p class="noindent" ><span 
class="cmti-10">Speech  Recognition</span>:   Speech   recognition   is   used   for
     converting   spoken   words   into   text.   It   is   used   in
     applications,  such  as  mobile,  home  automation,  video
     recovery, dictating to Microsoft Word, voice biometrics,
     voice user interface, and so on.
     </p></li>
     <li class="itemize">
     <!--l. 4527--><p class="noindent" ><span 
class="cmti-10">Chatbot</span>:   Implementing   the   Chatbot   is   one   of   the
     important  applications  of  NLP.  It  is  used  by  many
     companies to provide the customer’s chat services.
     </p></li>
     <li class="itemize">
     <!--l. 4528--><p class="noindent" ><span 
class="cmti-10">Information extraction</span>: Information extraction is one of
     the most important applications of NLP. It is used for
     extracting structured information from unstructured or
     semi-structured machine-readable documents.
     </p></li>
     <li class="itemize">
     <!--l. 4529--><p class="noindent" ><span 
class="cmti-10">Natural Language Understanding (NLU)</span>:  It  converts  a
     large set of text into more formal representations such as
     first-order logic structures that are easier for the computer
     programs to manipulate notations of the natural language
     processing.
</p>
     </li></ul>
<!--l. 4533--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-1950004.3"></a>Speech recognition using Python</h3>
                                                    
                                                    
<!--l. 4535--><p class="noindent" >I am going to explain as how to write a small program that convert
speech to text. There are many ways to do this i.e., either using
online speech recognition tools like <span 
class="cmti-10">Google Speech Recognition,</span>
<span 
class="cmti-10">Google Cloud Speech API, Wit.ai </span>or offline tools like <span 
class="cmti-10">CMU Sphinx</span>.
I will be using <span 
class="cmti-10">CMU Sphinx </span>for I expect my computer convert
speech even in the absence of internet connection. The following are
steps for this task.
</p><!--l. 4537--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-195002x1">
     <!--l. 4538--><p class="noindent" >Install prerequisites: Sphinx needs two libraries they are
     <span 
class="cmti-10">swig </span>and <span 
class="cmti-10">pyaudio</span>
     </p></li>
<li 
  class="enumerate" id="x1-195004x2">
     <!--l. 4539--><p class="noindent" >Install  speech  recognition  library:  I  shall  be  using
     Python’s <span 
class="cmti-10">SpeechRecognition </span>library.</p></li></ol>
<!--l. 4542--><p class="noindent" >
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-1960004.3"></a>Prerequisites</h4>
<!--l. 4544--><p class="noindent" >Swig and pyaudio are two important libraries that assists recording
audio (speech).
</p><!--l. 4546--><p class="noindent" >
</p>
<h4 class="likesubsectionHead"><a 
 id="x1-1970004.3"></a>What is <span 
class="cmti-10">swig</span></h4>
<!--l. 4548--><p class="noindent" >SWIG is an interface compiler that connects programs written in C
and C++ with scripting languages such as Perl, Python, Ruby, and
Tcl. It works by taking the declarations found in C/C++ header
files and using them to generate the wrapper code that scripting
languages need to access the underlying C/C++ code. In addition,
SWIG provides a variety of customization features that let you
                                                    
                                                    
tailor the wrapping process to suit your application. Visit
<a 
href="http://www.swig.org/exec.html" class="url" ><span 
class="cmtt-10">http://www.swig.org/exec.html</span></a> for more details as how swig
helps in developing <span 
class="cmti-10">extension modules </span>using several other scripting
languages.
</p><!--l. 4550--><p class="noindent" >Anybody can download <span 
class="cmti-10">swig </span>from <a 
href="http://www.swig.org/download.html" class="url" ><span 
class="cmtt-10">http://www.swig.org/download.html</span></a>.
There are instructions as how to obtain <span 
class="cmti-10">swig </span>and install in different
operating systems. For instance, <span 
class="cmti-10">swig </span>for windows is available at
<a 
href="http://prdownloads.sourceforge.net/swig/swigwin-4.0.2.zip" class="url" ><span 
class="cmtt-10">http://prdownloads.sourceforge.net/swig/swigwin-4.0.2.zip</span></a>.
<span 
class="cmti-10">Sourceforge </span>is a platform for creating, collaborating and
distributing open-source and business related software. Visit
<a 
href="https://sourceforge.net/" class="url" ><span 
class="cmtt-10">https://sourceforge.net/</span></a> for more details.
</p><!--l. 4552--><p class="noindent" >After downloading <span 
class="cmti-10">swig </span>just extract to one of the folders, preferably
<span 
class="cmtt-10">c: </span>in Windows C drive. Then create environmental variable using
“advanced system settings” feature in Windows.
</p><!--l. 4554--><p class="noindent" >Now its time to install the other requirement i.e., <span 
class="cmti-10">pyaudio</span>.
Installing <span 
class="cmti-10">pyaudio </span>is not straight forward in Windows for <span 
class="cmti-10">pyaudio</span>
needs <span 
class="cmtt-10">pipwin </span>instead of <span 
class="cmtt-10">pip</span>.
</p>
<!--l. 4556--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">pip</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">install</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pipwin</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">pipwin</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">install</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pyaudio</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197003r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 4561--><p class="noindent" >The last requirement is the Python’s package <span 
class="cmti-10">speechrecognition </span>the
one which is main for recording and translating speech into
text.
</p>
<!--l. 4563--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197004r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">pip</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">install</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">SpeechRecognition</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197005r2"></a><span 
class="cmr-5">2</span></span></pre>
<!--l. 4567--><p class="noindent" >Now we are ready to write a basic script useful for speech
recognition. The following is the entire code required to create a
script required to listen and print the voice in text.
</p>
<!--l. 4569--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197006r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">speech_recognition</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sr</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197007r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197008r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">obtain</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">audio</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">from</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">microphone</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197009r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">r</span><span 
class="cmtt-8"> </span><span id="textcolor15488"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">Recognizer</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197010r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">with</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">Microphone</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">source</span><span id="textcolor15505"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197011r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Please</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">wait</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Calibrating</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">microphone</span><span 
class="cmtt-8">...</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197012r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">listen</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">5</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">seconds</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">ambient</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">noise</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">energy</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">level</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197013r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">r</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">adjust_for_ambient_noise</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">source</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">duration</span><span id="textcolor15552"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197014r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Say</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">something</span><span 
class="cmtt-8">!</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197015r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">audio</span><span 
class="cmtt-8"> </span><span id="textcolor15567"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">r</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">listen</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">source</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197016r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197017r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">recognize</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">speech</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">using</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Sphinx</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197018r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8">try</span><span id="textcolor15586"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197019r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Sphinx</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">thinks</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">you</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">said</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span id="textcolor15602"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">r</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">recognize_sphinx</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">audio</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><span id="textcolor15612"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197020r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197021r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8">except</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">UnknownValueError</span><span id="textcolor15624"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197022r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Sphinx</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">could</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">understand</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">audio</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197023r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8">except</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">RequestError</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">e</span><span id="textcolor15649"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197024r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Sphinx</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">error</span><span 
class="cmtt-8">;</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">{</span><span 
class="cmtt-8">0</span><span class="lstinline"></span><span 
class="cmtt-8">}</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">format</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">e</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-197025r20"></a><span 
class="cmr-5">20</span></span></pre>
<!--l. 4591--><p class="noindent" >We first need to create a speech recognition object which is <span 
class="cmtt-10">sr </span>in
the above code. This object is used to record audio using object <span 
class="cmtt-10">r</span>
through its object level method <span 
class="cmtt-10">.listen()</span>. Once the audio is being
recorded, the stetement <span 
class="cmtt-10">r.recognize</span><span 
class="cmtt-10">_sphinx() </span>converts the audio
or speech into text.
                                                    
                                                    
</p><!--l. 4593--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">4.4   </span> <a 
 id="x1-1980004.4"></a>How to build an NLP pipeline</h3>
<!--l. 4595--><p class="noindent" >There are the following steps to build an NLP pipeline
</p><!--l. 4597--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-198002x1">
     <!--l. 4598--><p class="noindent" ><span 
class="cmbxti-10">Step1</span><span 
class="cmti-10">: Sentence Segmentation</span>: Sentence Segment is the
     first  step  for  building  the  NLP  pipeline.  It  breaks  the
     paragraph into separate sentences.
     </p></li>
<li 
  class="enumerate" id="x1-198004x2">
     <!--l. 4599--><p class="noindent" ><span 
class="cmbxti-10">Step2</span><span 
class="cmti-10">: Word Tokenization</span>: Word Tokenizer is used to
     break the sentence into separate words or tokens.
     </p></li>
<li 
  class="enumerate" id="x1-198006x3">
     <!--l. 4600--><p class="noindent" ><span 
class="cmbxti-10">Step3</span><span 
class="cmti-10">: Stemming</span>: Stemming is used to normalize words
     into its base form or root form. For example, celebrates,
     celebrated and celebrating, all these words are originated
     with a single root word ”celebrate.” The big problem with
     stemming is that sometimes it produces the root word
     which may not have any meaning.
     </p></li>
<li 
  class="enumerate" id="x1-198008x4">
     <!--l. 4601--><p class="noindent" ><span 
class="cmbxti-10">Step 4</span><span 
class="cmti-10">: Lemmatization</span>: Lemmatization is quite similar to
     the Stamming. It is used to group different inflected forms
     of the word, called Lemma. The main difference between
     Stemming and lemmatization is that it produces the root
     word, which has a meaning.
     </p></li>
<li 
  class="enumerate" id="x1-198010x5">
                                                    
                                                    
     <!--l. 4602--><p class="noindent" ><span 
class="cmbxti-10">Step 5</span><span 
class="cmti-10">: Identifying Stop Words</span>: In English, there are a
     lot of words that appear very frequently like ”is”, ”and”,
     ”the”, and ”a”. NLP pipelines will flag these words as stop
     words. Stop words might be filtered out before doing any
     statistical analysis.
     </p></li>
<li 
  class="enumerate" id="x1-198012x6">
     <!--l. 4603--><p class="noindent" ><span 
class="cmbxti-10">Step 6</span><span 
class="cmti-10">: Dependency Parsing</span>: Dependency Parsing is used
     to find that how all the words in the sentence are related
     to each other.
     </p></li>
<li 
  class="enumerate" id="x1-198014x7">
     <!--l. 4604--><p class="noindent" ><span 
class="cmbxti-10">Step 7</span><span 
class="cmti-10">: POS tags</span>: POS stands for parts of speech, which
     includes Noun, verb, adverb, and Adjective. It indicates
     that how a word functions with its meaning as well as
     grammatically within the sentences. A word has one or
     more parts of speech based on the context in which it is
     used.
     </p></li>
<li 
  class="enumerate" id="x1-198016x8">
     <!--l. 4605--><p class="noindent" ><span 
class="cmbxti-10">Step 8</span><span 
class="cmti-10">: Named Entity Recognition (NER)</span>: Named Entity
     Recognition (NER) is the process of detecting the named
     entity  such  as  person  name,  movie  name,  organization
     name, or location.
     </p></li>
<li 
  class="enumerate" id="x1-198018x9">
     <!--l. 4606--><p class="noindent" ><span 
class="cmbxti-10">Step  9</span><span 
class="cmti-10">:  Chunking</span>:  Chunking  is  used  to  collect  the
     individual piece of information and grouping them into
     bigger pieces of sentences.</p></li></ol>
<!--l. 4609--><p class="noindent" >
</p>
                                                    
                                                    
<h3 class="sectionHead"><span class="titlemark">4.5   </span> <a 
 id="x1-1990004.5"></a>Python practice for NLP pipelines</h3>
<!--l. 4611--><p class="noindent" >Python has many libraries for NLP practice and development.
Following are few packages for NLP.
</p><!--l. 4613--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-199002x1">
     <!--l. 4614--><p class="noindent" ><a 
href="https://www.nltk.org/" >Natural Language Toolkit (NLTK)</a>
     </p></li>
<li 
  class="enumerate" id="x1-199004x2">
     <!--l. 4615--><p class="noindent" ><a 
href="https://github.com/RaRe-Technologies/gensim" >gensim</a>
     </p></li>
<li 
  class="enumerate" id="x1-199006x3">
     <!--l. 4616--><p class="noindent" ><a 
href="https://polyglot.readthedocs.io/en/latest/index.html" >polyglot</a>
     </p></li>
<li 
  class="enumerate" id="x1-199008x4">
     <!--l. 4617--><p class="noindent" ><a 
href="https://textblob.readthedocs.io/en/dev/" >textblob</a>
     </p></li>
<li 
  class="enumerate" id="x1-199010x5">
     <!--l. 4618--><p class="noindent" ><a 
href="https://stanfordnlp.github.io/CoreNLP/" >CoreNLP</a>
     </p></li>
<li 
  class="enumerate" id="x1-199012x6">
     <!--l. 4619--><p class="noindent" ><a 
href="https://spacy.io/" >spaCy</a>
     </p></li>
<li 
  class="enumerate" id="x1-199014x7">
     <!--l. 4620--><p class="noindent" ><a 
href="https://github.com/clips/pattern" >pattern</a>
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-199016x8">
     <!--l. 4621--><p class="noindent" ><a 
href="https://github.com/tasdikrahman/vocabulary" >vocabulary</a>
     </p></li>
<li 
  class="enumerate" id="x1-199018x9">
     <!--l. 4622--><p class="noindent" ><a 
href="https://pypi.org/project/PyNLPl/" >PyNLPl</a>
     </p></li>
<li 
  class="enumerate" id="x1-199020x10">
     <!--l. 4623--><p class="noindent" ><a 
href="https://github.com/machinalis/quepy" >quepy</a>
</p>
     </li></ol>
<!--l. 4627--><p class="noindent" >I shall show as how to practice NLP pipelines using <span 
class="cmtt-10">spaCy</span>.
</p><!--l. 4629--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.5.1   </span> <a 
 id="x1-2000004.5.1"></a>spaCy for NLP</h4>
<!--l. 4631--><p class="noindent" >The main portal for spaCy is <a 
href="https://spacy.io/" class="url" ><span 
class="cmtt-10">https://spacy.io/</span></a>. This has lot of
information related to documentation comprising manuals. The
website boasts that spaCy is “Industrial-Strength Natural
Language Processing”. SpaCy supports various things say,
multilingual support, machine learning, visualization, packaging and
deployments. Above all, spaCy supports certain standard machine
learning libraries such as <span 
class="cmti-10">PyTorch, TensorFlow </span>etc. There are
number of things in NLP, but for the sake of simplicity, I shall
explain only few steps of NLP pipeline using <span 
class="cmti-10">spaCy </span>plus Python
native code.
</p><!--l. 4633--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2010004.5.1"></a>Segmentation</h5>
                                                    
                                                    
<!--l. 4635--><p class="noindent" >Sentence segmentation also called as <span 
class="cmti-10">segmentation </span>in NLP is just
dividing a given text into sentenses. A Doc objects sentences
are available via the <span 
class="cmtt-10">Doc.sents </span>property. To view a Doc’s
sentences, you can iterate over the <span 
class="cmtt-10">Doc.sents</span>, a generator that
yields Span objects. You can check whether a <span 
class="cmtt-10">Doc </span>has sentence
boundaries by calling <span 
class="cmtt-10">Doc.has</span><span 
class="cmtt-10">_annotation </span>with the attribute
name “SENT_START”.
</p>
<!--l. 4637--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">spacy</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">nlp</span><span 
class="cmtt-8"> </span><span id="textcolor15674"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">spacy</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">load</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">en_core_web_sm</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8"> </span><span id="textcolor15687"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nlp</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">a</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">another</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sent</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sents</span><span id="textcolor15721"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">sent</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">text</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201008r8"></a><span 
class="cmr-5">8</span></span></pre>
<!--l. 4647--><p class="noindent" >The output will be as follows:
</p>
<!--l. 4649--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201009r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">a</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201010r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">another</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8">.</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201011r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 4654--><p class="noindent" >There is nothing great about this. This can be achieved using
Python basic function known as <span 
class="cmtt-10">split()</span>.
</p>
<!--l. 4656--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201012r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor15745"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">txt</span><span 
class="cmtt-8"> </span><span id="textcolor15750"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">two</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201013r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor15772"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">txt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201014r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor15783"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">two</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">’</span><span id="textcolor15810"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201015r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor15812"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">out</span><span 
class="cmtt-8"> </span><span id="textcolor15817"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">txt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">split</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201016r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor15828"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">out</span><span id="textcolor15832"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor15835"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201017r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">one</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201018r7"></a><span 
class="cmr-5">7</span></span><span id="textcolor15846"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">out</span><span id="textcolor15850"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor15853"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201019r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">This</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sentence</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">two</span><span 
class="cmtt-8">’</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-201020r9"></a><span 
class="cmr-5">9</span></span></pre>
<!--l. 4667--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2020004.5.1"></a>Tokenization</h5>
<!--l. 4669--><p class="noindent" >Tokenization is the process of demarcating and possibly classifying
sections of a string of input words and characters. The resulting
tokens are then passed on to some other form of processing. The
process can be considered a sub-task of parsing input.
</p><!--l. 4671--><p class="noindent" >As per <span 
class="cmti-10">spaCy</span>’s documentation, the tokenization is the task of
splitting a text into meaningful segments, called tokens. The
input to the <span 
class="cmti-10">tokenizer </span>is a unicode text, and the output is a
<span 
class="cmti-10">Doc </span>object. To construct a <span 
class="cmti-10">Doc </span>object, you need a <span 
class="cmti-10">Vocab</span>
instance, a sequence of word strings, and optionally a sequence of
spaces booleans, which allow you to maintain alignment of the
tokens into the original string. During processing, <span 
class="cmti-10">spaCy </span>first
tokenizes the text, i.e. segments it into words, punctuation
and so on. This is done by applying rules specific to each
language.
                                                    
                                                    
</p>
<!--l. 4673--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8"> </span><span id="textcolor15867"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nlp</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Apple</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">looking</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">at</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">buying</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">U</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">K</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">startup</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">\</span><span 
class="tctt-0800">$</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">billion</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">token</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">doc</span><span id="textcolor15905"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">not</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">token</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">is</span><span 
class="cmtt-8">\</span><span 
class="cmtt-8">_stop</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">and</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">token</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">is</span><span 
class="cmtt-8">\</span><span 
class="cmtt-8">_alpha</span><span id="textcolor15924"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">token</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">text</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202006r6"></a><span 
class="cmr-5">6</span></span></pre>
<!--l. 4681--><p class="noindent" >There isn’t any special command to creates tokens from a given
string in <span 
class="cmti-10">spaCy</span>. The <span 
class="cmtt-10">if </span>condition checks for tokens that are
alpha-numeric but not a stop word. As result we get the following
output.
</p>
<!--l. 4683--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202007r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">Apple</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202008r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">looking</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202009r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">buying</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202010r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">startup</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202011r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">billion</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-202012r6"></a><span 
class="cmr-5">6</span></span></pre>
<!--l. 4691--><p class="noindent" >Output is clean from <span 
class="cmti-10">stop words </span>such as <span 
class="cmti-10">is, at </span>etc., also other
symbols such as periods (.) and dollar sign (<span 
class="tcrm-1000">$</span>).
</p><!--l. 4693--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2030004.5.1"></a>Lemmatization</h5>
<!--l. 4695--><p class="noindent" >Lemmatisation in linguistics is the process of grouping together the
inflected forms of a word so they can be analysed as a single
item, identified by the word’s lemma, or dictionary form. In
computational linguistics, lemmatisation is the algorithmic process
of determining the lemma of a word based on its intended meaning.
Unlike stemming, lemmatisation depends on correctly identifying
the intended part of speech and meaning of a word in a sentence, as
well as within the larger context surrounding that sentence, such as
neighboring sentences or even an entire document. As a result,
developing efficient lemmatisation algorithms is an open area of
research.
</p><!--l. 4697--><p class="noindent" >In <span 
class="cmti-10">spaCy</span>; the Lemmatizer is a pipeline component that provides
lookup and rule-based lemmatization methods in a configurable
component. An individual language can extend the Lemmatizer as
part of its language data.
</p>
<!--l. 4699--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8"> </span><span id="textcolor15939"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nlp</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">I</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">was</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">reading</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">the</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">paper</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">token</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">doc</span><span id="textcolor15964"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">token</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">text</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">token</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">lemma_</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203004r4"></a><span 
class="cmr-5">4</span></span></pre>
<!--l. 4705--><p class="noindent" >The output is as follows.
                                                    
                                                    
</p>
<!--l. 4707--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203005r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">I</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">-</span><span 
class="cmtt-8">PRON</span><span 
class="cmtt-8">-</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203006r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">was</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">be</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203007r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">reading</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">read</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203008r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">the</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">the</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203009r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">paper</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">paper</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203010r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-203013r9"></a><span 
class="cmr-5">9</span></span></pre>
<!--l. 4716--><p class="noindent" >Three of the words namely, <span 
class="cmti-10">I, was </span>and <span 
class="cmti-10">reading </span>were lemmatized.
</p><!--l. 4718--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2040004.5.1"></a>Named-entity recognition</h5>
<!--l. 4720--><p class="noindent" >Named-entity recognition (NER) (also known as (named) entity
identification, entity chunking, and entity extraction) is a subtask of
information extraction that seeks to locate and classify named
entities mentioned in unstructured text into pre-defined categories
such as person names, organizations, locations, medical codes,
time expressions, quantities, monetary values, percentages,
etc.
</p><!--l. 4722--><p class="noindent" ><span 
class="cmti-10">spaCy </span>features an extremely fast statistical entity recognition
system, that assigns labels to contiguous spans of tokens. The
default trained pipelines can identify a variety of named and
numeric entities, including companies, locations, organizations and
products. You can add arbitrary classes to the entity recognition
system, and update the model with new examples.
</p><!--l. 4724--><p class="noindent" >A named entity is a “real-world object” thats assigned a name  for
example, a person, a country, a product or a book title. <span 
class="cmti-10">spaCy </span>can
recognize various types of named entities in a document, by asking
the model for a prediction. Because models are statistical and
strongly depend on the examples they were trained on, this doesn’t
always work perfectly and might need some tuning later, depending
on your use case. Named entities are available as the <span 
class="cmtt-10">ents </span>property
of a <span 
class="cmtt-10">Doc</span>:
</p>
<!--l. 4726--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8"> </span><span id="textcolor16042"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">nlp</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Apple</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">is</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">looking</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">at</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">buying</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">U</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">K</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">startup</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">\</span><span 
class="tctt-0800">$</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">billion</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">ent</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">doc</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ents</span><span id="textcolor16082"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">print</span><span 
class="cmtt-8">((</span><span 
class="cmtt-8">ent</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">text</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">ent</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">label_</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204004r4"></a><span 
class="cmr-5">4</span></span></pre>
<!--l. 4732--><p class="noindent" >The output is as follows.
</p>
<!--l. 4734--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204005r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">Apple</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">ORG</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204006r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">U</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">K</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">GPE</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204007r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">\</span><span 
class="tctt-0800">$</span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">billion</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">MONEY</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-204008r4"></a><span 
class="cmr-5">4</span></span></pre>
                                                    
                                                    
<!--l. 4740--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">4.5.2   </span> <a 
 id="x1-2050004.5.2"></a>Phases of NLP</h4>
<!--l. 4742--><p class="noindent" >Following are the five phases of NLP.
</p><!--l. 4744--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-205002x1">
     <!--l. 4745--><p class="noindent" ><span 
class="cmti-10">Lexical Analysis and Morphological</span>:  The  first  phase  of
     NLP  is  the  Lexical  Analysis.  This  phase  scans  the
     source  code  as  a  stream  of  characters  and  converts  it
     into meaningful lexemes. It divides the whole text into
     paragraphs, sentences, and words.
     </p></li>
<li 
  class="enumerate" id="x1-205004x2">
     <!--l. 4746--><p class="noindent" ><span 
class="cmti-10">Syntactic Analysis (Parsing)</span>: Syntactic Analysis is used
     to  check  grammar,  word  arrangements,  and  shows  the
     relationship among the words.
     </p></li>
<li 
  class="enumerate" id="x1-205006x3">
     <!--l. 4747--><p class="noindent" ><span 
class="cmti-10">Semantic Analysis</span>: Semantic analysis is concerned with
     the  meaning  representation.  It  mainly  focuses  on  the
     literal meaning of words, phrases, and sentences.
     </p></li>
<li 
  class="enumerate" id="x1-205008x4">
     <!--l. 4748--><p class="noindent" ><span 
class="cmti-10">Discourse  Integration</span>:  Discourse  Integration  depends
     upon the sentences that proceeds it and also invokes the
     meaning of the sentences that follow it.
     </p></li>
<li 
  class="enumerate" id="x1-205010x5">
     <!--l. 4749--><p class="noindent" ><span 
class="cmti-10">Pragmatic Analysis</span>: Pragmatic is the fifth and last phase
                                                    
                                                    
     of  NLP.  It  helps  you  to  discover  the  intended  effect
     by applying a set of rules that characterize cooperative
     dialogues.</p></li></ol>
<!--l. 4754--><p class="noindent" >
                                                    
                                                    
</p>
<div class="columns-2">
<h3 class="likesectionHead"><a 
 id="x1-2060004.5.2"></a>Notes</h3>
<!--l. 4757--><p class="noindent" >
</p><!--l. 4--><p class="noindent" ><a 
href="#enmark-33" id="ennote-33"><sup class="textsuperscript"><span 
class="cmr-9">33</span></sup></a><a 
 id="x1-206001x33"></a><span 
class="cmr-8">Hopfield,  J.  J.  (1982).  ”Neural  networks  and  physical  systems  with</span>
<span 
class="cmr-8">emergent  collective  computational  abilities”.  Proc.  Natl.  Acad.  Sci.</span>
<span 
class="cmr-8">U.S.A. 79 (8): 25542558. doi:10.1073/pnas.79.8.2554. PMC 346238. PMID</span>
<span 
class="cmr-8">6953413.</span>
</p><!--l. 35--><p class="noindent" ><a 
href="#enmark-34" id="ennote-34"><sup class="textsuperscript"><span 
class="cmr-9">34</span></sup></a><a 
 id="x1-206002x34"></a><span 
class="cmr-8">Bain (1873). Mind and Body: The Theories of Their Relation. New York:</span>
<span 
class="cmr-8">D. Appleton and Company.</span>
</p><!--l. 55--><p class="noindent" ><a 
href="#enmark-35" id="ennote-35"><sup class="textsuperscript"><span 
class="cmr-9">35</span></sup></a><a 
 id="x1-206003x35"></a><span 
class="cmr-8">James  (1890).  The  Principles  of  Psychology.  New  York:  H.  Holt  and</span>
<span 
class="cmr-8">Company.</span>
</p><!--l. 71--><p class="noindent" ><a 
href="#enmark-36" id="ennote-36"><sup class="textsuperscript"><span 
class="cmr-9">36</span></sup></a><a 
 id="x1-206004x36"></a><span 
class="cmr-8">Sherrington, C.S. (1898). ”Experiments in Examination of the Peripheral</span>
<span 
class="cmr-8">Distribution  of  the  Fibers  of  the  Posterior  Roots  of  Some  Spinal</span>
<span 
class="cmr-8">Nerves”.  Proceedings  of  the  Royal  Society  of  London.  190:  45186.</span>
<span 
class="cmr-8">doi:10.1098/rstb.1898.0002.</span>
</p><!--l. 106--><p class="noindent" ><a 
href="#enmark-37" id="ennote-37"><sup class="textsuperscript"><span 
class="cmr-9">37</span></sup></a><a 
 id="x1-206005x37"></a><span 
class="cmr-8">McCulloch,  Warren;  Walter  Pitts  (1943).  ”A  Logical  Calculus  of  Ideas</span>
<span 
class="cmr-8">Immanent in Nervous Activity”. Bulletin of Mathematical Biophysics. 5</span>
<span 
class="cmr-8">(4): 115133. doi:10.1007/BF02478259.</span>
</p><!--l. 132--><p class="noindent" ><a 
href="#enmark-38" id="ennote-38"><sup class="textsuperscript"><span 
class="cmr-9">38</span></sup></a><a 
 id="x1-206006x38"></a><span 
class="cmr-8">Farley, B.; W.A. Clark (1954). ”Simulation of Self-Organizing Systems by</span>
<span 
class="cmr-8">Digital Computer”. IRE Transactions on Information Theory. 4 (4): 7684.</span>
<span 
class="cmr-8">doi:10.1109/TIT.1954.1057468.</span>
</p><!--l. 157--><p class="noindent" ><a 
href="#enmark-39" id="ennote-39"><sup class="textsuperscript"><span 
class="cmr-9">39</span></sup></a><a 
 id="x1-206007x39"></a><span 
class="cmr-8">Rochester, N.; J.H. Holland, L.H. Habit and W.L. Duda (1956). ”Tests</span>
<span 
class="cmr-8">on  a  cell  assembly  theory  of  the  action  of  the  brain,  using  a  large</span>
<span 
class="cmr-8">digital computer”. IRE Transactions on Information Theory. 2 (3): 8093.</span>
<span 
class="cmr-8">doi:10.1109/TIT.1956.1056810.</span>
</p><!--l. 197--><p class="noindent" ><a 
href="#enmark-40" id="ennote-40"><sup class="textsuperscript"><span 
class="cmr-9">40</span></sup></a><a 
 id="x1-206008x40"></a><span 
class="cmr-8">Rosenblatt,  F.  (1958).  ”The  Perceptron:  A  Probalistic  Model  For</span>
<span 
class="cmr-8">Information  Storage  And  Organization  In  The  Brain”.  Psychological</span>
<span 
class="cmr-8">Review. 65 (6): 386408. CiteSeerX 10.1.1.588.3775. doi:10.1037/h0042519.</span>
<span 
class="cmr-8">PMID 13602029.</span>
</p><!--l. 227--><p class="noindent" ><a 
href="#enmark-41" id="ennote-41"><sup class="textsuperscript"><span 
class="cmr-9">41</span></sup></a><a 
 id="x1-206009x41"></a><span 
class="cmr-8">Werbos, P.J. (1975). Beyond Regression: New Tools for Prediction and</span>
<span 
class="cmr-8">Analysis in the Behavioral Sciences.</span>
</p><!--l. 246--><p class="noindent" ><a 
href="#enmark-42" id="ennote-42"><sup class="textsuperscript"><span 
class="cmr-9">42</span></sup></a><a 
 id="x1-206010x42"></a><span 
class="cmr-8">Minsky,  M.;  S.  Papert  (1969).  An  Introduction  to  Computational</span>
<span 
class="cmr-8">Geometry. MIT Press. ISBN 978-0-262-63022-1.</span>
</p><!--l. 264--><p class="noindent" ><a 
href="#enmark-43" id="ennote-43"><sup class="textsuperscript"><span 
class="cmr-9">43</span></sup></a><a 
 id="x1-206011x43"></a><span 
class="cmr-8">Rumelhart,   D.E.;   James   McClelland   (1986).   Parallel   Distributed</span>
<span 
class="cmr-8">Processing: Explorations in the Microstructure of Cognition. Cambridge:</span>
<span 
class="cmr-8">MIT Press.</span>
</p><!--l. 285--><p class="noindent" ><a 
href="#enmark-44" id="ennote-44"><sup class="textsuperscript"><span 
class="cmr-9">44</span></sup></a><a 
 id="x1-206012x44"></a><span 
class="cmr-8">McCulloch, Warren; Pitts, Walter (1943). ”A Logical Calculus of Ideas</span>
<span 
class="cmr-8">Immanent in Nervous Activity”. Bulletin of Mathematical Biophysics. 5</span>
<span 
class="cmr-8">(4): 115133. doi:10.1007/BF02478259.</span>
                                                    
                                                    
</p><!--l. 311--><p class="noindent" ><a 
href="#enmark-45" id="ennote-45"><sup class="textsuperscript"><span 
class="cmr-9">45</span></sup></a><a 
 id="x1-206013x45"></a><span 
class="cmr-8">A Hopfield network (or Ising model of a neural network or IsingLenzLittle</span>
<span 
class="cmr-8">model) is a form of recurrent artificial neural network and a type of spin</span>
<span 
class="cmr-8">glass system popularised by John Hopfield in 1982 as described earlier</span>
<span 
class="cmr-8">by Little in 1974 based on Ernst Ising’s work with Wilhelm Lenz on the</span>
<span 
class="cmr-8">Ising model. Hopfield networks serve as content-addressable (”associative”)</span>
<span 
class="cmr-8">memory  systems  with  binary  threshold  nodes.  Hopfield  networks  also</span>
<span 
class="cmr-8">provide a model for understanding human memory.</span>
</p><!--l. 390--><p class="noindent" ><a 
href="#enmark-46" id="ennote-46"><sup class="textsuperscript"><span 
class="cmr-9">46</span></sup></a><a 
 id="x1-206014x46"></a><span 
class="cmr-8">Copeland, B. Jack, ed. (2004). The Essential Turing. Oxford University</span>
<span 
class="cmr-8">Press. p. 403. ISBN 978-0-19-825080-7.</span>
</p><!--l. 409--><p class="noindent" ><a 
href="#enmark-47" id="ennote-47"><sup class="textsuperscript"><span 
class="cmr-9">47</span></sup></a><a 
 id="x1-206015x47"></a><span 
class="cmr-8">von Neumann, John (1945), First Draft of a Report on the EDVAC (PDF),</span>
<span 
class="cmr-8">archived from the original (PDF) on March 14, 2013, retrieved August 24,</span>
<span 
class="cmr-8">2011</span>
</p><!--l. 439--><p class="noindent" ><a 
href="#enmark-48" id="ennote-48"><sup class="textsuperscript"><span 
class="cmr-9">48</span></sup></a><a 
 id="x1-206016x48"></a><span 
class="cmr-8">Turing’s  1948  paper  has  been  re-printed  as  Turing  AM.  Intelligent</span>
<span 
class="cmr-8">Machinery. In: Ince DC, editor. Collected works of AM Turing  Mechanical</span>
<span 
class="cmr-8">Intelligence. Elsevier Science Publishers, 1992.</span>
</p><!--l. 470--><p class="noindent" ><a 
href="#enmark-49" id="ennote-49"><sup class="textsuperscript"><span 
class="cmr-9">49</span></sup></a><a 
 id="x1-206017x49"></a><span 
class="cmr-8">Hebb, D.O. (1949). The Organization of Behavior. New York: Wiley  Sons.</span>
</p><!--l. 486--><p class="noindent" ><a 
href="#enmark-50" id="ennote-50"><sup class="textsuperscript"><span 
class="cmr-9">50</span></sup></a><a 
 id="x1-206018x50"></a><span 
class="cmr-8">Zell,   Andreas   (1994).   Simulation   Neuronaler   Netze   [Simulation   of</span>
<span 
class="cmr-8">Neural  Networks]  (in  German)  (1st  ed.).  Addison-Wesley.  p.  73.  ISBN</span>
<span 
class="cmr-8">3-89319-554-8.</span>
</p><!--l. 509--><p class="noindent" ><a 
href="#enmark-51" id="ennote-51"><sup class="textsuperscript"><span 
class="cmr-9">51</span></sup></a><a 
 id="x1-206019x51"></a><span 
class="cmr-8">Schmidhuber, Jrgen (2015-01-01). ”Deep learning in neural networks: An</span>
<span 
class="cmr-8">overview”. Neural Networks. 61: 85117. arXiv:1404.7828.</span>
</p><!--l. 528--><p class="noindent" ><a 
href="#enmark-52" id="ennote-52"><sup class="textsuperscript"><span 
class="cmr-9">52</span></sup></a><a 
 id="x1-206020x52"></a><span 
class="cmr-8">Auer,  Peter;  Harald  Burgsteiner;  Wolfgang  Maass  (2008).  ”A  learning</span>
<span 
class="cmr-8">rule  for  very  simple  universal  approximators  consisting  of  a  single</span>
<span 
class="cmr-8">layer   of   perceptrons”   (PDF).   Neural   Networks.   21   (5):   786795.</span>
<span 
class="cmr-8">doi:10.1016/j.neunet.2007.12.036.</span>
</p><!--l. 561--><p class="noindent" ><a 
href="#enmark-53" id="ennote-53"><sup class="textsuperscript"><span 
class="cmr-9">53</span></sup></a><a 
 id="x1-206021x53"></a><span 
class="cmr-8">Koskenniemi,        Kimmo        (1983),        Two-level        morphology:</span>
<span 
class="cmr-8">A general computational model of word-form recognition and production</span>
<span 
class="cmr-8">(PDF), Department of General Linguistics, University of Helsinki</span>
</p><!--l. 587--><p class="noindent" ><a 
href="#enmark-54" id="ennote-54"><sup class="textsuperscript"><span 
class="cmr-9">54</span></sup></a><a 
 id="x1-206022x54"></a><span 
class="cmr-8">Joshi, A. K.,  Weinstein, S. (1981, August). Control of Inference: Role of</span>
<span 
class="cmr-8">Some Aspects of Discourse Structure-Centering. In IJCAI (pp. 385-387).</span>
</p><!--l. 613--><p class="noindent" ><a 
href="#enmark-55" id="ennote-55"><sup class="textsuperscript"><span 
class="cmr-9">55</span></sup></a><a 
 id="x1-206023x55"></a><span 
class="cmr-8">Guida,  G.;  Mauri,  G.  (July  1986).  ”Evaluation  of  natural  language</span>
<span 
class="cmr-8">processing  systems:  Issues  and  approaches”.  Proceedings  of  the  IEEE.</span>
<span 
class="cmr-8">74 (7): 10261035. doi:10.1109/PROC.1986.13580. ISSN 1558-2256. S2CID</span>
<span 
class="cmr-8">30688575.</span>
</p><!--l. 644--><p class="noindent" ><a 
href="#enmark-56" id="ennote-56"><sup class="textsuperscript"><span 
class="cmr-9">56</span></sup></a><a 
 id="x1-206024x56"></a><span 
class="cmr-8">Turchin, Alexander; Florez Builes, Luisa F. (2021-03-19). ”Using Natural</span>
<span 
class="cmr-8">Language Processing to Measure and Improve Quality of Diabetes Care: A</span>
<span 
class="cmr-8">Systematic Review”. Journal of Diabetes Science and Technology. 15 (3):</span>
<span 
class="cmr-8">553560.</span>
</p>
</div>
                                                    
                                                    
<!--l. 4760--><p class="noindent" >
</p>
<h3 class="likesectionHead"><a 
 id="x1-2070004.5.2"></a>Excercises</h3>
<div class="columns-2">
<!--l. 4762--><p class="noindent" >
  1. What is <span 
class="cmti-10">von Neumann architecture</span>? Explain with the help
     of a neat diagram.
  2. Write about <span 
class="cmti-10">Sherrington’s </span>habituation and its significance
     in Artificial Neural Networks.
  3. What  is  <span 
class="cmti-10">Turing’s  B-type  machine</span>?  Write  about  its
     significance in Artificial Neural Networks.
  4. What is <span 
class="cmti-10">Hebbian learning. </span>Write about its significance in
     Artificial Neural Networks.
  5. Write about the following. </p>
         <ul class="itemize1">
         <li class="itemize">
         <!--l. 4769--><p class="noindent" >Back-propagation networks
         </p></li>
         <li class="itemize">
         <!--l. 4770--><p class="noindent" >Feed-forward networks</p></li></ul>
  6. “Artificial neurons coupled with the theory of connectionism
     gave raise to the field of artificial neural networks...” -
     Comment.
  7. Find out different types of Agents with their PEAS
     representation. Few user cases: <span 
class="cmti-10">Medical Diagnose, Vacuum</span>
     <span 
class="cmti-10">Cleaner, Part -picking Robot, etc.</span>
                                                    
                                                    
  8. Read about speech recognition using Python. Write a small Python
     script that can convert speech to text. Read a bit of the procedure
     at <a 
href="https://realpython.com/python-speech-recognition/" class="url" ><span 
class="cmtt-10">https://realpython.com/python-speech-recognition/</span></a>.
</div>
                                                    
                                                    
<!--l. 4778--><p class="noindent" >
                                                    
                                                    
</p>
<h2 class="chapterHead"><span class="titlemark">Chapter 5</span><br /><a 
 id="x1-2080005"></a>Machine Learning</h2>
<h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-2090005.1"></a>Supervised learning</h3>
<!--l. 4790--><p class="noindent" >Supervised learning (SL) is the machine learning task of learning a
function that maps an input to an output based on example
input-output pairs. It infers a function from labeled training
data consisting of a set of training examples. In supervised
learning, each example is a pair consisting of an input object
(typically a vector) and a desired output value (also called the
supervisory signal). A supervised learning algorithm analyzes the
training data and produces an inferred function, which can be
used for mapping new examples. An optimal scenario will
allow for the algorithm to correctly determine the class labels
for unseen instances. This requires the learning algorithm to
generalize from the training data to unseen situations in a
”reasonable” way (see inductive bias). This statistical quality of an
algorithm is measured through the so-called generalization error.<sup class="textsuperscript"><a 
href="#ennote-57" id="enmark-57"><span 
class="cmr-9">57</span></a></sup>
<sup class="textsuperscript"><a 
href="#ennote-58" id="enmark-58"><span 
class="cmr-9">58</span></a></sup>
</p><!--l. 4792--><p class="noindent" >To solve a given problem of supervised learning, one has to perform
the following steps:
</p><!--l. 4794--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-209002x1">
     <!--l. 4795--><p class="noindent" ><span 
class="cmti-10">Determine the type of training examples. </span>Before  doing
     anything else, the user should decide what kind of data
     is to be used as a training set. In the case of handwriting
     analysis, for example, this might be a single handwritten
     character, an entire handwritten word, an entire sentence
     of handwriting or perhaps a full paragraph of handwriting.
     </p></li>
<li 
  class="enumerate" id="x1-209004x2">
     <!--l. 4796--><p class="noindent" ><span 
class="cmti-10">Gather  a  training  set</span>.  The  training  set  needs  to  be
     representative of the real-world use of the function. Thus,
                                                    
                                                    
     a  set  of  input  objects  is  gathered  and  corresponding
     outputs are also gathered, either from human experts or
     from measurements.
     </p></li>
<li 
  class="enumerate" id="x1-209006x3">
     <!--l. 4797--><p class="noindent" ><span 
class="cmti-10">Determine the input feature representation of the learned</span>
     <span 
class="cmti-10">function</span>. The accuracy of the learned function depends
     strongly on how the input object is represented. Typically,
     the  input  object  is  transformed  into  a  feature  vector,
     which contains a number of features that are descriptive
     of  the  object.  The  number  of  features  should  not  be
     too  large,  because  of  the  curse  of  dimensionality;  but
     should contain enough information to accurately predict
     the output.
     </p></li>
<li 
  class="enumerate" id="x1-209008x4">
     <!--l. 4798--><p class="noindent" ><span 
class="cmti-10">Determine  the  structure  of  the  learned  function  and</span>
     <span 
class="cmti-10">corresponding  learning  algorithm.  </span>For   example,   the
     engineer may choose to use support-vector machines or
     decision trees.
     </p></li>
<li 
  class="enumerate" id="x1-209010x5">
     <!--l. 4799--><p class="noindent" ><span 
class="cmti-10">Complete  the  design.  </span>Run  the  learning  algorithm  on
     the  gathered  training  set.  Some  supervised  learning
     algorithms require the user to determine certain control
     parameters.  These  parameters  may  be  adjusted  by
     optimizing performance on a subset (called a validation
     set) of the training set, or via cross-validation.
     </p></li>
<li 
  class="enumerate" id="x1-209012x6">
     <!--l. 4800--><p class="noindent" ><span 
class="cmti-10">Evaluate  the  accuracy  of  the  learned  function</span>.  After
     parameter adjustment and learning, the performance of
     the resulting function should be measured on a test set
     that is separate from the training set.</p></li></ol>
                                                    
                                                    
<!--l. 4803--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2100005.1"></a>Algorithms</h5>
<!--l. 4805--><p class="noindent" >The most widely used learning algorithms are:
</p><!--l. 4807--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-210002x1">
     <!--l. 4808--><p class="noindent" >Support-vector machines
     </p></li>
<li 
  class="enumerate" id="x1-210004x2">
     <!--l. 4809--><p class="noindent" >Linear regression
     </p></li>
<li 
  class="enumerate" id="x1-210006x3">
     <!--l. 4810--><p class="noindent" >Logistic regression
     </p></li>
<li 
  class="enumerate" id="x1-210008x4">
     <!--l. 4811--><p class="noindent" >Naive Bayes
     </p></li>
<li 
  class="enumerate" id="x1-210010x5">
     <!--l. 4812--><p class="noindent" >Linear discriminant analysis
     </p></li>
<li 
  class="enumerate" id="x1-210012x6">
     <!--l. 4813--><p class="noindent" >Decision trees
     </p></li>
<li 
  class="enumerate" id="x1-210014x7">
                                                    
                                                    
     <!--l. 4814--><p class="noindent" >K-nearest neighbor algorithm
     </p></li>
<li 
  class="enumerate" id="x1-210016x8">
     <!--l. 4815--><p class="noindent" >Neural networks (Multilayer perceptron)
     </p></li>
<li 
  class="enumerate" id="x1-210018x9">
     <!--l. 4816--><p class="noindent" >Similarity learning</p></li></ol>
<!--l. 4819--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2110005.1"></a>Applications</h5>
<!--l. 4821--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-211002x1">
     <!--l. 4822--><p class="noindent" >Bioinformatics
     </p></li>
<li 
  class="enumerate" id="x1-211004x2">
     <!--l. 4823--><p class="noindent" >Cheminformatics
     </p></li>
<li 
  class="enumerate" id="x1-211006x3">
     <!--l. 4824--><p class="noindent" >Quantitative structureactivity relationship
     </p></li>
<li 
  class="enumerate" id="x1-211008x4">
     <!--l. 4825--><p class="noindent" >Database marketing
     </p></li>
<li 
  class="enumerate" id="x1-211010x5">
                                                    
                                                    
     <!--l. 4826--><p class="noindent" >Handwriting recognition
     </p></li>
<li 
  class="enumerate" id="x1-211012x6">
     <!--l. 4827--><p class="noindent" >Information retrieval
     </p></li>
<li 
  class="enumerate" id="x1-211014x7">
     <!--l. 4828--><p class="noindent" >Learning to rank
     </p></li>
<li 
  class="enumerate" id="x1-211016x8">
     <!--l. 4829--><p class="noindent" >Information  extraction  recognition  in  computer  vision
     character recognition detection
     </p></li>
<li 
  class="enumerate" id="x1-211018x9">
     <!--l. 4833--><p class="noindent" >Pattern recognition
     </p></li>
<li 
  class="enumerate" id="x1-211020x10">
     <!--l. 4834--><p class="noindent" >Speech recognition
     </p></li>
<li 
  class="enumerate" id="x1-211022x11">
     <!--l. 4835--><p class="noindent" >Supervised  learning  is  a  special  case  of  downward
     causation in biological systems
     </p></li>
<li 
  class="enumerate" id="x1-211024x12">
     <!--l. 4836--><p class="noindent" >Landform classification using satellite imagery</p></li></ol>
                                                    
                                                    
<!--l. 4839--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.1.1   </span> <a 
 id="x1-2120005.1.1"></a>Logistic regression</h4>
<!--l. 4841--><p class="noindent" >In statistics logistic regression is used to model the probability of a
certain class or event. I will be focusing more on the basics and
implementation of the model, and not go too deep into the math
part. Logistic regression is similar to linear regression because both
of these involve estimating the values of parameters used in the
prediction equation based on the given training data. Linear
regression predicts the value of some continuous, dependent
variable. Whereas logistic regression predicts the probability of
an event or class that is dependent on other factors. Thus
the output of logistic regression always lies between 0 and 1.
Because of this property it is commonly used for classification
purpose.
</p><!--l. 4843--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2130005.1.1"></a>Logistic Model</h5>
<!--l. 4845--><p class="noindent" >Consider a model with features <span 
class="cmti-10">x1, x2, x3 ... xn</span>. Let the binary
output be denoted by <span 
class="cmti-10">Y </span>, that can take the values 0 or 1. Let <span 
class="cmti-10">p </span>be
the probability of <span 
class="cmti-10">Y = 1</span>, we can denote it as <span 
class="cmti-10">p = P(Y=1)</span>. The
mathematical relationship between these variables can be denoted
as:
</p>
<table class="equation"><tr><td>
<!--l. 4847--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
        <mstyle 
   id="x1-213001r1"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mi 
class="MathClass-op">log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--></mrow><mrow 
><mi 
>b</mi></mrow></msub 
>  <mfrac><mrow 
><mi 
>p</mi></mrow>
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>p</mi></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo> <mo 
class="MathClass-bin">+</mo> <msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
>
</math></td><td class="eq-no">(5.1)</td></tr></table>
                                                    
                                                    
<!--l. 4850--><p class="nopar" >
</p><!--l. 4852--><p class="noindent" >Here the term <span 
class="cmti-10">p/(1-p) </span>is known as the odds and denotes
the likelihood of the event taking place. Thus <span 
class="cmti-10">ln(p/(1-p))</span>
is known as the log odds and is simply used to map the
probability that lies between 0 and 1 to a range between
<!--l. 4852--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-bin">−</mo><mi 
>∞</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-bin">+</mo><mi 
>∞</mi><mo 
class="MathClass-close">)</mo></math>. The
terms <span 
class="cmti-10">b0, b1, b2 ... </span>are parameters (or weights) that we will
estimate during training. So this is just the basic math behind what
we are going to do. We are interested in the probability <span 
class="cmti-10">p </span>in this
equation. So we simplify the equation to obtain the value of
<span 
class="cmti-10">p</span>:
</p><!--l. 4854--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-213003x1">
     <!--l. 4855--><p class="noindent" >The log term <span 
class="cmti-10">ln </span>on the LHS can be removed by raising the
     RHS as a power of <span 
class="cmti-10">e</span>: <!--tex4ht:inline--></p><table class="equation"><tr><td>
     <!--l. 4856--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <mstyle 
   id="x1-213004r2"  class="label" ></mstyle><!--endlabel-->   <mfrac><mrow 
><mi 
>p</mi></mrow> 
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">−</mo> <mi 
>p</mi></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
>
                        </mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(5.2)</td></tr></table>
     <!--l. 4859--><p class="nopar" >
     </p></li>
<li 
  class="enumerate" id="x1-213006x2">
     <!--l. 4860--><p class="noindent" >Now we can easily simplify to obtain the value of <span 
class="cmti-10">p</span>:
     <!--tex4ht:inline--></p><table class="equation"><tr><td>
                                                    
                                                    
     <!--l. 4861--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mstyle 
   id="x1-213007r3"  class="label" ></mstyle><!--endlabel--><mi 
>p</mi> <mo 
class="MathClass-rel">=</mo>    <mfrac><mrow 
><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></msup 
></mrow> 
<mrow 
><msup><mrow 
><mi 
>b</mi></mrow><mrow 
><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac> <mo 
class="MathClass-rel">=</mo>              <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mi 
>b</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow></msup 
></mrow></mfrac> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(5.3)</td></tr></table>
     <!--l. 4864--><p class="nopar" >
     </p></li></ol>
<!--l. 4867--><p class="noindent" >This actually turns out to be the equation of the Sigmoid Function
which is widely used in other machine learning applications. The
Sigmoid Function is given by:
</p>
<table class="equation"><tr><td>
<!--l. 4869--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                <mstyle 
   id="x1-213008r4"  class="label" ></mstyle><!--endlabel--><mi 
>σ</mi><mo 
class="MathClass-open">(</mo><mi 
>t</mi><mo 
class="MathClass-close">)</mo> <mo 
class="MathClass-rel">=</mo>    <mfrac><mrow 
><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>t</mi></mrow></msup 
></mrow> 
<mrow 
><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>t</mi></mrow></msup 
> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow></mfrac> <mo 
class="MathClass-rel">=</mo>     <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mi 
>t</mi></mrow></msup 
></mrow></mfrac>
</math></td><td class="eq-no">(5.4)</td></tr></table>
<!--l. 4872--><p class="nopar" >
</p><!--l. 4874--><p class="noindent" >Now we will be using the above derived equation to make our
predictions. Before that we will train our model to obtain the values
of our parameters <span 
class="cmti-10">b0, b1, b2 ... </span>that result in least error. This is
where the error or loss function comes in.
                                                    
                                                    
</p><!--l. 4876--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2140005.1.1"></a>Loss Function</h5>
<!--l. 4878--><p class="noindent" >The loss is basically the error in our predicted value. In other words
it is a difference between our predicted value and the actual value.
We will be using the L2 Loss Function to calculate the error.
Theoretically you can use any function to calculate the error. This
function can be broken down as:
</p><!--l. 4880--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-214002x1">
     <!--l. 4881--><p class="noindent" >Let the actual value be <!--l. 4881--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></math>.
     Let the value predicted using our model be denoted as
     <!--l. 4881--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">^</mo></mover></math>.
     Find the difference between the actual and predicted value.
     </p></li>
<li 
  class="enumerate" id="x1-214004x2">
     <!--l. 4882--><p class="noindent" >Square this difference.
     </p></li>
<li 
  class="enumerate" id="x1-214006x3">
     <!--l. 4883--><p class="noindent" >Find the sum across all the values in training data.
     <!--tex4ht:inline--></p><table class="equation"><tr><td>
     <!--l. 4884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mstyle 
   id="x1-214007r5"  class="label" ></mstyle><!--endlabel--><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo><munderover accentunder="false" accent="false"><mrow  
><mo  
> ∑</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>y</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>i</mi> <mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">¯</mo></mover><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
>
</math></td><td class="eq-no">(5.5)</td></tr></table>
                                                    
                                                    
     <!--l. 4887--><p class="nopar" >
     </p></li></ol>
<!--l. 4890--><p class="noindent" >Now that we have the error, we need to update the values of our
parameters to minimize this error. This is where the learning
actually happens, since our model is updating itself based on its
previous output to obtain a more accurate output in the next step.
Hence with each iteration our model becomes more and more
accurate. We will be using the Gradient Descent Algorithm to
estimate our parameters. Another commonly used algorithm is the
<span 
class="cmti-10">Maximum Likelihood Estimation</span>.
</p><!--l. 4892--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2150005.1.1"></a>The Gradient Descent Algorithm</h5>
<!--l. 4894--><p class="noindent" >You might know that the partial derivative of a function at its
minimum value is equal to <span 
class="cmti-10">0</span>. So gradient descent basically uses
this concept to estimate the parameters or weights of our
model by minimizing the loss function. For simplicity, for the
rest of this tutorial let us assume that our output depends
only on a single feature <span 
class="cmti-10">x</span>. So we can rewrite our equation
as:
</p>
<table class="equation"><tr><td>
<!--l. 4896--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                <mstyle 
   id="x1-215001r6"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>p</mi> <mo 
class="MathClass-rel">=</mo>          <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn> <mo 
class="MathClass-bin">+</mo> <msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mi 
>β</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mi 
>x</mi><mo 
class="MathClass-close">)</mo></mrow></msup 
></mrow></mfrac>
</math></td><td class="eq-no">(5.6)</td></tr></table>
<!--l. 4899--><p class="nopar" >
                                                    
                                                    
</p><!--l. 4901--><p class="noindent" >Thus we need to estimate the values of weights <span 
class="cmti-10">b0 </span>and <span 
class="cmti-10">b1 </span>using our
given training data.
</p><!--l. 4903--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-215003x1">
     <!--l. 4904--><p class="noindent" >Initially let <span 
class="cmti-10">b0=0 </span>and <span 
class="cmti-10">b1=0</span>. Let L be the learning rate.
     The learning rate controls by how much the values of b0
     and b1 are updated at each step in the learning process.
     Here let <span 
class="cmti-10">L=0.001</span>.
     </p></li>
<li 
  class="enumerate" id="x1-215005x2">
     <!--l. 4905--><p class="noindent" >Calculate the partial derivative with respect to b0 and b1.
     The value of the partial derivative will tell us how far the loss
     function is from its minimum value. It is a measure of how
     much our weights need to be updated to attain minimum or
     ideally <span 
class="cmti-10">0 </span>error. In case you have more than one feature,
     you need to calculate the partial derivative for each
     weight <span 
class="cmti-10">b0, b1 ... bn </span>where n is the number of features.
     <!--tex4ht:inline--></p><table class="equation"><tr><td>
     <!--l. 4906--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
<mstyle 
   id="x1-215006r7"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>b</mi><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mn>2</mn><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">¯</mo></mover><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-bin">×</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-bin">×</mo><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">¯</mo></mover><mo 
class="MathClass-close">)</mo><msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>b</mi><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mo 
class="MathClass-bin">−</mo><mn>2</mn><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
  </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>1</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
>
<mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">¯</mo></mover><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-bin">×</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-bin">×</mo><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-bin">−</mo><mover 
accent="true"><mrow 
><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo accent="true">¯</mo></mover><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-bin">×</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
>
</math></td><td class="eq-no">(5.7)</td></tr></table>
     <!--l. 4910--><p class="nopar" >
     </p></li>
<li 
  class="enumerate" id="x1-215008x3">
                                                    
                                                    
     <!--l. 4912--><p class="noindent" >Next we update the values of <span 
class="cmti-10">b0 </span>and <span 
class="cmti-10">b1</span>:
</p>
     <table class="equation"><tr><td>
     <!--l. 4914--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mstyle 
   id="x1-215009r8"  class="label" ></mstyle><!--endlabel--><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <mi 
>L</mi> <mo 
class="MathClass-bin">×</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>b</mi><mn>0</mn></mrow></msub 
><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <mi 
>L</mi> <mo 
class="MathClass-bin">×</mo> <msub><mrow 
><mi 
>D</mi></mrow><mrow 
><mi 
>b</mi><mn>1</mn></mrow></msub 
>
</math></td><td class="eq-no">(5.8)</td></tr></table>
     <!--l. 4918--><p class="nopar" >
     </p></li>
<li 
  class="enumerate" id="x1-215011x4">
     <!--l. 4920--><p class="noindent" >We repeat this process until our loss function is a very small
     value or ideally reaches 0 (meaning no errors and 100%
     accuracy). The number of times we repeat this learning
     process is known as iterations or epochs.</p></li></ol>
<!--l. 4923--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2160005.1.1"></a>Python practice</h5>
<!--l. 4926--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16132"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor16144"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">linear_model</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">LogisticRegressionCV</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor16156"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor16164"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">return_X_y</span><span id="textcolor16170"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor16174"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor16179"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">LogisticRegressionCV</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">cv</span><span id="textcolor16185"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor16191"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216005r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor16203"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span id="textcolor16211"><span 
class="cmtt-8">[</span></span><span id="textcolor16213"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor16218"><span 
class="cmtt-8">:</span></span><span id="textcolor16220"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor16225"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor16231"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216007r7"></a><span 
class="cmr-5">7</span></span><span id="textcolor16234"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict_proba</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span id="textcolor16242"><span 
class="cmtt-8">[</span></span><span id="textcolor16244"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor16249"><span 
class="cmtt-8">:</span></span><span id="textcolor16251"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216009r9"></a><span 
class="cmr-5">9</span></span><span id="textcolor16262"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">score</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">98</span><span 
class="cmtt-8">...</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-216011r11"></a><span 
class="cmr-5">11</span></span></pre>
<!--l. 4939--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.1.2   </span> <a 
 id="x1-2170005.1.2"></a>K-Nearest Neighbors Algorithm (k-NN)</h4>
                                                    
                                                    
<!--l. 4941--><p class="noindent" >The k-nearest neighbors algorithm (k-NN) is a non-parametric
classification method first developed by <span 
class="cmti-10">Evelyn Fix </span>and <span 
class="cmti-10">Joseph</span>
<span 
class="cmti-10">Hodges </span>in 1951, and later expanded by <span 
class="cmti-10">Thomas Cover</span>. <sup class="textsuperscript"><a 
href="#ennote-59" id="enmark-59"><span 
class="cmr-9">59</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-60" id="enmark-60"><span 
class="cmr-9">60</span></a></sup> It is
used for classification and regression. In both cases, the input
consists of the <span 
class="cmti-10">k </span>closest training examples in data set. The
output depends on whether <span 
class="cmti-10">k-NN </span>is used for classification or
regression:
</p><!--l. 4943--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-217002x1">
     <!--l. 4944--><p class="noindent" >In k-NN classification, the output is a class membership.
     An object is classified by a plurality vote of its neighbors,
     with the object being assigned to the class most common
     among its <span 
class="cmti-10">k  </span>nearest neighbors (<span 
class="cmti-10">k  </span>is a positive integer,
     typically  small).  If  <span 
class="cmti-10">k  =  1</span>,  then  the  object  is  simply
     assigned to the class of that single nearest neighbor.
     </p></li>
<li 
  class="enumerate" id="x1-217004x2">
     <!--l. 4945--><p class="noindent" >In k-NN regression, the output is the property value for
     the object. This value is the average of the values of k
     nearest neighbors.
</p>
     </li></ol>
<!--l. 4949--><p class="noindent" >k-NN is a type of classification where the function is only
approximated locally and all computation is deferred until function
evaluation. Since this algorithm relies on distance for classification,
if the features represent different physical units or come in vastly
different scales then normalizing the training data can improve its
accuracy dramatically. <sup class="textsuperscript"><a 
href="#ennote-61" id="enmark-61"><span 
class="cmr-9">61</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-62" id="enmark-62"><span 
class="cmr-9">62</span></a></sup>
</p><!--l. 4951--><p class="noindent" >Both for classification and regression, a useful technique can be to
assign weights to the contributions of the neighbors, so that the
nearer neighbors contribute more to the average than the more
distant ones. For example, a common weighting scheme consists in
giving each neighbor a weight of 1/d, where d is the distance to
the neighbor. The neighbors are taken from a set of objects
for which the class (for k-NN classification) or the object
                                                    
                                                    
property value (for k-NN regression) is known. This can be
thought of as the training set for the algorithm, though no
explicit training step is required. A peculiarity of the k-NN
algorithm is that it is sensitive to the local structure of the
data.
</p><!--l. 4953--><p class="noindent" >Suppose we have pairs <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>
taking values in <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
> <mo 
class="MathClass-bin">×</mo><mo 
class="MathClass-open">{</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn><mo 
class="MathClass-close">}</mo></math>,
where Y is the class label of X, so that
<!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi><mo 
class="MathClass-rel">|</mo><mi 
>Y</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>r</mi> <mo 
class="MathClass-rel">∼</mo> <msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>r</mi></mrow></msub 
></math> for
<!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>r</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn></math> (and probability
distributions <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>P</mi></mrow><mrow 
><mi 
>r</mi></mrow></msub 
></math>.
Given some norm <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><mo 
class="MathClass-bin">⋅</mo><mo 
class="MathClass-rel">∥</mo></math>
on <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math> and
a point <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi> <mo 
class="MathClass-rel">∈</mo> <msup><mrow 
><mi 
>R</mi></mrow><mrow 
><mi 
>d</mi></mrow></msup 
></math>,
let <!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-punc">,</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>Y</mi> </mrow><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
><mo 
class="MathClass-close">)</mo></math>
be a reordering of the training data such that
<!--l. 4953--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><mn>1</mn><mo 
class="MathClass-close">)</mo></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <mi 
>x</mi><mo 
class="MathClass-rel">∥</mo><mo 
class="MathClass-rel">≤</mo><mi 
class="MathClass-op">…</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> <mo 
class="MathClass-rel">≤</mo><mo 
class="MathClass-rel">∥</mo><msub><mrow 
><mi 
>X</mi></mrow><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mo 
class="MathClass-close">)</mo></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <mi 
>x</mi><mo 
class="MathClass-rel">∥</mo></math>.
</p><!--l. 4955--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2180005.1.2"></a>Algorithm</h5>
<!--l. 4957--><p class="noindent" >The training examples are vectors in a multidimensional feature
space, each with a class label. The training phase of the algorithm
consists only of storing the feature vectors and class labels
of the training samples. In the classification phase, <span 
class="cmti-10">k </span>is a
user-defined constant, and an unlabeled vector (a query or
test point) is classified by assigning the label which is most
frequent among the <span 
class="cmti-10">k </span>training samples nearest to that query
point.
</p><!--l. 4959--><p class="noindent" >A commonly used distance metric for continuous variables is
Euclidean distance. For discrete variables, such as for text
classification, another metric can be used, such as the overlap
metric (or Hamming distance). In the context of gene expression
microarray data, for example, k-NN has been employed with
correlation coefficients, such as Pearson and Spearman, as a
metric. Often, the classification accuracy of k-NN can be
improved significantly if the distance metric is learned with
specialized algorithms such as Large Margin Nearest Neighbor or
                                                    
                                                    
Neighbourhood components analysis.
</p><!--l. 4961--><p class="noindent" >A drawback of the basic ”majority voting” classification occurs
when the class distribution is skewed. That is, examples of a more
frequent class tend to dominate the prediction of the new example,
because they tend to be common among the k nearest neighbors
due to their large number. One way to overcome this problem is to
weight the classification, taking into account the distance from the
test point to each of its k nearest neighbors. The class (or value, in
regression problems) of each of the k nearest points is multiplied
by a weight proportional to the inverse of the distance from
that point to the test point. Another way to overcome skew
is by abstraction in data representation. For example, in a
self-organizing map (SOM), each node is a representative (a center)
of a cluster of similar points, regardless of their density in
the original training data. K-NN can then be applied to the
SOM.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-2180011"></a>
                                                    
                                                    
<!--l. 4965--><p class="noindent" ><img 
src="knn.png" alt="PIC"  
width="128" height="113"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5.1:</span><span  
class="content">Example  of  k-NN  classification.  The  test  sample
(green dot) should be classified either to blue squares or to red
triangles. If <span 
class="cmti-10">k = 3  </span>(solid line circle) it is assigned to the red
triangles because there are 2 triangles and only 1 square inside
the inner circle. If <span 
class="cmti-10">k = 5 </span>(dashed line circle) it is assigned to the
blue squares (3 squares vs. 2 triangles inside the outer circle).</span></figcaption><!--tex4ht:label?: x1-2180011 -->
                                                    
                                                    
</figure>
<h5 class="subsubsectionHead"><a 
 id="x1-2190005.1.2"></a>Python practice</h5>
<!--l. 4972--><p class="noindent" >Demonstrate the resolution of a regression problem using a
k-Nearest Neighbor and the interpolation of the target using both
barycenter and constant weights.
</p>
<!--l. 4974--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219001r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219002r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219003r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbors</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219004r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219005r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">seed</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor16311"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sort</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8"> </span><span id="textcolor16320"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">rand</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">40</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">axis</span><span id="textcolor16337"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">T</span><span 
class="cmtt-8"> </span><span id="textcolor16343"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">linspace</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">500</span><span 
class="cmtt-8">)</span><span id="textcolor16358"><span 
class="cmtt-8">[</span></span><span id="textcolor16360"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">newaxis</span><span id="textcolor16367"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor16371"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">sin</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">ravel</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219009r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219010r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Add</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">noise</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">to</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">targets</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219011r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">y</span><span id="textcolor16393"><span 
class="cmtt-8">[</span></span><span id="textcolor16395"><span 
class="cmtt-8">:</span></span><span id="textcolor16397"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8">5</span><span id="textcolor16400"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor16403"><span 
class="cmtt-8">+</span></span><span id="textcolor16405"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span id="textcolor16410"><span 
class="cmtt-8">*</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8"> </span><span id="textcolor16418"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">random</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">rand</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">8</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219012r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219013r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Fit</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">regression</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">model</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219014r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8">n_neighbors</span><span 
class="cmtt-8"> </span><span id="textcolor16439"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">5</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219015r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219016r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weights</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">enumerate</span><span 
class="cmtt-8">(</span><span id="textcolor16454"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">uniform</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">distance</span><span 
class="cmtt-8">’</span><span id="textcolor16464"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span id="textcolor16467"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219017r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">knn</span><span 
class="cmtt-8"> </span><span id="textcolor16471"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">neighbors</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">KNeighborsRegressor</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_neighbors</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weights</span><span id="textcolor16482"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">weights</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219018r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_</span><span 
class="cmtt-8"> </span><span id="textcolor16488"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">knn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219019r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219020r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">subplot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8"> </span><span id="textcolor16517"><span 
class="cmtt-8">+</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219021r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">scatter</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">color</span><span id="textcolor16533"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">darkorange</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">label</span><span id="textcolor16541"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">data</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219022r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">plot</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">T</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y_</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">color</span><span id="textcolor16558"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">navy</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">label</span><span id="textcolor16566"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">prediction</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219023r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">axis</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">tight</span><span 
class="cmtt-8">’</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219024r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">legend</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219025r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">title</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">KNeighborsRegressor</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">k</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">=</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weights</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">=</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">’</span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8">s</span><span 
class="cmtt-8">’)</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8"> </span><span class="lstinline"></span><span 
class="cmtt-8">%</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_neighbors</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">weights</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219026r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219027r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">tight_layout</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219028r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">show</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-219029r29"></a><span 
class="cmr-5">29</span></span></pre>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-2190302"></a>
                                                    
                                                    
<!--l. 5006--><p class="noindent" ><img 
src="knnfig.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5.2:</span><span  
class="content">KNN for both <span 
class="cmti-10">Uniform </span>and <span 
class="cmti-10">distance </span>based weights.</span></figcaption><!--tex4ht:label?: x1-2190302 -->
                                                    
                                                    
</figure>
<h4 class="subsectionHead"><span class="titlemark">5.1.3   </span> <a 
 id="x1-2200005.1.3"></a>Decision Trees</h4>
<!--l. 5013--><p class="noindent" >Decision Trees (DTs) are a non-parametric supervised learning
method used for classification and regression. The goal is to create a
model that predicts the value of a target variable by learning simple
decision rules inferred from the data features. A tree can be seen as
a piecewise constant approximation. For instance, in the example
below, decision trees learn from data to approximate a sine
curve with a set of if-then-else decision rules. The deeper the
tree, the more complex the decision rules and the fitter the
model.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-2200013"></a>
                                                    
                                                    
<!--l. 5016--><p class="noindent" ><img 
src="dtreg.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5.3:</span><span  
class="content">Decision Tree Regression</span></figcaption><!--tex4ht:label?: x1-2200013 -->
                                                    
                                                    
</figure>
<!--l. 5021--><p class="noindent" >Some advantages of decision trees are:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-220003x1">
     <!--l. 5024--><p class="noindent" >Simple  to  understand  and  to  interpret.  Trees  can  be
     visualised.
     </p></li>
<li 
  class="enumerate" id="x1-220005x2">
     <!--l. 5025--><p class="noindent" >Requires little data preparation. Other techniques often
     require data normalisation, dummy variables need to be
     created and blank values to be removed. Note however
     that this module does not support missing values.
     </p></li>
<li 
  class="enumerate" id="x1-220007x3">
     <!--l. 5026--><p class="noindent" >The  cost  of  using  the  tree  (i.e.,  predicting  data)  is
     logarithmic in the number of data points used to train the
     tree.
     </p></li>
<li 
  class="enumerate" id="x1-220009x4">
     <!--l. 5027--><p class="noindent" >Able  to  handle  both  numerical  and  categorical  data.
     However  scikit-learn  implementation  does  not  support
     categorical variables for now. Other techniques are usually
     specialised in analysing datasets that have only one type
     of variable. See algorithms for more information.
     </p></li>
<li 
  class="enumerate" id="x1-220011x5">
     <!--l. 5028--><p class="noindent" >Able to handle multi-output problems.
     </p></li>
<li 
  class="enumerate" id="x1-220013x6">
                                                    
                                                    
     <!--l. 5029--><p class="noindent" >Uses a white box model. If a given situation is observable
     in  a  model,  the  explanation  for  the  condition  is  easily
     explained by boolean logic. By contrast, in a black box
     model (e.g., in an artificial neural network), results may
     be more difficult to interpret.
     </p></li>
<li 
  class="enumerate" id="x1-220015x7">
     <!--l. 5030--><p class="noindent" >Possible to validate a model using statistical tests. That
     makes  it  possible  to  account  for  the  reliability  of  the
     model.
     </p></li>
<li 
  class="enumerate" id="x1-220017x8">
     <!--l. 5031--><p class="noindent" >Performs  well  even  if  its  assumptions  are  somewhat
     violated  by  the  true  model  from  which  the  data  were
     generated.</p></li></ol>
<!--l. 5034--><p class="noindent" >The disadvantages of decision trees include:
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-220019x1">
     <!--l. 5037--><p class="noindent" >Decision-tree learners can create over-complex trees that
     do not generalise the data well. This is called overfitting.
     Mechanisms  such  as  pruning,  setting  the  minimum
     number of samples required at a leaf node or setting the
     maximum depth of the tree are necessary to avoid this
     problem.
     </p></li>
<li 
  class="enumerate" id="x1-220021x2">
     <!--l. 5039--><p class="noindent" >Decision trees can be unstable because small variations in
     the data might result in a completely different tree being
     generated. This problem is mitigated by using decision
     trees within an ensemble.
     </p></li>
<li 
  class="enumerate" id="x1-220023x3">
                                                    
                                                    
     <!--l. 5041--><p class="noindent" >Predictions  of  decision  trees  are  neither  smooth  nor
     continuous, but piecewise constant approximations as seen
     in  the  above  figure.  Therefore,  they  are  not  good  at
     extrapolation.
     </p></li>
<li 
  class="enumerate" id="x1-220025x4">
     <!--l. 5043--><p class="noindent" >The problem of learning an optimal decision tree is known
     to be NP-complete under several aspects of optimality
     and  even  for  simple  concepts.  Consequently,  practical
     decision-tree learning algorithms are based on heuristic
     algorithms  such  as  the  greedy  algorithm  where  locally
     optimal decisions are made at each node. Such algorithms
     cannot guarantee to return the globally optimal decision
     tree. This can be mitigated by training multiple trees in
     an ensemble learner, where the features and samples are
     randomly sampled with replacement.
     </p></li>
<li 
  class="enumerate" id="x1-220027x5">
     <!--l. 5045--><p class="noindent" >There are concepts that are hard to learn because decision
     trees do not express them easily, such as XOR, parity or
     multiplexer problems.
     </p></li>
<li 
  class="enumerate" id="x1-220029x6">
     <!--l. 5047--><p class="noindent" >Decision tree learners create biased trees if some classes
     dominate.  It  is  therefore  recommended  to  balance  the
     dataset prior to fitting with the decision tree.</p></li></ol>
<h5 class="subsubsectionHead"><a 
 id="x1-2210005.1.3"></a>Classification</h5>
<!--l. 5051--><p class="noindent" ><span 
class="cmtt-10">DecisionTreeClassifier </span>is a class capable of performing
multi-class classification on a dataset. As with other
classifiers, <span 
class="cmtt-10">DecisionTreeClassifier </span>takes as input
two arrays: an array <span 
class="cmti-10">X</span>, sparse or dense, of shape
<!--l. 5051--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>f</mi><mi 
>e</mi><mi 
>a</mi><mi 
>t</mi><mi 
>u</mi><mi 
>r</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-close">)</mo></math>
holding the training samples, and an array <span 
class="cmti-10">Y </span>of integer values, shape
                                                    
                                                    
<!--l. 5051--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-close">)</mo></math>,
holding the class labels for the training samples:
</p>
<!--l. 5053--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16627"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor16637"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor16642"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor16645"><span 
class="cmtt-8">[</span></span><span id="textcolor16647"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor16653"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor16657"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor16663"><span 
class="cmtt-8">]</span></span><span id="textcolor16665"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor16667"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Y</span><span 
class="cmtt-8"> </span><span id="textcolor16672"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor16675"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor16681"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor16683"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor16688"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DecisionTreeClassifier</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221005r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor16695"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor16700"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Y</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221006r6"></a><span 
class="cmr-5">6</span></span></pre>
<!--l. 5061--><p class="noindent" >After being fitted, the model can then be used to predict the class
of samples:
</p>
<!--l. 5063--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221007r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16712"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span id="textcolor16719"><span 
class="cmtt-8">[</span></span><span id="textcolor16721"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span id="textcolor16728"><span 
class="cmtt-8">]</span></span><span id="textcolor16730"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221008r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor16735"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor16738"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221009r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 5068--><p class="noindent" >In case that there are multiple classes with the same and highest
probability, the classifier will predict the class with the lowest
index amongst those classes. As an alternative to outputting a
specific class, the probability of each class can be predicted,
which is the fraction of training samples of the class in a
leaf:
</p>
<!--l. 5070--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221010r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16741"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict_proba</span><span 
class="cmtt-8">(</span><span id="textcolor16748"><span 
class="cmtt-8">[</span></span><span id="textcolor16750"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span id="textcolor16757"><span 
class="cmtt-8">]</span></span><span id="textcolor16759"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221011r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor16764"><span 
class="cmtt-8">[</span></span><span id="textcolor16766"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span id="textcolor16773"><span 
class="cmtt-8">]</span></span><span id="textcolor16775"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221012r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 5075--><p class="noindent" ><span 
class="cmtt-10">DecisionTreeClassifier </span>is capable of both binary (where the
labels are <span 
class="cmti-10">[-1, 1]</span>) classification and multiclass (where the labels are
<span 
class="cmti-10">[0,..., K-1]</span>) classification. Using the Iris dataset, we can construct a
tree as follows:
</p>
<!--l. 5077--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221013r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16778"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221014r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor16790"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221015r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor16800"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8"> </span><span id="textcolor16805"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221016r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor16810"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor16818"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">data</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">target</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221017r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor16829"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor16834"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DecisionTreeClassifier</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221018r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor16841"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor16846"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221019r7"></a><span 
class="cmr-5">7</span></span></pre>
<!--l. 5086--><p class="noindent" >Once trained, you can plot the tree with the <span 
class="cmtt-10">plot</span><span 
class="cmtt-10">_tree </span>function:
</p>
<!--l. 5088--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221020r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16858"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">plot_tree</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221021r2"></a><span 
class="cmr-5">2</span></span></pre>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-2210224"></a>
                                                    
                                                    
<!--l. 5093--><p class="noindent" ><img 
src="dtirisplot.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5.4:</span><span  
class="content">Decision Fit on Iris Data Set</span></figcaption><!--tex4ht:label?: x1-2210224 -->
                                                    
                                                    
</figure>
<!--l. 5098--><p class="noindent" >We can also export the tree in <span 
class="cmti-10">Graphviz </span>format using the
<span 
class="cmtt-10">export</span><span 
class="cmtt-10">_graphviz </span>exporter. If you use the conda package manager,
the graphviz binaries and the python package can be installed with
<span 
class="cmtt-10">conda install python-graphviz</span>. <sup class="textsuperscript"><a 
href="#ennote-63" id="enmark-63"><span 
class="cmr-9">63</span></a></sup> Alternatively binaries for
graphviz can be downloaded from the graphviz project homepage,
and the Python wrapper installed from pypi with <span 
class="cmti-10">pip install</span>
<span 
class="cmti-10">graphviz</span>. Below is an example graphviz export of the above tree
trained on the entire iris dataset; the results are saved in an output
file <span 
class="cmti-10">iris.pdf </span>:
</p>
<!--l. 5100--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221023r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16867"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graphviz</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221024r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor16873"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dot_data</span><span 
class="cmtt-8"> </span><span id="textcolor16878"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">export_graphviz</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">out_file</span><span id="textcolor16889"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">None</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221025r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor16893"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor16898"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graphviz</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">Source</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">dot_data</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221026r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor16907"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">render</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221027r5"></a><span 
class="cmr-5">5</span></span></pre>
<!--l. 5107--><p class="noindent" >The <span 
class="cmtt-10">export</span><span 
class="cmtt-10">_graphviz </span>exporter also supports a variety of
aesthetic options, including coloring nodes by their class (or value
for regression) and using explicit variable and class names
if desired. Jupyter notebooks also render these plots inline
automatically:
</p>
<!--l. 5109--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221028r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16918"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dot_data</span><span 
class="cmtt-8"> </span><span id="textcolor16923"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">export_graphviz</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">out_file</span><span id="textcolor16934"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">None</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221029r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">feature_names</span><span id="textcolor16942"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">feature_names</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221030r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">class_names</span><span id="textcolor16952"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">target_names</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221031r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">filled</span><span id="textcolor16962"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">rounded</span><span id="textcolor16968"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221032r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">special_characters</span><span id="textcolor16976"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">True</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221033r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor16980"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span><span 
class="cmtt-8"> </span><span id="textcolor16985"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graphviz</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">Source</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">dot_data</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221034r7"></a><span 
class="cmr-5">7</span></span><span id="textcolor16994"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">graph</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-221035r8"></a><span 
class="cmr-5">8</span></span></pre>
<h5 class="subsubsectionHead"><a 
 id="x1-2220005.1.3"></a>Regression</h5>
<!--l. 5121--><p class="noindent" >Decision trees can also be applied to regression problems, using the
<span 
class="cmtt-10">DecisionTreeRegressor </span>class. As in the classification setting, the
fit method will take as argument arrays <span 
class="cmti-10">X </span>and <span 
class="cmti-10">y</span>, only that in this
case <span 
class="cmti-10">y </span>is expected to have floating point values instead of integer
values:
</p>
<!--l. 5123--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor16998"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17008"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor17013"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17016"><span 
class="cmtt-8">[</span></span><span id="textcolor17018"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17024"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17028"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17034"><span 
class="cmtt-8">]</span></span><span id="textcolor17036"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor17038"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor17043"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17046"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span id="textcolor17056"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor17058"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor17063"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">tree</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">DecisionTreeRegressor</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222005r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17070"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor17075"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222006r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor17087"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span id="textcolor17094"><span 
class="cmtt-8">[</span></span><span id="textcolor17096"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17102"><span 
class="cmtt-8">]</span></span><span id="textcolor17104"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222007r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17109"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span id="textcolor17114"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-222008r8"></a><span 
class="cmr-5">8</span></span></pre>
<!--l. 5133--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.1.4   </span> <a 
 id="x1-2230005.1.4"></a>Support Vector Machines</h4>
                                                    
                                                    
<!--l. 5135--><p class="noindent" >Support vector machines (SVMs) are a set of supervised learning
methods used for classification, regression and outliers detection.
The advantages of support vector machines are:
</p><!--l. 5137--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-223002x1">
     <!--l. 5138--><p class="noindent" >Effective in high dimensional spaces.
     </p></li>
<li 
  class="enumerate" id="x1-223004x2">
     <!--l. 5140--><p class="noindent" >Still  effective  in  cases  where  number  of  dimensions  is
     greater than the number of samples.
     </p></li>
<li 
  class="enumerate" id="x1-223006x3">
     <!--l. 5142--><p class="noindent" >Uses a subset of training points in the decision function
     (called support vectors), so it is also memory efficient.
     </p></li>
<li 
  class="enumerate" id="x1-223008x4">
     <!--l. 5144--><p class="noindent" ><span 
class="cmti-10">Versatile</span>: different Kernel functions can be specified for
     the decision function. Common kernels are provided, but
     it is also possible to specify custom kernels.</p></li></ol>
<!--l. 5147--><p class="noindent" >The disadvantages of support vector machines include:
</p><!--l. 5149--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-223010x1">
     <!--l. 5150--><p class="noindent" >If the number of features is much greater than the number
     of samples, avoid over-fitting in choosing Kernel functions
     and regularization term is crucial.
     </p></li>
<li 
  class="enumerate" id="x1-223012x2">
                                                    
                                                    
     <!--l. 5152--><p class="noindent" >SVMs do not directly provide probability estimates, these
     are calculated using an expensive five-fold cross-validation
     (see Scores and probabilities, below).</p></li></ol>
<!--l. 5155--><p class="noindent" >The support vector machines in scikit-learn support both dense
(<span 
class="cmtt-10">numpy.ndarray </span>and convertible to that by <span 
class="cmtt-10">numpy.asarray</span>) and
sparse (any <span 
class="cmtt-10">scipy.sparse</span>) sample vectors as input. However, to
use an SVM to make predictions for sparse data, it must have been
fit on such data. For optimal performance, use C-ordered
<span 
class="cmtt-10">numpy.ndarray </span>(dense) or <span 
class="cmtt-10">scipy.sparse.csr</span><span 
class="cmtt-10">_matrix </span>(sparse)
with <span 
class="cmtt-10">dtype=float64</span>.
</p><!--l. 5157--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2240005.1.4"></a>Classification</h5>
<!--l. 5159--><p class="noindent" ><span 
class="cmti-10">SVC, NuSVC </span>and <span 
class="cmti-10">LinearSVC </span>are classes capable of performing
binary and multi-class classification on a dataset. <span 
class="cmti-10">SVC </span>and
<span 
class="cmti-10">NuSVC </span>are similar methods, but accept slightly different sets of
parameters and have different mathematical formulations
(see section Mathematical formulation). On the other hand,
<span 
class="cmti-10">LinearSVC </span>is another (faster) implementation of Support
Vector Classification for the case of a linear kernel. Note that
<span 
class="cmti-10">LinearSVC </span>does not accept parameter kernel, as this is assumed to
be linear. It also lacks some of the attributes of <span 
class="cmti-10">SVC </span>and
<span 
class="cmti-10">NuSVC</span>, like <span 
class="cmtt-10">support</span><span 
class="cmtt-10">_</span>. As other classifiers, SVC, NuSVC and
<span 
class="cmti-10">LinearSVC </span>take as input two arrays: an array X of shape
<!--l. 5159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>f</mi><mi 
>e</mi><mi 
>a</mi><mi 
>t</mi><mi 
>u</mi><mi 
>r</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-close">)</mo></math> holding
the training samples, and an array <span 
class="cmti-10">y </span>of class labels (strings or integers),
of shape <!--l. 5159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-open">(</mo><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>a</mi><mi 
>m</mi><mi 
>p</mi><mi 
>l</mi><mi 
>e</mi><mi 
>s</mi><mo 
class="MathClass-close">)</mo></math>:
</p>
<!--l. 5161--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17117"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17127"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor17132"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17135"><span 
class="cmtt-8">[</span></span><span id="textcolor17137"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17143"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17147"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17153"><span 
class="cmtt-8">]</span></span><span id="textcolor17155"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor17157"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor17162"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17165"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17171"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor17173"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8"> </span><span id="textcolor17178"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">SVC</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224005r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17185"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">SVC</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224007r7"></a><span 
class="cmr-5">7</span></span></pre>
<!--l. 5170--><p class="noindent" >After being fitted, the model can then be used to predict new
values:
</p>
<!--l. 5172--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224008r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17199"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span id="textcolor17206"><span 
class="cmtt-8">[</span></span><span id="textcolor17208"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span id="textcolor17215"><span 
class="cmtt-8">]</span></span><span id="textcolor17217"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224009r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17222"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span id="textcolor17225"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224010r3"></a><span 
class="cmr-5">3</span></span></pre>
<!--l. 5177--><p class="noindent" >SVMs decision function (detailed in the Mathematical formulation)
                                                    
                                                    
depends on some subset of the training data, called the support vectors.
Some properties of these support vectors can be found in attributes
<!--l. 5177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mi 
>u</mi><mi 
>p</mi><mi 
>p</mi><mi 
>o</mi><mi 
>r</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>v</mi><mi 
>e</mi><mi 
>c</mi><mi 
>t</mi><mi 
>o</mi><mi 
>r</mi><mi 
>s</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mo 
class="MathClass-punc">,</mo><mi 
>s</mi><mi 
>u</mi><mi 
>p</mi><mi 
>p</mi><mi 
>o</mi><mi 
>r</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>a</mi><mi 
>n</mi><mi 
>d</mi><mi 
>n</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle><mi 
>s</mi><mi 
>u</mi><mi 
>p</mi><mi 
>p</mi><mi 
>o</mi><mi 
>r</mi><mi 
>t</mi><mstyle 
class="mbox"><mtext  >_</mtext></mstyle></math>:
</p>
<!--l. 5179--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224011r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17228"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">support</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vectors</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224012r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17238"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">support_vectors_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224013r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17246"><span 
class="cmtt-8">[</span></span><span id="textcolor17248"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span id="textcolor17255"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224014r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor17258"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span id="textcolor17265"><span 
class="cmtt-8">]</span></span><span id="textcolor17267"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224015r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17270"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">indices</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">support</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vectors</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224016r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor17284"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">support_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224017r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17292"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17298"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">...)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224018r8"></a><span 
class="cmr-5">8</span></span><span id="textcolor17301"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">get</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">number</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">support</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">vectors</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">for</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">each</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">class</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224019r9"></a><span 
class="cmr-5">9</span></span><span id="textcolor17321"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clf</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">n_support_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224020r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17329"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17335"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">...)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-224021r11"></a><span 
class="cmr-5">11</span></span></pre>
<!--l. 5192--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2250005.1.4"></a>Regression</h5>
<!--l. 5194--><p class="noindent" >The method of Support Vector Classification can be extended to
solve regression problems. This method is called Support Vector
Regression. The model produced by support vector classification (as
described above) depends only on a subset of the training
data, because the cost function for building the model does
not care about training points that lie beyond the margin.
Analogously, the model produced by Support Vector Regression
depends only on a subset of the training data, because the cost
function ignores samples whose prediction is close to their
target.
</p><!--l. 5196--><p class="noindent" >There are three different implementations of Support Vector
Regression: <span 
class="cmti-10">SVR, NuSVR </span>and <span 
class="cmti-10">LinearSVR</span>. <span 
class="cmti-10">LinearSVR </span>provides a
faster implementation than <span 
class="cmti-10">SVR </span>but only considers the linear
kernel, while <span 
class="cmti-10">NuSVR </span>implements a slightly different formulation
than <span 
class="cmti-10">SVR </span>and <span 
class="cmti-10">LinearSVR</span>. As with classification classes, the fit
method will take as argument vectors <span 
class="cmti-10">X, y</span>, only that in this case <span 
class="cmti-10">y</span>
is expected to have floating point values instead of integer
values:
</p>
<!--l. 5198--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225001r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17338"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225002r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17348"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor17353"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17356"><span 
class="cmtt-8">[</span></span><span id="textcolor17358"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17364"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17368"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17374"><span 
class="cmtt-8">]</span></span><span id="textcolor17376"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225003r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor17378"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8"> </span><span id="textcolor17383"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span id="textcolor17386"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span id="textcolor17396"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225004r4"></a><span 
class="cmr-5">4</span></span><span id="textcolor17398"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">regr</span><span 
class="cmtt-8"> </span><span id="textcolor17403"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">svm</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">SVR</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225005r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17410"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">regr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">y</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225006r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">SVR</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225007r7"></a><span 
class="cmr-5">7</span></span><span id="textcolor17424"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">regr</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span id="textcolor17431"><span 
class="cmtt-8">[</span></span><span id="textcolor17433"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span id="textcolor17439"><span 
class="cmtt-8">]</span></span><span id="textcolor17441"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225008r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17446"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">5</span><span id="textcolor17451"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-225009r9"></a><span 
class="cmr-5">9</span></span></pre>
<!--l. 5209--><p class="noindent" >
</p>
<h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-2260005.2"></a>Unsupervised learning</h3>
                                                    
                                                    
<!--l. 5211--><p class="noindent" >Unsupervised learning (UL) is a type of algorithm that learns
patterns from untagged data. The hope is that, through mimicry,
the machine is forced to build a compact internal representation of
its world and then generate imaginative content. In contrast to
supervised learning (SL) where data is tagged by a human,
e.g. as ”car” or ”fish” etc, UL exhibits self-organization that
captures patterns as neuronal predilections or probability
densities. The other levels in the supervision spectrum are
reinforcement learning where the machine is given only a numerical
performance score as its guidance, and semi-supervised learning
where a smaller portion of the data is tagged. Two broad
methods in UL are Neural Networks and Probabilistic Methods.
<sup class="textsuperscript"><a 
href="#ennote-64" id="enmark-64"><span 
class="cmr-9">64</span></a></sup>
</p><!--l. 5213--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.1   </span> <a 
 id="x1-2270005.2.1"></a>Approaches</h4>
<!--l. 5215--><p class="noindent" >Some of the most common algorithms used in unsupervised learning
include: (1) Clustering, (2) Anomaly detection, (3) Neural
Networks, and (4) Approaches for learning latent variable models.
Each approach uses several methods as follows:
</p><!--l. 5217--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-227002x1">
     <!--l. 5218--><p class="noindent" ><span 
class="cmti-10">Clustering   methods   </span>include:   hierarchical   clustering,
     k-means,   mixture   models,   DBSCAN,   and   OPTICS
     algorithm
     </p></li>
<li 
  class="enumerate" id="x1-227004x2">
     <!--l. 5219--><p class="noindent" ><span 
class="cmti-10">Anomaly detection methods </span>include: Local Outlier Factor,
     and Isolation Forest
     </p></li>
<li 
  class="enumerate" id="x1-227006x3">
                                                    
                                                    
     <!--l. 5220--><p class="noindent" >Approaches  for  learning  latent  variable  models  such
     as  Expectationmaximization  algorithm  (EM),  Method
     of  moments,  and  Blind  signal  separation  techniques
     (Principal component analysis, Independent component
     analysis,  Non-negative  matrix  factorization,  Singular
     value decomposition)
     </p></li>
<li 
  class="enumerate" id="x1-227008x4">
     <!--l. 5221--><p class="noindent" ><span 
class="cmti-10">Neural Networks methods  </span>include:  Autoencoders,  Deep
     Belief  Nets,  Hebbian  Learning,  Generative  adversarial
     networks, and Self-organizing map</p></li></ol>
<!--l. 5224--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.2   </span> <a 
 id="x1-2280005.2.2"></a>Clustering</h4>
<!--l. 5226--><p class="noindent" >Cluster analysis was originated in anthropology by Driver and
Kroeber in 1932 and introduced to psychology by Joseph Zubin in
1938 and Robert Tryon in 1939 and famously used by Cattell
beginning in 1943 for trait theory classification in personality
psychology. <sup class="textsuperscript"><a 
href="#ennote-65" id="enmark-65"><span 
class="cmr-9">65</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-66" id="enmark-66"><span 
class="cmr-9">66</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-67" id="enmark-67"><span 
class="cmr-9">67</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-68" id="enmark-68"><span 
class="cmr-9">68</span></a></sup>
</p><!--l. 5228--><p class="noindent" >Cluster analysis or clustering is the task of grouping a set of objects
in such a way that objects in the same group (called a cluster) are
more similar to each other than to those in other groups (clusters).
It is a main task of exploratory data analysis, and a common
technique for statistical data analysis, used in many fields, including
pattern recognition, image analysis, information retrieval,
bioinformatics, data compression, computer graphics and machine
learning.
</p><!--l. 5230--><p class="noindent" >Cluster analysis itself is not one specific algorithm, but the general
task to be solved. It can be achieved by various algorithms that
differ significantly in their understanding of what constitutes a
cluster and how to efficiently find them. Popular notions of clusters
include groups with small distances between cluster members,
dense areas of the data space, intervals or particular statistical
distributions. Clustering can therefore be formulated as a
multi-objective optimization problem. The appropriate clustering
                                                    
                                                    
algorithm and parameter settings (including parameters such as the
distance function to use, a density threshold or the number of
expected clusters) depend on the individual data set and
intended use of the results. Cluster analysis as such is not an
automatic task, but an iterative process of knowledge discovery or
interactive multi-objective optimization that involves trial and
failure. It is often necessary to modify data preprocessing
and model parameters until the result achieves the desired
properties.
</p><!--l. 5232--><p class="noindent" >Besides the term clustering, there are a number of terms with
similar meanings, including automatic classification, numerical
taxonomy, botryology, typological analysis, and community
detection. The subtle differences are often in the use of the results:
while in data mining, the resulting groups are the matter of
interest, in automatic classification the resulting discriminative
power is of interest.
</p><!--l. 5234--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.3   </span> <a 
 id="x1-2290005.2.3"></a>Algorithms for clustering</h4>
<!--l. 5236--><p class="noindent" >Clustering algorithms can be categorized based on their cluster
model. The following overview will only list the most prominent
examples of clustering algorithms, as there are possibly over 100
published clustering algorithms. Not all provide models for their
clusters and can thus not easily be categorized. An overview of
algorithms explained in Wikipedia can be found in the list of
statistics algorithms.
</p><!--l. 5238--><p class="noindent" >There is no objectively “correct” clustering algorithm, but
as it was noted, “clustering is in the eye of the beholder.”
The most appropriate clustering algorithm for a particular
problem often needs to be chosen experimentally, unless there
is a mathematical reason to prefer one cluster model over
another. An algorithm that is designed for one kind of model will
generally fail on a data set that contains a radically different
kind of model. For example, k-means cannot find non-convex
clusters. <sup class="textsuperscript"><a 
href="#ennote-69" id="enmark-69"><span 
class="cmr-9">69</span></a></sup> Following are some of the algorithms available for
clustering.
</p><!--l. 5240--><p class="noindent" >
                                                    
                                                    
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-229002x1">
     <!--l. 5241--><p class="noindent" ><span 
class="cmti-10">Connectivity models</span>: for example, hierarchical clustering
     builds models based on distance connectivity.
     </p></li>
<li 
  class="enumerate" id="x1-229004x2">
     <!--l. 5242--><p class="noindent" ><span 
class="cmti-10">Centroid  models</span>:  for  example,  the  k-means  algorithm
     represents each cluster by a single mean vector.
     </p></li>
<li 
  class="enumerate" id="x1-229006x3">
     <!--l. 5243--><p class="noindent" ><span 
class="cmti-10">Distribution models</span>: clusters are modeled using statistical
     distributions,  such  as  multivariate  normal  distributions
     used by the expectation-maximization algorithm.
     </p></li>
<li 
  class="enumerate" id="x1-229008x4">
     <!--l. 5244--><p class="noindent" ><span 
class="cmti-10">Density  models</span>:  for  example,  DBSCAN  and  OPTICS
     defines clusters as connected dense regions in the data
     space.
     </p></li>
<li 
  class="enumerate" id="x1-229010x5">
     <!--l. 5245--><p class="noindent" ><span 
class="cmti-10">Subspace       models</span>:        in        biclustering        (also
     known as co-clustering or two-mode-clustering), clusters
     are  modeled  with  both  cluster  members  and  relevant
     attributes.
     </p></li>
<li 
  class="enumerate" id="x1-229012x6">
     <!--l. 5246--><p class="noindent" ><span 
class="cmti-10">Group models</span>: some algorithms do not provide a refined
     model  for  their  results  and  just  provide  the  grouping
     information.
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-229014x7">
     <!--l. 5247--><p class="noindent" ><span 
class="cmti-10">Graph-based models</span>: a clique, that is, a subset of nodes
     in a graph such that every two nodes in the subset are
     connected by an edge can be considered as a prototypical
     form of cluster. Relaxations of the complete connectivity
     requirement  (a  fraction  of  the  edges  can  be  missing)
     are  known  as  quasi-cliques,  as  in  the  HCS  clustering
     algorithm.
     </p></li>
<li 
  class="enumerate" id="x1-229016x8">
     <!--l. 5248--><p class="noindent" ><span 
class="cmti-10">Signed graph models</span>: Every path in a signed graph has a
     sign from the product of the signs on the edges. Under the
     assumptions of balance theory, edges may change sign and
     result in a bifurcated graph. The weaker ”clusterability
     axiom” (no cycle has exactly one negative edge) yields
     results with more than two clusters, or subgraphs with
     only positive edges.
     </p></li>
<li 
  class="enumerate" id="x1-229018x9">
     <!--l. 5249--><p class="noindent" ><span 
class="cmti-10">Neural models: </span>the most well known unsupervised neural
     network is the self-organizing map and these models can
     usually be characterized as similar to one or more of the
     above models, and including subspace models when neural
     networks  implement  a  form  of  Principal  Component
     Analysis or Independent Component Analysis.</p></li></ol>
<!--l. 5252--><p class="noindent" >A “clustering” is essentially a set of such clusters, usually
containing all objects in the data set. Additionally, it may specify
the relationship of the clusters to each other, for example, a
hierarchy of clusters embedded in each other. Clusterings can be
roughly distinguished as:
</p><!--l. 5254--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-229020x1">
                                                    
                                                    
     <!--l. 5255--><p class="noindent" ><span 
class="cmti-10">Hard clustering</span>: each object belongs to a cluster or not
     </p></li>
<li 
  class="enumerate" id="x1-229022x2">
     <!--l. 5256--><p class="noindent" ><span 
class="cmti-10">Soft clustering (fuzzy clustering)</span>: each object belongs to
     each cluster to a certain degree (for example, a likelihood
     of belonging to the cluster)</p></li></ol>
<!--l. 5259--><p class="noindent" >There are also finer distinctions possible, for example:
</p><!--l. 5261--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-229024x1">
     <!--l. 5262--><p class="noindent" ><span 
class="cmti-10">Strict  partitioning  clustering</span>:  each  object  belongs  to
     exactly one cluster
     </p></li>
<li 
  class="enumerate" id="x1-229026x2">
     <!--l. 5263--><p class="noindent" ><span 
class="cmti-10">Strict  partitioning  clustering  with  outliers</span>:  objects  can
     also  belong  to  no  cluster,  and  are  considered  outliers
     Overlapping   clustering   (also:   alternative   clustering,
     multi-view clustering): objects may belong to more than
     one cluster; usually involving hard clusters
     </p></li>
<li 
  class="enumerate" id="x1-229028x3">
     <!--l. 5265--><p class="noindent" ><span 
class="cmti-10">Hierarchical  clustering</span>:  objects  that  belong  to  a  child
     cluster also belong to the parent cluster
     </p></li>
<li 
  class="enumerate" id="x1-229030x4">
     <!--l. 5266--><p class="noindent" ><span 
class="cmti-10">Subspace  clustering</span>:  while  an  overlapping  clustering,
     within  a  uniquely  defined  subspace,  clusters  are  not
     expected to overlap</p></li></ol>
                                                    
                                                    
<!--l. 5269--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.4   </span> <a 
 id="x1-2300005.2.4"></a>K-Means clustering</h4>
<!--l. 5271--><p class="noindent" >Also known as centroid-based clustering. In centroid-based
clustering clusters are represented by a central vector, which may
not necessarily be a member of the data set. When the number of
clusters is fixed to <span 
class="cmti-10">k</span>, k-means clustering gives a formal definition as
an optimization problem: find the <span 
class="cmti-10">k </span>cluster centers and assign the
objects to the nearest cluster center, such that the squared
distances from the cluster are minimized.
</p><!--l. 5273--><p class="noindent" >The optimization problem itself is known to be NP-hard, and thus
the common approach is to search only for approximate solutions. A
particularly well known approximate method is <span 
class="cmti-10">Lloyd’s algorithm</span>,
often just referred to as “k-means algorithm”. It does however only
find a local optimum, and is commonly run multiple times with
different random initializations. Variations of k-means often include
such optimizations as choosing the best of multiple runs, but also
restricting the centroids to members of the data set (k-medoids),
choosing medians (k-medians clustering), choosing the initial
centers less randomly (k-means++) or allowing a fuzzy cluster
assignment (fuzzy c-means).
</p><!--l. 5275--><p class="noindent" >Most k-means-type algorithms require the number of clusters - k -
to be specified in advance, which is considered to be one of
the biggest drawbacks of these algorithms. Furthermore, the
algorithms prefer clusters of approximately similar size, as they
will always assign an object to the nearest centroid. This
often leads to incorrectly cut borders of clusters (which is not
surprising since the algorithm optimizes cluster centers, not cluster
borders).
</p><!--l. 5277--><p class="noindent" >K-means has a number of interesting theoretical properties. First, it
partitions the data space into a structure known as a Voronoi
diagram. Second, it is conceptually close to nearest neighbor
classification, and as such is popular in machine learning. Third, it
can be seen as a variation of model based clustering, and Lloyd’s
algorithm as a variation of the Expectation-maximization algorithm
for this model discussed below.
</p><!--l. 5279--><p class="noindent" >Centroid-based clustering problems such as <span 
class="cmti-10">k-means </span>and <span 
class="cmti-10">k-medoids</span>
are special cases of the uncapacitated, metric facility location
problem, a canonical problem in the operations research and
                                                    
                                                    
computational geometry communities. In a basic facility location
problem (of which there are numerous variants that model more
elaborate settings), the task is to find the best warehouse locations
to optimally service a given set of consumers. One may view
“warehouses” as cluster centroids and “consumer locations” as
the data to be clustered. This makes it possible to apply the
well-developed algorithmic solutions from the facility location
literature to the presently considered centroid-based clustering
problem.
</p><!--l. 5281--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.5   </span> <a 
 id="x1-2310005.2.5"></a>K-Means clustering using Python</h4>
<!--l. 5283--><p class="noindent" >Clustering of unlabeled data can be performed with the module
<span 
class="cmtt-10">sklearn.cluster</span>. Each clustering algorithm comes in two variants:
a <span 
class="cmti-10">class, </span>that implements the <span 
class="cmtt-10">fit </span>method to learn the clusters on
train data, and a <span 
class="cmti-10">function</span>, that, given train data, returns an array
of integer labels corresponding to the different clusters. For the
class, the labels over the training data can be found in the <span 
class="cmtt-10">labels</span><span 
class="cmtt-10">_</span>
attribute.
</p><!--l. 5285--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2320005.2.5"></a>clustering algorithms in <span 
class="cmti-10">scikit-learn</span></h5>
<!--l. 5287--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-232002x1">
     <!--l. 5288--><p class="noindent" >K-Means
     </p></li>
<li 
  class="enumerate" id="x1-232004x2">
     <!--l. 5289--><p class="noindent" >Affinity propagation
                                                    
                                                    
     </p></li>
<li 
  class="enumerate" id="x1-232006x3">
     <!--l. 5290--><p class="noindent" >Mean-shift
     </p></li>
<li 
  class="enumerate" id="x1-232008x4">
     <!--l. 5291--><p class="noindent" >Spectral clustering
     </p></li>
<li 
  class="enumerate" id="x1-232010x5">
     <!--l. 5292--><p class="noindent" >Ward hierarchical clustering
     </p></li>
<li 
  class="enumerate" id="x1-232012x6">
     <!--l. 5293--><p class="noindent" >Agglomerative clustering
     </p></li>
<li 
  class="enumerate" id="x1-232014x7">
     <!--l. 5294--><p class="noindent" >DBSCAN
     </p></li>
<li 
  class="enumerate" id="x1-232016x8">
     <!--l. 5295--><p class="noindent" >OPTICS
     </p></li>
<li 
  class="enumerate" id="x1-232018x9">
     <!--l. 5296--><p class="noindent" >Gaussian mixtures
     </p></li>
<li 
  class="enumerate" id="x1-232020x10">
     <!--l. 5297--><p class="noindent" >BIRCH</p></li></ol>
<!--l. 5300--><p class="noindent" >The <span 
class="cmti-10">KMeans </span>algorithm clusters data by trying to separate samples
in n groups of equal variance, minimizing a criterion known as the
                                                    
                                                    
inertia or within-cluster sum-of-squares (see below). This algorithm
requires the number of clusters to be specified. It scales well to large
number of samples and has been used across a large range
of application areas in many different fields. The k-means
algorithm divides a set of samples into disjoint clusters , each
described by the mean of the samples in the cluster. The means
are commonly called the cluster centroids; note that they
are not, in general, points from , although they live in the
same space. The K-means algorithm aims to choose centroids
that minimize the inertia, or within-cluster sum-of-squares
criterion:
</p>
<table class="equation"><tr><td>
<!--l. 5302--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
               <mstyle 
   id="x1-232021r9"  class="label" ></mstyle><!--endlabel--><munderover accentunder="false" accent="false"><mrow  
><mo  
>∑</mo>
   </mrow><mrow 
><mi 
>i</mi><mo 
class="MathClass-rel">=</mo><mn>0</mn></mrow><mrow 
><mi 
>n</mi></mrow></munderover 
> <mfrac><mrow 
><mi 
>m</mi><mi 
>i</mi><mi 
>n</mi></mrow>
<mrow 
><msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>j</mi><mo 
class="MathClass-rel">∈</mo><mi 
>c</mi></mrow></msub 
></mrow></mfrac><mo 
class="MathClass-open">(</mo><mo 
class="MathClass-rel">|</mo><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>μ</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo><msup><mrow 
><mo 
class="MathClass-rel">|</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo>
</math></td><td class="eq-no">(5.9)</td></tr></table>
<!--l. 5305--><p class="nopar" >
</p><!--l. 5307--><p class="noindent" >Inertia can be recognized as a measure of how internally
coherent clusters are. It suffers from various drawbacks. <sup class="textsuperscript"><a 
href="#ennote-70" id="enmark-70"><span 
class="cmr-9">70</span></a></sup>.
The k-means problem is solved using either <span 
class="cmti-10">Lloyds </span>or <span 
class="cmti-10">Elkans</span>
algorithm. <span 
class="cmbx-10">The average complexity is given by </span><span 
class="cmbxti-10">O(k n</span>
<span 
class="cmbxti-10">T)</span><span 
class="cmbx-10">, where </span><span 
class="cmbxti-10">n </span><span 
class="cmbx-10">is the number of samples and </span><span 
class="cmbxti-10">T </span><span 
class="cmbx-10">is the</span>
<span 
class="cmbx-10">number of iteration. </span>The worst case complexity is given by
<!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>O</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>k</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn><mo 
class="MathClass-bin">∕</mo><mi 
>p</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math> with
n = samples, p = features. In practice, the k-means algorithm is
very fast (one of the fastest clustering algorithms available), but it
falls in <span 
class="cmti-10">local minima</span>. Thats why it can be useful to restart it several
times. If the algorithm stops before fully converging (because of <span 
class="cmtt-10">tol</span>
or <!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >max_iter</mtext></mstyle></math>),
<!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >labels_</mtext></mstyle></math> and
<!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >cluster_centers_</mtext></mstyle></math> will not be
                                                    
                                                    
consistent, i.e. the <!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >cluster_centers_</mtext></mstyle></math>
will not be the means of the points in each cluster. Also, the estimator will reassign
<!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >labels_</mtext></mstyle></math> after the last
iteration to make <!--l. 5307--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="mbox"><mtext class="texttt" mathvariant="monospace" >labels_</mtext></mstyle></math>
consistent with predict on the training set.
</p>
<!--l. 5309--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232022r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17454"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cluster</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">KMeans</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232023r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17466"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232024r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor17476"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor17481"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17488"><span 
class="cmtt-8">[</span></span><span id="textcolor17490"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17496"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17500"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor17506"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17510"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17516"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232025r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor17522"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17528"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17532"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor17538"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17542"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17548"><span 
class="cmtt-8">]</span></span><span id="textcolor17550"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232026r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17553"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">kmeans</span><span 
class="cmtt-8"> </span><span id="textcolor17558"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">KMeans</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">n_clusters</span><span id="textcolor17564"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">random_state</span><span id="textcolor17570"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232027r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor17579"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">kmeans</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">labels_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232028r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17587"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17605"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dtype</span><span id="textcolor17610"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">int32</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232029r8"></a><span 
class="cmr-5">8</span></span><span id="textcolor17614"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">kmeans</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">predict</span><span 
class="cmtt-8">(</span><span id="textcolor17621"><span 
class="cmtt-8">[</span></span><span id="textcolor17623"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17629"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17633"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">12</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">3</span><span id="textcolor17639"><span 
class="cmtt-8">]</span></span><span id="textcolor17641"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232030r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17646"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17652"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dtype</span><span id="textcolor17657"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">int32</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232031r10"></a><span 
class="cmr-5">10</span></span><span id="textcolor17661"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">kmeans</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cluster_centers_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232032r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17669"><span 
class="cmtt-8">[</span></span><span id="textcolor17671"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">10</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span id="textcolor17679"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232033r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor17682"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">.,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span 
class="cmtt-8">.</span><span id="textcolor17691"><span 
class="cmtt-8">]</span></span><span id="textcolor17693"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-232034r13"></a><span 
class="cmr-5">13</span></span></pre>
<!--l. 5324--><p class="noindent" >
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2.6   </span> <a 
 id="x1-2330005.2.6"></a>Hierarchical clustering</h4>
<!--l. 5326--><p class="noindent" >Hierarchical clustering is a method of cluster analysis which seeks
to build a hierarchy of clusters. Strategies for hierarchical clustering
generally fall into two types:
</p><!--l. 5328--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-233002x1">
     <!--l. 5329--><p class="noindent" ><span 
class="cmti-10">Agglomerative</span>:  This  is  a  “bottom-up”  approach:  each
     observation starts in its own cluster, and pairs of clusters
     are merged as one moves up the hierarchy.
     </p></li>
<li 
  class="enumerate" id="x1-233004x2">
     <!--l. 5330--><p class="noindent" ><span 
class="cmti-10">Divisive</span>: This is a “top-down” approach: all observations
     start in one cluster, and splits are performed recursively
     as one moves down the hierarchy.</p></li></ol>
<!--l. 5333--><p class="noindent" >In general, the merges and splits are determined in a greedy
manner. The results of hierarchical clustering are usually presented
in a <span 
class="cmti-10">dendrogram</span>. <sup class="textsuperscript"><a 
href="#ennote-71" id="enmark-71"><span 
class="cmr-9">71</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-72" id="enmark-72"><span 
class="cmr-9">72</span></a></sup>
</p><!--l. 5335--><p class="noindent" >The standard algorithm for hierarchical agglomerative
clustering (HAC) has a time complexity of
<!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math> and
requires <!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="normal">Ω</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
                                                    
                                                    
memory, which makes it too slow for even medium data sets. However,
for some special cases, optimal efficient agglomerative methods (of
complexity <!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo><mo 
class="MathClass-close">)</mo></math>
are known: SLINK for single-linkage and CLINK for complete-linkage
clustering. With a heap, the runtime of the general case can be reduced
to <!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
class="MathClass-op"> log</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo><!--nolimits--><mi 
>n</mi><mo 
class="MathClass-close">)</mo></math>,
an improvement on the aforementioned bound of
<!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>3</mn></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>, at
the cost of further increasing the memory requirements. In many
cases, the memory overheads of this approach are too large
to make it practically usable. Except for the special case of
single-linkage, none of the algorithms (except exhaustive search in
<!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>
can be guaranteed to find the optimum solution.
Divisive clustering with an exhaustive search is
<!--l. 5335--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
mathvariant="bold-script">𝒪</mi><mo 
class="MathClass-open">(</mo><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>n</mi></mrow></msup 
><mo 
class="MathClass-close">)</mo></math>, but
it is common to use faster heuristics to choose splits, such as
k-means. <sup class="textsuperscript"><a 
href="#ennote-73" id="enmark-73"><span 
class="cmr-9">73</span></a></sup> <sup class="textsuperscript"><a 
href="#ennote-74" id="enmark-74"><span 
class="cmr-9">74</span></a></sup>
</p><!--l. 5337--><p class="noindent" >In order to decide which clusters should be combined (for
agglomerative), or where a cluster should be split (for divisive), a
measure of dissimilarity between sets of observations is required. In
most methods of hierarchical clustering, this is achieved by use of
an appropriate metric (a measure of distance between pairs
of observations), and a linkage criterion which specifies the
dissimilarity of sets as a function of the pairwise distances of
observations in the sets.
</p><!--l. 5339--><p class="noindent" >The choice of an appropriate metric will influence the shape of the
clusters, as some elements may be relatively closer to one another
under one metric than another. For example, in two dimensions,
under the Manhattan distance metric, the distance between the
origin (0,0) and (0.5, 0.5) is the same as the distance between the
origin and (0, 1), while under the Euclidean distance metric the
latter is strictly greater. Some commonly used metrics for
hierarchical clustering are:
</p>
<div class="table">
                                                    
                                                    
<!--l. 5342--><p class="noindent" ><a 
 id="x1-2330051"></a></p><figure class="float" 
>
                                                    
                                                    
<div class="tabular"> <table id="TBL-7" class="tabular" 
 
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1" /><col 
id="TBL-7-2" /></colgroup><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-1-1"  
class="td11">Names                          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-1-2"  
class="td11">Formula                                                                        </td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-2-1"  
class="td11">Euclidean distance            </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-2-2"  
class="td11"><!--l. 5346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><msub><mrow 
><mo 
class="MathClass-rel">∥</mo></mrow><mrow 
><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msqrt><mrow><msub><mrow 
><mi 
class="MathClass-op">∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow></msqrt></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-3-1"  
class="td11">Squared Euclidean distance</td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-3-2"  
class="td11"><!--l. 5347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><msubsup><mrow 
><mo 
class="MathClass-rel">∥</mo></mrow><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
><mi 
class="MathClass-op"> ∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><msup><mrow 
><mo 
class="MathClass-open">(</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mn>2</mn></mrow></msup 
></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-4-1"  
class="td11">Manhattan distance          </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-4-2"  
class="td11"><!--l. 5348--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><msub><mrow 
><mo 
class="MathClass-rel">∥</mo></mrow><mrow 
><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><msub><mrow 
><mi 
class="MathClass-op"> ∑</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo>
  <!--nolimits--></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-5-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-5-1"  
class="td11">Maximum distance           </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-5-2"  
class="td11"><!--l. 5349--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mo 
class="MathClass-rel">∥</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><msub><mrow 
><mo 
class="MathClass-rel">∥</mo></mrow><mrow 
><mi 
>∞</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo><munder class="msub"><mrow 
><mi 
class="MathClass-op"> max</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo></mrow><mrow 
><mi 
>i</mi></mrow></munder 
><mo 
class="MathClass-rel">|</mo><msub><mrow 
><mi 
>a</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-rel">|</mo></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-6-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-6-1"  
class="td11">Mahalanobis distance        </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-6-2"  
class="td11"><!--l. 5350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msqrt><mrow><msup><mrow 
><mo 
class="MathClass-open">(</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><mo 
class="MathClass-close">)</mo></mrow><mrow 
><mi 
class="MathClass-op">⊤</mi><mo> &ApplyFunction;<!--FUNCTION APPLICATION--></mo> </mrow> </msup 
> <msup><mrow 
><mi 
>S</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn> </mrow> </msup 
> <mo 
class="MathClass-open">(</mo><mi 
>a</mi> <mo 
class="MathClass-bin">−</mo> <mi 
>b</mi><mo 
class="MathClass-close">)</mo></mrow></msqrt></math></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-7-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-7-1"  
class="td11">                       </td><td  style="text-align:left; white-space:nowrap;" id="TBL-7-7-2"  
class="td11"><span 
class="cmr-9">where S is the Covariance matrix                                             </span></td>
</tr><tr 
class="hline"><td><hr /></td><td><hr /></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-8-"><td  style="text-align:left; white-space:nowrap;" id="TBL-7-8-1"  
class="td11">                       </td></tr></table>
</div>
<figcaption class="caption" ><span class="id">Table 5.1:</span><span  
class="content">Distance metric for HAC.</span></figcaption><!--tex4ht:label?: x1-2330051 -->
                                                    
                                                    
</figure>
</div>
<h5 class="subsubsectionHead"><a 
 id="x1-2340005.2.6"></a>Python practice</h5>
<!--l. 5361--><p class="noindent" >Hierarchical clustering is a general family of clustering algorithms
that build nested clusters by merging or splitting them successively.
This hierarchy of clusters is represented as a tree (or dendrogram).
The root of the tree is the unique cluster that gathers all the
samples, the leaves being the clusters with only one sample. See the
Wikipedia page for more details. The AgglomerativeClustering
object performs a hierarchical clustering using a bottom up
approach: each observation starts in its own cluster, and clusters are
successively merged together. The linkage criteria determines the
metric used for the merge strategy:
</p><!--l. 5363--><p class="noindent" >
     </p><ol  class="enumerate1" >
<li 
  class="enumerate" id="x1-234002x1">
     <!--l. 5364--><p class="noindent" >Ward  minimizes  the  sum  of  squared  differences  within
     all clusters. It is a variance-minimizing approach and in
     this sense is similar to the k-means objective function but
     tackled with an agglomerative hierarchical approach.
     </p></li>
<li 
  class="enumerate" id="x1-234004x2">
     <!--l. 5366--><p class="noindent" >Maximum or complete linkage minimizes the maximum
     distance between observations of pairs of clusters.
     </p></li>
<li 
  class="enumerate" id="x1-234006x3">
     <!--l. 5368--><p class="noindent" >Average linkage minimizes the average of the distances
     between all observations of pairs of clusters.
     </p></li>
<li 
  class="enumerate" id="x1-234008x4">
                                                    
                                                    
     <!--l. 5370--><p class="noindent" >Single linkage minimizes the distance between the closest
     observations of pairs of clusters.</p></li></ol>
<!--l. 5373--><p class="noindent" >AgglomerativeClustering can also scale to large number of samples
when it is used jointly with a connectivity matrix, but is
computationally expensive when no connectivity constraints are
added between samples: it considers at each step all the possible
merges.
</p>
<!--l. 5375--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234009r1"></a><span 
class="cmr-5">1</span></span><span id="textcolor17696"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cluster</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">AgglomerativeClustering</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234010r2"></a><span 
class="cmr-5">2</span></span><span id="textcolor17708"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234011r3"></a><span 
class="cmr-5">3</span></span><span id="textcolor17718"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor17723"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17730"><span 
class="cmtt-8">[</span></span><span id="textcolor17732"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17738"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17742"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor17748"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17752"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17758"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234012r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">...</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor17764"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">2</span><span id="textcolor17770"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17774"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">4</span><span id="textcolor17780"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17784"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">4</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17790"><span 
class="cmtt-8">]</span></span><span id="textcolor17792"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234013r5"></a><span 
class="cmr-5">5</span></span><span id="textcolor17795"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clustering</span><span 
class="cmtt-8"> </span><span id="textcolor17800"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">AgglomerativeClustering</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234014r6"></a><span 
class="cmr-5">6</span></span><span id="textcolor17810"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clustering</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234015r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8">AgglomerativeClustering</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234016r8"></a><span 
class="cmr-5">8</span></span><span id="textcolor17816"><span 
class="cmtt-8">&#x003E;&#x003E;&#x003E;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">clustering</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">labels_</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234017r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">array</span><span 
class="cmtt-8">(</span><span id="textcolor17824"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span id="textcolor17842"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-234018r10"></a><span 
class="cmr-5">10</span></span></pre>
<!--l. 5387--><p class="noindent" >
</p>
<h5 class="subsubsectionHead"><a 
 id="x1-2350005.2.6"></a>Plotting Dendrogram</h5>
<!--l. 5389--><p class="noindent" >This example plots the corresponding dendrogram of a hierarchical
clustering using AgglomerativeClustering and the dendrogram
method available in scipy.
</p>
<figure class="figure"> 

                                                    
                                                    
<a 
 id="x1-2350015"></a>
                                                    
                                                    
<!--l. 5392--><p class="noindent" ><img 
src="agglomerative_dendrogram.png" alt="PIC"  
width="274" height="274"  />
</p>
<figcaption class="caption" ><span class="id">Figure 5.5:</span><span  
class="content">Agglomerative dendrogram</span></figcaption><!--tex4ht:label?: x1-2350015 -->
                                                    
                                                    
</figure>
<!--l. 5397--><pre class="listings"><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235002r1"></a><span 
class="cmr-5">1</span></span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">numpy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235003r2"></a><span 
class="cmr-5">2</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235004r3"></a><span 
class="cmr-5">3</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">matplotlib</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">pyplot</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">as</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235005r4"></a><span 
class="cmr-5">4</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">scipy</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cluster</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">hierarchy</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dendrogram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235006r5"></a><span 
class="cmr-5">5</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">datasets</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235007r6"></a><span 
class="cmr-5">6</span></span><span 
class="cmtt-8">from</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">sklearn</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">cluster</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">import</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">AgglomerativeClustering</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235008r7"></a><span 
class="cmr-5">7</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235009r8"></a><span 
class="cmr-5">8</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235010r9"></a><span 
class="cmr-5">9</span></span><span 
class="cmtt-8">def</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">plot_dendrogram</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor17899"><span 
class="cmtt-8">**</span></span><span 
class="cmtt-8">kwargs</span><span 
class="cmtt-8">)</span><span id="textcolor17903"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235011r10"></a><span 
class="cmr-5">10</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">linkage</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">matrix</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">and</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">then</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">plot</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dendrogram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235012r11"></a><span 
class="cmr-5">11</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235013r12"></a><span 
class="cmr-5">12</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">create</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">counts</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">samples</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">under</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">each</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235014r13"></a><span 
class="cmr-5">13</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">counts</span><span 
class="cmtt-8"> </span><span id="textcolor17941"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">zeros</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">children_</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">shape</span><span id="textcolor17953"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">0</span><span id="textcolor17956"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235015r14"></a><span 
class="cmr-5">14</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span 
class="cmtt-8"> </span><span id="textcolor17961"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">len</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">labels_</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235016r15"></a><span 
class="cmr-5">15</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">i</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">merge</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">enumerate</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">children_</span><span 
class="cmtt-8">)</span><span id="textcolor17985"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235017r16"></a><span 
class="cmr-5">16</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">current_count</span><span 
class="cmtt-8"> </span><span id="textcolor17989"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">0</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235018r17"></a><span 
class="cmr-5">17</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">for</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">child_idx</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">merge</span><span id="textcolor18000"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235019r18"></a><span 
class="cmr-5">18</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">child_idx</span><span 
class="cmtt-8"> </span><span id="textcolor18006"><span 
class="cmtt-8">&#x003C;</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span id="textcolor18010"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235020r19"></a><span 
class="cmr-5">19</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">current_count</span><span 
class="cmtt-8"> </span><span id="textcolor18014"><span 
class="cmtt-8">+</span></span><span id="textcolor18016"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">1</span><span 
class="cmtt-8"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">leaf</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">node</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235021r20"></a><span 
class="cmr-5">20</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">else</span><span id="textcolor18028"><span 
class="cmtt-8">:</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235022r21"></a><span 
class="cmr-5">21</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">current_count</span><span 
class="cmtt-8"> </span><span id="textcolor18032"><span 
class="cmtt-8">+</span></span><span id="textcolor18034"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">counts</span><span id="textcolor18038"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">child_idx</span><span 
class="cmtt-8"> </span><span id="textcolor18042"><span 
class="cmtt-8">-</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_samples</span><span id="textcolor18046"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235023r22"></a><span 
class="cmr-5">22</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">counts</span><span id="textcolor18049"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">i</span><span id="textcolor18052"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><span id="textcolor18055"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">current_count</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235024r23"></a><span 
class="cmr-5">23</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235025r24"></a><span 
class="cmr-5">24</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">linkage_matrix</span><span 
class="cmtt-8"> </span><span id="textcolor18061"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">np</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">column_stack</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235026r25"></a><span 
class="cmr-5">25</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span id="textcolor18068"><span 
class="cmtt-8">[</span></span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">children_</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">distances_</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">counts</span><span id="textcolor18081"><span 
class="cmtt-8">]</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235027r26"></a><span 
class="cmr-5">26</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">astype</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">float</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235028r27"></a><span 
class="cmr-5">27</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235029r28"></a><span 
class="cmr-5">28</span></span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">Plot</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">corresponding</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dendrogram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235030r29"></a><span 
class="cmr-5">29</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">dendrogram</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">linkage_matrix</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span id="textcolor18103"><span 
class="cmtt-8">**</span></span><span 
class="cmtt-8">kwargs</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235031r30"></a><span 
class="cmr-5">30</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235032r31"></a><span 
class="cmr-5">31</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235033r32"></a><span 
class="cmr-5">32</span></span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8"> </span><span id="textcolor18109"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">load_iris</span><span 
class="cmtt-8">()</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235034r33"></a><span 
class="cmr-5">33</span></span><span 
class="cmtt-8">X</span><span 
class="cmtt-8"> </span><span id="textcolor18116"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">iris</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">data</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235035r34"></a><span 
class="cmr-5">34</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235036r35"></a><span 
class="cmr-5">35</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">setting</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">distance_threshold</span><span 
class="cmsltt-10x-x-80">=</span><span 
class="cmsltt-10x-x-80">0</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">ensures</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">we</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">compute</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">full</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">tree</span><span 
class="cmsltt-10x-x-80">.</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235037r36"></a><span 
class="cmr-5">36</span></span><span 
class="cmtt-8">model</span><span 
class="cmtt-8"> </span><span id="textcolor18144"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">AgglomerativeClustering</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">distance_threshold</span><span id="textcolor18150"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">0</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">n_clusters</span><span id="textcolor18156"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">None</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235038r37"></a><span 
class="cmr-5">37</span></span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235039r38"></a><span 
class="cmr-5">38</span></span><span 
class="cmtt-8">model</span><span 
class="cmtt-8"> </span><span id="textcolor18162"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">fit</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">X</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235040r39"></a><span 
class="cmr-5">39</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">title</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Hierarchical</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Clustering</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">Dendrogram</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235041r40"></a><span 
class="cmr-5">40</span></span><span 
class="cmsltt-10x-x-80">#</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">plot</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">top</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">three</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">levels</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">of</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">the</span><span 
class="cmsltt-10x-x-80"> </span><span 
class="cmsltt-10x-x-80">dendrogram</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235042r41"></a><span 
class="cmr-5">41</span></span><span 
class="cmtt-8">plot_dendrogram</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">model</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">truncate_mode</span><span id="textcolor18206"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">level</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">,</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">p</span><span id="textcolor18214"><span 
class="cmtt-8">=</span></span><span 
class="cmtt-8">3</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235043r42"></a><span 
class="cmr-5">42</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">xlabel</span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">Number</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">of</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">points</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">in</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">node</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">(</span><span 
class="cmtt-8">or</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">index</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">of</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">point</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">if</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">no</span><span 
class="cmtt-8"> </span><span 
class="cmtt-8">parenthesis</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">&#x0022;</span><span 
class="cmtt-8">)</span><span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235044r43"></a><span 
class="cmr-5">43</span></span><span 
class="cmtt-8">plt</span><span 
class="cmtt-8">.</span><span 
class="cmtt-8">show</span><span 
class="cmtt-8">()</span>
<span 
class="cmtt-8"> </span><br /><span class="label"><a 
 id="x1-235045r44"></a><span 
class="cmr-5">44</span></span></pre>
 
</body> 
</html>
                                                    


